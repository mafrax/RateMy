"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/users/[id]/videos";
exports.ids = ["pages/api/users/[id]/videos"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "next-auth/next":
/*!*********************************!*\
  !*** external "next-auth/next" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("next-auth/next");

/***/ }),

/***/ "next-auth/providers/apple":
/*!********************************************!*\
  !*** external "next-auth/providers/apple" ***!
  \********************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers/apple");

/***/ }),

/***/ "next-auth/providers/credentials":
/*!**************************************************!*\
  !*** external "next-auth/providers/credentials" ***!
  \**************************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers/credentials");

/***/ }),

/***/ "next-auth/providers/facebook":
/*!***********************************************!*\
  !*** external "next-auth/providers/facebook" ***!
  \***********************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers/facebook");

/***/ }),

/***/ "next-auth/providers/google":
/*!*********************************************!*\
  !*** external "next-auth/providers/google" ***!
  \*********************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers/google");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_users_id_videos_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/users/[id]/videos.ts */ \"(api)/./pages/api/users/[id]/videos.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_users_id_videos_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_users_id_videos_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_users_id_videos_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_users_id_videos_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/users/[id]/videos\",\n        pathname: \"/api/users/[id]/videos\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_users_id_videos_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVzZXJzJTJGJTVCaWQlNUQlMkZ2aWRlb3MmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRnVzZXJzJTJGJTVCaWQlNUQlMkZ2aWRlb3MudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDNkQ7QUFDN0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLDBEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywwREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yYXRlbXktbmV4dGpzLz81NGM0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvdXNlcnMvW2lkXS92aWRlb3MudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS91c2Vycy9baWRdL3ZpZGVvc1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3VzZXJzL1tpZF0vdmlkZW9zXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/users/[id]/videos.ts":
/*!****************************************!*\
  !*** ./pages/api/users/[id]/videos.ts ***!
  \****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/next */ \"next-auth/next\");\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_next__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _src_lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../src/lib/auth */ \"(api)/./src/lib/auth.ts\");\n/* harmony import */ var _src_services_video_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../src/services/video.service */ \"(api)/./src/services/video.service.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_services_video_service__WEBPACK_IMPORTED_MODULE_2__]);\n_src_services_video_service__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            success: false,\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        // Get session to verify authentication\n        const session = await (0,next_auth_next__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(req, res, _src_lib_auth__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n        if (!session) {\n            return res.status(401).json({\n                success: false,\n                message: \"Not authenticated\"\n            });\n        }\n        const { id: userId } = req.query;\n        if (!userId || typeof userId !== \"string\") {\n            return res.status(400).json({\n                success: false,\n                message: \"Invalid user ID\"\n            });\n        }\n        // Verify user can only access their own videos (for now)\n        const sessionUserId = session.user?.id;\n        if (sessionUserId !== userId) {\n            return res.status(403).json({\n                success: false,\n                message: \"Access denied\"\n            });\n        }\n        // Get videos by user\n        const result = await _src_services_video_service__WEBPACK_IMPORTED_MODULE_2__.videoService.getVideosByUser(userId);\n        if (!result.success) {\n            return res.status(400).json({\n                success: false,\n                message: result.message || \"Failed to fetch videos\"\n            });\n        }\n        return res.status(200).json({\n            success: true,\n            data: result.data,\n            message: \"Videos retrieved successfully\"\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return res.status(500).json({\n            success: false,\n            message: \"Internal server error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvdXNlcnMvW2lkXS92aWRlb3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFDaUQ7QUFDSztBQUNlO0FBRXRELGVBQWVHLFFBQVFDLEdBQW1CLEVBQUVDLEdBQW9CO0lBQzdFLElBQUlELElBQUlFLE1BQU0sS0FBSyxPQUFPO1FBQ3hCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztZQUFPQyxTQUFTO1FBQXFCO0lBQzlFO0lBRUEsSUFBSTtRQUNGLHVDQUF1QztRQUN2QyxNQUFNQyxVQUFVLE1BQU1YLGdFQUFnQkEsQ0FBQ0ksS0FBS0MsS0FBS0osc0RBQVdBO1FBQzVELElBQUksQ0FBQ1UsU0FBUztZQUNaLE9BQU9OLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7Z0JBQU9DLFNBQVM7WUFBb0I7UUFDN0U7UUFFQSxNQUFNLEVBQUVFLElBQUlDLE1BQU0sRUFBRSxHQUFHVCxJQUFJVSxLQUFLO1FBRWhDLElBQUksQ0FBQ0QsVUFBVSxPQUFPQSxXQUFXLFVBQVU7WUFDekMsT0FBT1IsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsU0FBUztnQkFBT0MsU0FBUztZQUFrQjtRQUMzRTtRQUVBLHlEQUF5RDtRQUN6RCxNQUFNSyxnQkFBaUJKLFFBQVFLLElBQUksRUFBVUo7UUFDN0MsSUFBSUcsa0JBQWtCRixRQUFRO1lBQzVCLE9BQU9SLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7Z0JBQU9DLFNBQVM7WUFBZ0I7UUFDekU7UUFFQSxxQkFBcUI7UUFDckIsTUFBTU8sU0FBUyxNQUFNZixxRUFBWUEsQ0FBQ2dCLGVBQWUsQ0FBQ0w7UUFFbEQsSUFBSSxDQUFDSSxPQUFPUixPQUFPLEVBQUU7WUFDbkIsT0FBT0osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDMUJDLFNBQVM7Z0JBQ1RDLFNBQVNPLE9BQU9QLE9BQU8sSUFBSTtZQUM3QjtRQUNGO1FBRUEsT0FBT0wsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztZQUNUVSxNQUFNRixPQUFPRSxJQUFJO1lBQ2pCVCxTQUFTO1FBQ1g7SUFFRixFQUFFLE9BQU9VLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGNBQWNBO1FBQzVCLE9BQU9mLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLFNBQVM7WUFDVEMsU0FBUztRQUNYO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdGVteS1uZXh0anMvLi9wYWdlcy9hcGkvdXNlcnMvW2lkXS92aWRlb3MudHM/ZDEyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCdcbmltcG9ydCB7IGdldFNlcnZlclNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgvbmV4dCdcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL2xpYi9hdXRoJ1xuaW1wb3J0IHsgdmlkZW9TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3JjL3NlcnZpY2VzL3ZpZGVvLnNlcnZpY2UnXG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pXG4gIH1cblxuICB0cnkge1xuICAgIC8vIEdldCBzZXNzaW9uIHRvIHZlcmlmeSBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKHJlcSwgcmVzLCBhdXRoT3B0aW9ucylcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnTm90IGF1dGhlbnRpY2F0ZWQnIH0pXG4gICAgfVxuXG4gICAgY29uc3QgeyBpZDogdXNlcklkIH0gPSByZXEucXVlcnlcblxuICAgIGlmICghdXNlcklkIHx8IHR5cGVvZiB1c2VySWQgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ0ludmFsaWQgdXNlciBJRCcgfSlcbiAgICB9XG5cbiAgICAvLyBWZXJpZnkgdXNlciBjYW4gb25seSBhY2Nlc3MgdGhlaXIgb3duIHZpZGVvcyAoZm9yIG5vdylcbiAgICBjb25zdCBzZXNzaW9uVXNlcklkID0gKHNlc3Npb24udXNlciBhcyBhbnkpPy5pZFxuICAgIGlmIChzZXNzaW9uVXNlcklkICE9PSB1c2VySWQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnQWNjZXNzIGRlbmllZCcgfSlcbiAgICB9XG5cbiAgICAvLyBHZXQgdmlkZW9zIGJ5IHVzZXJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2aWRlb1NlcnZpY2UuZ2V0VmlkZW9zQnlVc2VyKHVzZXJJZClcbiAgICBcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBmZXRjaCB2aWRlb3MnXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcmVzdWx0LmRhdGEsXG4gICAgICBtZXNzYWdlOiAnVmlkZW9zIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknXG4gICAgfSlcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJ1xuICAgIH0pXG4gIH1cbn0iXSwibmFtZXMiOlsiZ2V0U2VydmVyU2Vzc2lvbiIsImF1dGhPcHRpb25zIiwidmlkZW9TZXJ2aWNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsInNlc3Npb24iLCJpZCIsInVzZXJJZCIsInF1ZXJ5Iiwic2Vzc2lvblVzZXJJZCIsInVzZXIiLCJyZXN1bHQiLCJnZXRWaWRlb3NCeVVzZXIiLCJkYXRhIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/users/[id]/videos.ts\n");

/***/ }),

/***/ "(api)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"next-auth/providers/credentials\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/google */ \"next-auth/providers/google\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/facebook */ \"next-auth/providers/facebook\");\n/* harmony import */ var next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-auth/providers/apple */ \"next-auth/providers/apple\");\n/* harmony import */ var next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst authOptions = {\n    providers: [\n        next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1___default()({\n            clientId: process.env.GOOGLE_CLIENT_ID || \"dummy\",\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"dummy\"\n        }),\n        next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_2___default()({\n            clientId: process.env.FACEBOOK_CLIENT_ID || \"dummy\",\n            clientSecret: process.env.FACEBOOK_CLIENT_SECRET || \"dummy\"\n        }),\n        next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_3___default()({\n            clientId: process.env.APPLE_ID || \"dummy\",\n            clientSecret: process.env.APPLE_SECRET || \"dummy\"\n        }),\n        next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0___default()({\n            name: \"credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                try {\n                    if (!credentials?.email || !credentials?.password) {\n                        return null;\n                    }\n                    const user = await _db__WEBPACK_IMPORTED_MODULE_4__.db.user.findUnique({\n                        where: {\n                            email: credentials.email\n                        }\n                    });\n                    if (!user || !user.password) {\n                        return null;\n                    }\n                    const isPasswordValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_5___default().compare(credentials.password, user.password);\n                    if (!isPasswordValid) {\n                        return null;\n                    }\n                    return {\n                        id: user.id,\n                        email: user.email,\n                        name: user.firstName ? `${user.firstName} ${user.lastName || \"\"}`.trim() : user.username,\n                        username: user.username,\n                        firstName: user.firstName,\n                        lastName: user.lastName\n                    };\n                } catch (error) {\n                    console.error(\"Auth error:\", error);\n                    return null;\n                }\n            }\n        })\n    ],\n    session: {\n        strategy: \"jwt\",\n        maxAge: 30 * 24 * 60 * 60\n    },\n    pages: {\n        signIn: \"/auth/signin\"\n    },\n    callbacks: {\n        async jwt ({ token, user }) {\n            if (user) {\n                token.username = user.username;\n                token.firstName = user.firstName;\n                token.lastName = user.lastName;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token && session.user) {\n                session.user.id = token.sub;\n                session.user.username = token.username;\n                session.user.firstName = token.firstName;\n                session.user.lastName = token.lastName;\n            }\n            return session;\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNYixTQUFTO2dCQUNoRE0sUUFBUVosSUFBSSxDQUFTTyxRQUFRLEdBQUdZLE1BQU1aLFFBQVE7WUFDbEQ7WUFDQSxPQUFPSztRQUNUO0lBQ0Y7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9saWIvYXV0aC50cz82NjkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBdXRoT3B0aW9ucyB9IGZyb20gJ25leHQtYXV0aCdcbmltcG9ydCBDcmVkZW50aWFsc1Byb3ZpZGVyIGZyb20gJ25leHQtYXV0aC9wcm92aWRlcnMvY3JlZGVudGlhbHMnXG5pbXBvcnQgR29vZ2xlUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGUnXG5pbXBvcnQgRmFjZWJvb2tQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2ZhY2Vib29rJ1xuaW1wb3J0IEFwcGxlUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9hcHBsZSdcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi9kYidcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnXG5cbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9uczogTmV4dEF1dGhPcHRpb25zID0ge1xuICBwcm92aWRlcnM6IFtcbiAgICBHb29nbGVQcm92aWRlcih7XG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCB8fCAnZHVtbXknLFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVCB8fCAnZHVtbXknLFxuICAgIH0pLFxuICAgIEZhY2Vib29rUHJvdmlkZXIoe1xuICAgICAgY2xpZW50SWQ6IHByb2Nlc3MuZW52LkZBQ0VCT09LX0NMSUVOVF9JRCB8fCAnZHVtbXknLFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5GQUNFQk9PS19DTElFTlRfU0VDUkVUIHx8ICdkdW1teScsXG4gICAgfSksXG4gICAgQXBwbGVQcm92aWRlcih7XG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuQVBQTEVfSUQgfHwgJ2R1bW15JyxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuQVBQTEVfU0VDUkVUIHx8ICdkdW1teScsXG4gICAgfSksXG4gICAgQ3JlZGVudGlhbHNQcm92aWRlcih7XG4gICAgICBuYW1lOiAnY3JlZGVudGlhbHMnLFxuICAgICAgY3JlZGVudGlhbHM6IHtcbiAgICAgICAgZW1haWw6IHsgbGFiZWw6ICdFbWFpbCcsIHR5cGU6ICdlbWFpbCcgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgbGFiZWw6ICdQYXNzd29yZCcsIHR5cGU6ICdwYXNzd29yZCcgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmICghY3JlZGVudGlhbHM/LmVtYWlsIHx8ICFjcmVkZW50aWFscz8ucGFzc3dvcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICBlbWFpbDogY3JlZGVudGlhbHMuZW1haWxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgaWYgKCF1c2VyIHx8ICF1c2VyLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGlzUGFzc3dvcmRWYWxpZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKGNyZWRlbnRpYWxzLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxuICAgICAgICAgIGlmICghaXNQYXNzd29yZFZhbGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgbmFtZTogdXNlci5maXJzdE5hbWUgPyBgJHt1c2VyLmZpcnN0TmFtZX0gJHt1c2VyLmxhc3ROYW1lIHx8ICcnfWAudHJpbSgpIDogdXNlci51c2VybmFtZSxcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiB1c2VyLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB1c2VyLmxhc3ROYW1lLFxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdBdXRoIGVycm9yOicsIGVycm9yKVxuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICBdLFxuICBzZXNzaW9uOiB7XG4gICAgc3RyYXRlZ3k6ICdqd3QnLFxuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGRheXNcbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46ICcvYXV0aC9zaWduaW4nXG4gIH0sXG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIGp3dCh7IHRva2VuLCB1c2VyIH0pIHtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHRva2VuLnVzZXJuYW1lID0gKHVzZXIgYXMgYW55KS51c2VybmFtZVxuICAgICAgICB0b2tlbi5maXJzdE5hbWUgPSAodXNlciBhcyBhbnkpLmZpcnN0TmFtZVxuICAgICAgICB0b2tlbi5sYXN0TmFtZSA9ICh1c2VyIGFzIGFueSkubGFzdE5hbWVcbiAgICAgIH1cbiAgICAgIHJldHVybiB0b2tlblxuICAgIH0sXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuIH0pIHtcbiAgICAgIGlmICh0b2tlbiAmJiBzZXNzaW9uLnVzZXIpIHtcbiAgICAgICAgKHNlc3Npb24udXNlciBhcyBhbnkpLmlkID0gdG9rZW4uc3ViIVxuICAgICAgICA7KHNlc3Npb24udXNlciBhcyBhbnkpLnVzZXJuYW1lID0gdG9rZW4udXNlcm5hbWUgYXMgc3RyaW5nXG4gICAgICAgIDsoc2Vzc2lvbi51c2VyIGFzIGFueSkuZmlyc3ROYW1lID0gdG9rZW4uZmlyc3ROYW1lIGFzIHN0cmluZ1xuICAgICAgICA7KHNlc3Npb24udXNlciBhcyBhbnkpLmxhc3ROYW1lID0gdG9rZW4ubGFzdE5hbWUgYXMgc3RyaW5nXG4gICAgICB9XG4gICAgICByZXR1cm4gc2Vzc2lvblxuICAgIH1cbiAgfVxufSJdLCJuYW1lcyI6WyJDcmVkZW50aWFsc1Byb3ZpZGVyIiwiR29vZ2xlUHJvdmlkZXIiLCJGYWNlYm9va1Byb3ZpZGVyIiwiQXBwbGVQcm92aWRlciIsImRiIiwiYmNyeXB0IiwiYXV0aE9wdGlvbnMiLCJwcm92aWRlcnMiLCJjbGllbnRJZCIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQ0xJRU5UX0lEIiwiY2xpZW50U2VjcmV0IiwiR09PR0xFX0NMSUVOVF9TRUNSRVQiLCJGQUNFQk9PS19DTElFTlRfSUQiLCJGQUNFQk9PS19DTElFTlRfU0VDUkVUIiwiQVBQTEVfSUQiLCJBUFBMRV9TRUNSRVQiLCJuYW1lIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwiYXV0aG9yaXplIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlzUGFzc3dvcmRWYWxpZCIsImNvbXBhcmUiLCJpZCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidHJpbSIsInVzZXJuYW1lIiwiZXJyb3IiLCJjb25zb2xlIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwicGFnZXMiLCJzaWduSW4iLCJjYWxsYmFja3MiLCJqd3QiLCJ0b2tlbiIsInN1YiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(api)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   getEnvVar: () => (/* binding */ getEnvVar),\n/* harmony export */   getEnvVarAsBoolean: () => (/* binding */ getEnvVarAsBoolean),\n/* harmony export */   getEnvVarAsNumber: () => (/* binding */ getEnvVarAsNumber),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   isTest: () => (/* binding */ isTest)\n/* harmony export */ });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ \"(api)/./src/lib/constants.ts\");\n\nfunction getConfig() {\n    const env = \"development\" || 0;\n    const isDevelopment = env === _constants__WEBPACK_IMPORTED_MODULE_0__.NODE_ENV.DEVELOPMENT;\n    const isProduction = env === _constants__WEBPACK_IMPORTED_MODULE_0__.NODE_ENV.PRODUCTION;\n    // Validate required environment variables\n    const requiredVars = [\n        \"DATABASE_URL\",\n        \"NEXTAUTH_SECRET\",\n        \"NEXTAUTH_URL\"\n    ];\n    for (const varName of requiredVars){\n        if (!process.env[varName]) {\n            throw new Error(`Missing required environment variable: ${varName}`);\n        }\n    }\n    return {\n        app: {\n            name: process.env.APP_NAME || \"RateMe\",\n            version: process.env.APP_VERSION || \"1.0.0\",\n            env,\n            port: parseInt(process.env.PORT || \"3000\", 10),\n            url: process.env.NEXTAUTH_URL\n        },\n        database: {\n            url: process.env.DATABASE_URL\n        },\n        auth: {\n            secret: process.env.NEXTAUTH_SECRET,\n            url: process.env.NEXTAUTH_URL,\n            sessionMaxAge: parseInt(process.env.SESSION_MAX_AGE || \"2592000\", 10)\n        },\n        logging: {\n            level: process.env.LOG_LEVEL || (isDevelopment ? \"debug\" : \"info\"),\n            pretty: isDevelopment\n        },\n        redis: process.env.REDIS_URL ? {\n            url: process.env.REDIS_URL,\n            password: process.env.REDIS_PASSWORD\n        } : undefined,\n        external: {\n            youtube: process.env.YOUTUBE_API_KEY ? {\n                apiKey: process.env.YOUTUBE_API_KEY\n            } : undefined,\n            vimeo: process.env.VIMEO_CLIENT_ID && process.env.VIMEO_CLIENT_SECRET ? {\n                clientId: process.env.VIMEO_CLIENT_ID,\n                clientSecret: process.env.VIMEO_CLIENT_SECRET\n            } : undefined\n        }\n    };\n}\n// Export singleton config instance\nconst config = getConfig();\n// Type-safe environment variable access\nfunction getEnvVar(name, defaultValue) {\n    const value = process.env[name];\n    if (value === undefined) {\n        if (defaultValue !== undefined) {\n            return defaultValue;\n        }\n        throw new Error(`Environment variable ${name} is not set`);\n    }\n    return value;\n}\nfunction getEnvVarAsNumber(name, defaultValue) {\n    const value = process.env[name];\n    if (value === undefined) {\n        if (defaultValue !== undefined) {\n            return defaultValue;\n        }\n        throw new Error(`Environment variable ${name} is not set`);\n    }\n    const parsed = parseInt(value, 10);\n    if (isNaN(parsed)) {\n        throw new Error(`Environment variable ${name} is not a valid number: ${value}`);\n    }\n    return parsed;\n}\nfunction getEnvVarAsBoolean(name, defaultValue) {\n    const value = process.env[name];\n    if (value === undefined) {\n        if (defaultValue !== undefined) {\n            return defaultValue;\n        }\n        throw new Error(`Environment variable ${name} is not set`);\n    }\n    return value.toLowerCase() === \"true\";\n}\n// Environment checks\nconst isDevelopment = config.app.env === _constants__WEBPACK_IMPORTED_MODULE_0__.NODE_ENV.DEVELOPMENT;\nconst isProduction = config.app.env === _constants__WEBPACK_IMPORTED_MODULE_0__.NODE_ENV.PRODUCTION;\nconst isTest = config.app.env === _constants__WEBPACK_IMPORTED_MODULE_0__.NODE_ENV.TEST;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDL0IsSUFBSUcsTUFBTUQsU0FBUztRQUNqQixNQUFNLElBQUl6QyxNQUFNLENBQUMscUJBQXFCLEVBQUVFLEtBQUssd0JBQXdCLEVBQUVxQyxNQUFNLENBQUM7SUFDaEY7SUFDQSxPQUFPRTtBQUNUO0FBRU8sU0FBU0UsbUJBQW1CekMsSUFBWSxFQUFFb0MsWUFBc0I7SUFDckUsTUFBTUMsUUFBUTlDLFFBQVFELEdBQUcsQ0FBQ1UsS0FBSztJQUMvQixJQUFJcUMsVUFBVWIsV0FBVztRQUN2QixJQUFJWSxpQkFBaUJaLFdBQVc7WUFDOUIsT0FBT1k7UUFDVDtRQUNBLE1BQU0sSUFBSXRDLE1BQU0sQ0FBQyxxQkFBcUIsRUFBRUUsS0FBSyxXQUFXLENBQUM7SUFDM0Q7SUFDQSxPQUFPcUMsTUFBTUssV0FBVyxPQUFPO0FBQ2pDO0FBRUEscUJBQXFCO0FBQ2QsTUFBTWpELGdCQUFnQnlDLE9BQU9uQyxHQUFHLENBQUNULEdBQUcsS0FBS0YsZ0RBQVFBLENBQUNJLFdBQVc7QUFDN0QsTUFBTUUsZUFBZXdDLE9BQU9uQyxHQUFHLENBQUNULEdBQUcsS0FBS0YsZ0RBQVFBLENBQUNPLFVBQVU7QUFDM0QsTUFBTWdELFNBQVNULE9BQU9uQyxHQUFHLENBQUNULEdBQUcsS0FBS0YsZ0RBQVFBLENBQUN3RCxJQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9saWIvY29uZmlnLnRzP2EzZWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTk9ERV9FTlYgfSBmcm9tICcuL2NvbnN0YW50cydcblxuaW50ZXJmYWNlIENvbmZpZyB7XG4gIGFwcDoge1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIHZlcnNpb246IHN0cmluZ1xuICAgIGVudjogc3RyaW5nXG4gICAgcG9ydDogbnVtYmVyXG4gICAgdXJsOiBzdHJpbmdcbiAgfVxuICBkYXRhYmFzZToge1xuICAgIHVybDogc3RyaW5nXG4gIH1cbiAgYXV0aDoge1xuICAgIHNlY3JldDogc3RyaW5nXG4gICAgdXJsOiBzdHJpbmdcbiAgICBzZXNzaW9uTWF4QWdlOiBudW1iZXJcbiAgfVxuICBsb2dnaW5nOiB7XG4gICAgbGV2ZWw6IHN0cmluZ1xuICAgIHByZXR0eTogYm9vbGVhblxuICB9XG4gIHJlZGlzPzoge1xuICAgIHVybDogc3RyaW5nXG4gICAgcGFzc3dvcmQ/OiBzdHJpbmdcbiAgfVxuICBleHRlcm5hbDoge1xuICAgIHlvdXR1YmU/OiB7XG4gICAgICBhcGlLZXk6IHN0cmluZ1xuICAgIH1cbiAgICB2aW1lbz86IHtcbiAgICAgIGNsaWVudElkOiBzdHJpbmdcbiAgICAgIGNsaWVudFNlY3JldDogc3RyaW5nXG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGdldENvbmZpZygpOiBDb25maWcge1xuICBjb25zdCBlbnYgPSBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCBOT0RFX0VOVi5ERVZFTE9QTUVOVFxuICBjb25zdCBpc0RldmVsb3BtZW50ID0gZW52ID09PSBOT0RFX0VOVi5ERVZFTE9QTUVOVFxuICBjb25zdCBpc1Byb2R1Y3Rpb24gPSBlbnYgPT09IE5PREVfRU5WLlBST0RVQ1RJT05cblxuICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgY29uc3QgcmVxdWlyZWRWYXJzID0gW1xuICAgICdEQVRBQkFTRV9VUkwnLFxuICAgICdORVhUQVVUSF9TRUNSRVQnLFxuICAgICdORVhUQVVUSF9VUkwnLFxuICBdXG5cbiAgZm9yIChjb25zdCB2YXJOYW1lIG9mIHJlcXVpcmVkVmFycykge1xuICAgIGlmICghcHJvY2Vzcy5lbnZbdmFyTmFtZV0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZTogJHt2YXJOYW1lfWApXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhcHA6IHtcbiAgICAgIG5hbWU6IHByb2Nlc3MuZW52LkFQUF9OQU1FIHx8ICdSYXRlTWUnLFxuICAgICAgdmVyc2lvbjogcHJvY2Vzcy5lbnYuQVBQX1ZFUlNJT04gfHwgJzEuMC4wJyxcbiAgICAgIGVudixcbiAgICAgIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LlBPUlQgfHwgJzMwMDAnLCAxMCksXG4gICAgICB1cmw6IHByb2Nlc3MuZW52Lk5FWFRBVVRIX1VSTCEsXG4gICAgfSxcbiAgICBkYXRhYmFzZToge1xuICAgICAgdXJsOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwhLFxuICAgIH0sXG4gICAgYXV0aDoge1xuICAgICAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQhLFxuICAgICAgdXJsOiBwcm9jZXNzLmVudi5ORVhUQVVUSF9VUkwhLFxuICAgICAgc2Vzc2lvbk1heEFnZTogcGFyc2VJbnQocHJvY2Vzcy5lbnYuU0VTU0lPTl9NQVhfQUdFIHx8ICcyNTkyMDAwJywgMTApLCAvLyAzMCBkYXlzXG4gICAgfSxcbiAgICBsb2dnaW5nOiB7XG4gICAgICBsZXZlbDogcHJvY2Vzcy5lbnYuTE9HX0xFVkVMIHx8IChpc0RldmVsb3BtZW50ID8gJ2RlYnVnJyA6ICdpbmZvJyksXG4gICAgICBwcmV0dHk6IGlzRGV2ZWxvcG1lbnQsXG4gICAgfSxcbiAgICByZWRpczogcHJvY2Vzcy5lbnYuUkVESVNfVVJMID8ge1xuICAgICAgdXJsOiBwcm9jZXNzLmVudi5SRURJU19VUkwsXG4gICAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUkVESVNfUEFTU1dPUkQsXG4gICAgfSA6IHVuZGVmaW5lZCxcbiAgICBleHRlcm5hbDoge1xuICAgICAgeW91dHViZTogcHJvY2Vzcy5lbnYuWU9VVFVCRV9BUElfS0VZID8ge1xuICAgICAgICBhcGlLZXk6IHByb2Nlc3MuZW52LllPVVRVQkVfQVBJX0tFWSxcbiAgICAgIH0gOiB1bmRlZmluZWQsXG4gICAgICB2aW1lbzogcHJvY2Vzcy5lbnYuVklNRU9fQ0xJRU5UX0lEICYmIHByb2Nlc3MuZW52LlZJTUVPX0NMSUVOVF9TRUNSRVQgPyB7XG4gICAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5WSU1FT19DTElFTlRfSUQsXG4gICAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuVklNRU9fQ0xJRU5UX1NFQ1JFVCxcbiAgICAgIH0gOiB1bmRlZmluZWQsXG4gICAgfSxcbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGNvbmZpZyBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGdldENvbmZpZygpXG5cbi8vIFR5cGUtc2FmZSBlbnZpcm9ubWVudCB2YXJpYWJsZSBhY2Nlc3NcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbnZWYXIobmFtZTogc3RyaW5nLCBkZWZhdWx0VmFsdWU/OiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W25hbWVdXG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKGRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlXG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgRW52aXJvbm1lbnQgdmFyaWFibGUgJHtuYW1lfSBpcyBub3Qgc2V0YClcbiAgfVxuICByZXR1cm4gdmFsdWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEVudlZhckFzTnVtYmVyKG5hbWU6IHN0cmluZywgZGVmYXVsdFZhbHVlPzogbnVtYmVyKTogbnVtYmVyIHtcbiAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltuYW1lXVxuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChkZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZVxuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVudmlyb25tZW50IHZhcmlhYmxlICR7bmFtZX0gaXMgbm90IHNldGApXG4gIH1cbiAgY29uc3QgcGFyc2VkID0gcGFyc2VJbnQodmFsdWUsIDEwKVxuICBpZiAoaXNOYU4ocGFyc2VkKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRW52aXJvbm1lbnQgdmFyaWFibGUgJHtuYW1lfSBpcyBub3QgYSB2YWxpZCBudW1iZXI6ICR7dmFsdWV9YClcbiAgfVxuICByZXR1cm4gcGFyc2VkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbnZWYXJBc0Jvb2xlYW4obmFtZTogc3RyaW5nLCBkZWZhdWx0VmFsdWU/OiBib29sZWFuKTogYm9vbGVhbiB7XG4gIGNvbnN0IHZhbHVlID0gcHJvY2Vzcy5lbnZbbmFtZV1cbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICBpZiAoZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWVcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFbnZpcm9ubWVudCB2YXJpYWJsZSAke25hbWV9IGlzIG5vdCBzZXRgKVxuICB9XG4gIHJldHVybiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSdcbn1cblxuLy8gRW52aXJvbm1lbnQgY2hlY2tzXG5leHBvcnQgY29uc3QgaXNEZXZlbG9wbWVudCA9IGNvbmZpZy5hcHAuZW52ID09PSBOT0RFX0VOVi5ERVZFTE9QTUVOVFxuZXhwb3J0IGNvbnN0IGlzUHJvZHVjdGlvbiA9IGNvbmZpZy5hcHAuZW52ID09PSBOT0RFX0VOVi5QUk9EVUNUSU9OXG5leHBvcnQgY29uc3QgaXNUZXN0ID0gY29uZmlnLmFwcC5lbnYgPT09IE5PREVfRU5WLlRFU1QiXSwibmFtZXMiOlsiTk9ERV9FTlYiLCJnZXRDb25maWciLCJlbnYiLCJwcm9jZXNzIiwiREVWRUxPUE1FTlQiLCJpc0RldmVsb3BtZW50IiwiaXNQcm9kdWN0aW9uIiwiUFJPRFVDVElPTiIsInJlcXVpcmVkVmFycyIsInZhck5hbWUiLCJFcnJvciIsImFwcCIsIm5hbWUiLCJBUFBfTkFNRSIsInZlcnNpb24iLCJBUFBfVkVSU0lPTiIsInBvcnQiLCJwYXJzZUludCIsIlBPUlQiLCJ1cmwiLCJORVhUQVVUSF9VUkwiLCJkYXRhYmFzZSIsIkRBVEFCQVNFX1VSTCIsImF1dGgiLCJzZWNyZXQiLCJORVhUQVVUSF9TRUNSRVQiLCJzZXNzaW9uTWF4QWdlIiwiU0VTU0lPTl9NQVhfQUdFIiwibG9nZ2luZyIsImxldmVsIiwiTE9HX0xFVkVMIiwicHJldHR5IiwicmVkaXMiLCJSRURJU19VUkwiLCJwYXNzd29yZCIsIlJFRElTX1BBU1NXT1JEIiwidW5kZWZpbmVkIiwiZXh0ZXJuYWwiLCJ5b3V0dWJlIiwiWU9VVFVCRV9BUElfS0VZIiwiYXBpS2V5IiwidmltZW8iLCJWSU1FT19DTElFTlRfSUQiLCJWSU1FT19DTElFTlRfU0VDUkVUIiwiY2xpZW50SWQiLCJjbGllbnRTZWNyZXQiLCJjb25maWciLCJnZXRFbnZWYXIiLCJkZWZhdWx0VmFsdWUiLCJ2YWx1ZSIsImdldEVudlZhckFzTnVtYmVyIiwicGFyc2VkIiwiaXNOYU4iLCJnZXRFbnZWYXJBc0Jvb2xlYW4iLCJ0b0xvd2VyQ2FzZSIsImlzVGVzdCIsIlRFU1QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/lib/config.ts\n");

/***/ }),

/***/ "(api)/./src/lib/constants.ts":
/*!******************************!*\
  !*** ./src/lib/constants.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API_ROUTES: () => (/* binding */ API_ROUTES),\n/* harmony export */   APP_DESCRIPTION: () => (/* binding */ APP_DESCRIPTION),\n/* harmony export */   APP_NAME: () => (/* binding */ APP_NAME),\n/* harmony export */   APP_VERSION: () => (/* binding */ APP_VERSION),\n/* harmony export */   CACHE_KEYS: () => (/* binding */ CACHE_KEYS),\n/* harmony export */   CACHE_TTL: () => (/* binding */ CACHE_TTL),\n/* harmony export */   DEFAULTS: () => (/* binding */ DEFAULTS),\n/* harmony export */   ERROR_CODES: () => (/* binding */ ERROR_CODES),\n/* harmony export */   EXTERNAL_SERVICES: () => (/* binding */ EXTERNAL_SERVICES),\n/* harmony export */   FEATURES: () => (/* binding */ FEATURES),\n/* harmony export */   HTTP_STATUS: () => (/* binding */ HTTP_STATUS),\n/* harmony export */   NODE_ENV: () => (/* binding */ NODE_ENV),\n/* harmony export */   PAGINATION: () => (/* binding */ PAGINATION),\n/* harmony export */   RATING_LEVELS: () => (/* binding */ RATING_LEVELS),\n/* harmony export */   SEO: () => (/* binding */ SEO),\n/* harmony export */   SOCIAL_PLATFORMS: () => (/* binding */ SOCIAL_PLATFORMS),\n/* harmony export */   UPLOAD_LIMITS: () => (/* binding */ UPLOAD_LIMITS),\n/* harmony export */   USER_LIMITS: () => (/* binding */ USER_LIMITS),\n/* harmony export */   VALIDATION_PATTERNS: () => (/* binding */ VALIDATION_PATTERNS),\n/* harmony export */   VIDEO_LIMITS: () => (/* binding */ VIDEO_LIMITS),\n/* harmony export */   VIDEO_PLATFORMS: () => (/* binding */ VIDEO_PLATFORMS)\n/* harmony export */ });\n// Application constants\nconst APP_NAME = \"RateMe\";\nconst APP_DESCRIPTION = \"A modern video rating platform\";\nconst APP_VERSION = \"1.0.0\";\n// API constants\nconst API_ROUTES = {\n    AUTH: {\n        SIGNIN: \"/api/auth/signin\",\n        SIGNUP: \"/api/auth/register\",\n        SIGNOUT: \"/api/auth/signout\"\n    },\n    VIDEOS: {\n        BASE: \"/api/videos\",\n        BY_ID: (id)=>`/api/videos/${id}`,\n        RATE: (id)=>`/api/videos/${id}/rate`\n    },\n    USERS: {\n        BASE: \"/api/users\",\n        BY_ID: (id)=>`/api/users/${id}`,\n        FOLLOW: (id)=>`/api/users/${id}/follow`\n    }\n};\n// UI constants\nconst PAGINATION = {\n    DEFAULT_PAGE_SIZE: 12,\n    MAX_PAGE_SIZE: 50\n};\nconst VIDEO_LIMITS = {\n    MAX_TITLE_LENGTH: 200,\n    MAX_DESCRIPTION_LENGTH: 1000\n};\nconst USER_LIMITS = {\n    MIN_USERNAME_LENGTH: 3,\n    MAX_USERNAME_LENGTH: 30,\n    MIN_PASSWORD_LENGTH: 6,\n    MAX_PASSWORD_LENGTH: 128\n};\n// Validation patterns\nconst VALIDATION_PATTERNS = {\n    EMAIL: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\n    USERNAME: /^[a-zA-Z0-9_]{3,30}$/,\n    YOUTUBE_URL: /(?:https?:\\/\\/)?(?:www\\.)?(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/,\n    VIMEO_URL: /(?:https?:\\/\\/)?(?:www\\.)?vimeo\\.com\\/(\\d+)/\n};\n// Error codes\nconst ERROR_CODES = {\n    // Authentication errors\n    INVALID_CREDENTIALS: \"INVALID_CREDENTIALS\",\n    USER_NOT_FOUND: \"USER_NOT_FOUND\",\n    USER_ALREADY_EXISTS: \"USER_ALREADY_EXISTS\",\n    UNAUTHORIZED: \"UNAUTHORIZED\",\n    SESSION_EXPIRED: \"SESSION_EXPIRED\",\n    // Validation errors\n    VALIDATION_ERROR: \"VALIDATION_ERROR\",\n    INVALID_INPUT: \"INVALID_INPUT\",\n    MISSING_REQUIRED_FIELD: \"MISSING_REQUIRED_FIELD\",\n    // Resource errors\n    RESOURCE_NOT_FOUND: \"RESOURCE_NOT_FOUND\",\n    RESOURCE_ALREADY_EXISTS: \"RESOURCE_ALREADY_EXISTS\",\n    RESOURCE_FORBIDDEN: \"RESOURCE_FORBIDDEN\",\n    // Server errors\n    INTERNAL_SERVER_ERROR: \"INTERNAL_SERVER_ERROR\",\n    DATABASE_ERROR: \"DATABASE_ERROR\",\n    EXTERNAL_SERVICE_ERROR: \"EXTERNAL_SERVICE_ERROR\",\n    // Rate limiting\n    RATE_LIMIT_EXCEEDED: \"RATE_LIMIT_EXCEEDED\"\n};\n// HTTP status codes\nconst HTTP_STATUS = {\n    OK: 200,\n    CREATED: 201,\n    NO_CONTENT: 204,\n    BAD_REQUEST: 400,\n    UNAUTHORIZED: 401,\n    FORBIDDEN: 403,\n    NOT_FOUND: 404,\n    METHOD_NOT_ALLOWED: 405,\n    CONFLICT: 409,\n    UNPROCESSABLE_ENTITY: 422,\n    TOO_MANY_REQUESTS: 429,\n    INTERNAL_SERVER_ERROR: 500,\n    BAD_GATEWAY: 502,\n    SERVICE_UNAVAILABLE: 503\n};\n// Cache keys\nconst CACHE_KEYS = {\n    VIDEOS: \"videos\",\n    USER: (id)=>`user:${id}`,\n    VIDEO: (id)=>`video:${id}`,\n    TAGS: \"tags\",\n    USER_VIDEOS: (userId)=>`user:${userId}:videos`\n};\n// Cache TTL (in seconds)\nconst CACHE_TTL = {\n    SHORT: 300,\n    MEDIUM: 1800,\n    LONG: 3600,\n    VERY_LONG: 86400\n};\n// Environment types\nconst NODE_ENV = {\n    DEVELOPMENT: \"development\",\n    PRODUCTION: \"production\",\n    TEST: \"test\"\n};\n// Supported video platforms\nconst VIDEO_PLATFORMS = {\n    YOUTUBE: \"youtube\",\n    VIMEO: \"vimeo\"\n};\n// Rating levels\nconst RATING_LEVELS = {\n    MIN: 1,\n    MAX: 5,\n    DEFAULT: 3\n};\n// Default values\nconst DEFAULTS = {\n    AVATAR_URL: \"/images/default-avatar.png\",\n    VIDEO_THUMBNAIL: \"/images/default-video-thumbnail.png\",\n    PAGINATION_LIMIT: PAGINATION.DEFAULT_PAGE_SIZE,\n    RATING_LEVEL: RATING_LEVELS.DEFAULT\n};\n// Feature flags\nconst FEATURES = {\n    VIDEO_UPLOAD: true,\n    USER_REGISTRATION: true,\n    VIDEO_RATING: true,\n    USER_FOLLOWING: true,\n    SEARCH: true,\n    ADMIN_PANEL: false\n};\n// External service URLs\nconst EXTERNAL_SERVICES = {\n    YOUTUBE_API: \"https://www.googleapis.com/youtube/v3\",\n    VIMEO_API: \"https://api.vimeo.com\"\n};\n// File upload limits\nconst UPLOAD_LIMITS = {\n    MAX_FILE_SIZE: 10 * 1024 * 1024,\n    ALLOWED_IMAGE_TYPES: [\n        \"image/jpeg\",\n        \"image/png\",\n        \"image/gif\",\n        \"image/webp\"\n    ],\n    ALLOWED_VIDEO_TYPES: [\n        \"video/mp4\",\n        \"video/webm\",\n        \"video/ogg\"\n    ]\n};\n// SEO constants\nconst SEO = {\n    DEFAULT_TITLE: APP_NAME,\n    TITLE_TEMPLATE: `%s | ${APP_NAME}`,\n    DEFAULT_DESCRIPTION: APP_DESCRIPTION,\n    TWITTER_HANDLE: \"@rateme\",\n    SITE_URL: process.env.NEXTAUTH_URL || \"http://localhost:3000\"\n};\n// Social sharing\nconst SOCIAL_PLATFORMS = {\n    TWITTER: \"twitter\",\n    FACEBOOK: \"facebook\",\n    LINKEDIN: \"linkedin\",\n    REDDIT: \"reddit\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDTEMsS0FBSztJQUNMQyxTQUFTO0FBQ1gsRUFBVTtBQUVWLGlCQUFpQjtBQUNWLE1BQU1DLFdBQVc7SUFDdEJDLFlBQVk7SUFDWkMsaUJBQWlCO0lBQ2pCQyxrQkFBa0J0RSxXQUFXQyxpQkFBaUI7SUFDOUNzRSxjQUFjUixjQUFjRyxPQUFPO0FBQ3JDLEVBQVU7QUFFVixnQkFBZ0I7QUFDVCxNQUFNTSxXQUFXO0lBQ3RCQyxjQUFjO0lBQ2RDLG1CQUFtQjtJQUNuQkMsY0FBYztJQUNkQyxnQkFBZ0I7SUFDaEJDLFFBQVE7SUFDUkMsYUFBYTtBQUNmLEVBQVU7QUFFVix3QkFBd0I7QUFDakIsTUFBTUMsb0JBQW9CO0lBQy9CQyxhQUFhO0lBQ2JDLFdBQVc7QUFDYixFQUFVO0FBRVYscUJBQXFCO0FBQ2QsTUFBTUMsZ0JBQWdCO0lBQzNCQyxlQUFlLEtBQUssT0FBTztJQUMzQkMscUJBQXFCO1FBQUM7UUFBYztRQUFhO1FBQWE7S0FBYTtJQUMzRUMscUJBQXFCO1FBQUM7UUFBYTtRQUFjO0tBQVk7QUFDL0QsRUFBVTtBQUVWLGdCQUFnQjtBQUNULE1BQU1DLE1BQU07SUFDakJDLGVBQWV0RztJQUNmdUcsZ0JBQWdCLENBQUMsS0FBSyxFQUFFdkcsU0FBUyxDQUFDO0lBQ2xDd0cscUJBQXFCdkc7SUFDckJ3RyxnQkFBZ0I7SUFDaEJDLFVBQVVDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWSxJQUFJO0FBQ3hDLEVBQVU7QUFFVixpQkFBaUI7QUFDVixNQUFNQyxtQkFBbUI7SUFDOUJDLFNBQVM7SUFDVEMsVUFBVTtJQUNWQyxVQUFVO0lBQ1ZDLFFBQVE7QUFDVixFQUFVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9saWIvY29uc3RhbnRzLnRzP2ZiZjkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQXBwbGljYXRpb24gY29uc3RhbnRzXG5leHBvcnQgY29uc3QgQVBQX05BTUUgPSAnUmF0ZU1lJ1xuZXhwb3J0IGNvbnN0IEFQUF9ERVNDUklQVElPTiA9ICdBIG1vZGVybiB2aWRlbyByYXRpbmcgcGxhdGZvcm0nXG5leHBvcnQgY29uc3QgQVBQX1ZFUlNJT04gPSAnMS4wLjAnXG5cbi8vIEFQSSBjb25zdGFudHNcbmV4cG9ydCBjb25zdCBBUElfUk9VVEVTID0ge1xuICBBVVRIOiB7XG4gICAgU0lHTklOOiAnL2FwaS9hdXRoL3NpZ25pbicsXG4gICAgU0lHTlVQOiAnL2FwaS9hdXRoL3JlZ2lzdGVyJyxcbiAgICBTSUdOT1VUOiAnL2FwaS9hdXRoL3NpZ25vdXQnLFxuICB9LFxuICBWSURFT1M6IHtcbiAgICBCQVNFOiAnL2FwaS92aWRlb3MnLFxuICAgIEJZX0lEOiAoaWQ6IHN0cmluZykgPT4gYC9hcGkvdmlkZW9zLyR7aWR9YCxcbiAgICBSQVRFOiAoaWQ6IHN0cmluZykgPT4gYC9hcGkvdmlkZW9zLyR7aWR9L3JhdGVgLFxuICB9LFxuICBVU0VSUzoge1xuICAgIEJBU0U6ICcvYXBpL3VzZXJzJyxcbiAgICBCWV9JRDogKGlkOiBzdHJpbmcpID0+IGAvYXBpL3VzZXJzLyR7aWR9YCxcbiAgICBGT0xMT1c6IChpZDogc3RyaW5nKSA9PiBgL2FwaS91c2Vycy8ke2lkfS9mb2xsb3dgLFxuICB9LFxufSBhcyBjb25zdFxuXG4vLyBVSSBjb25zdGFudHNcbmV4cG9ydCBjb25zdCBQQUdJTkFUSU9OID0ge1xuICBERUZBVUxUX1BBR0VfU0laRTogMTIsXG4gIE1BWF9QQUdFX1NJWkU6IDUwLFxufSBhcyBjb25zdFxuXG5leHBvcnQgY29uc3QgVklERU9fTElNSVRTID0ge1xuICBNQVhfVElUTEVfTEVOR1RIOiAyMDAsXG4gIE1BWF9ERVNDUklQVElPTl9MRU5HVEg6IDEwMDAsXG4gIC8vIFJlbW92ZWQgTUFYX1RBR1MgbGltaXQgdG8gYWxsb3cgdW5saW1pdGVkIHRhZ3Ncbn0gYXMgY29uc3RcblxuZXhwb3J0IGNvbnN0IFVTRVJfTElNSVRTID0ge1xuICBNSU5fVVNFUk5BTUVfTEVOR1RIOiAzLFxuICBNQVhfVVNFUk5BTUVfTEVOR1RIOiAzMCxcbiAgTUlOX1BBU1NXT1JEX0xFTkdUSDogNixcbiAgTUFYX1BBU1NXT1JEX0xFTkdUSDogMTI4LFxufSBhcyBjb25zdFxuXG4vLyBWYWxpZGF0aW9uIHBhdHRlcm5zXG5leHBvcnQgY29uc3QgVkFMSURBVElPTl9QQVRURVJOUyA9IHtcbiAgRU1BSUw6IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvLFxuICBVU0VSTkFNRTogL15bYS16QS1aMC05X117MywzMH0kLyxcbiAgWU9VVFVCRV9VUkw6IC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pPyg/OnlvdXR1YmVcXC5jb21cXC93YXRjaFxcP3Y9fHlvdXR1XFwuYmVcXC8pKFthLXpBLVowLTlfLV17MTF9KS8sXG4gIFZJTUVPX1VSTDogLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/dmltZW9cXC5jb21cXC8oXFxkKykvLFxufSBhcyBjb25zdFxuXG4vLyBFcnJvciBjb2Rlc1xuZXhwb3J0IGNvbnN0IEVSUk9SX0NPREVTID0ge1xuICAvLyBBdXRoZW50aWNhdGlvbiBlcnJvcnNcbiAgSU5WQUxJRF9DUkVERU5USUFMUzogJ0lOVkFMSURfQ1JFREVOVElBTFMnLFxuICBVU0VSX05PVF9GT1VORDogJ1VTRVJfTk9UX0ZPVU5EJyxcbiAgVVNFUl9BTFJFQURZX0VYSVNUUzogJ1VTRVJfQUxSRUFEWV9FWElTVFMnLFxuICBVTkFVVEhPUklaRUQ6ICdVTkFVVEhPUklaRUQnLFxuICBTRVNTSU9OX0VYUElSRUQ6ICdTRVNTSU9OX0VYUElSRUQnLFxuXG4gIC8vIFZhbGlkYXRpb24gZXJyb3JzXG4gIFZBTElEQVRJT05fRVJST1I6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgSU5WQUxJRF9JTlBVVDogJ0lOVkFMSURfSU5QVVQnLFxuICBNSVNTSU5HX1JFUVVJUkVEX0ZJRUxEOiAnTUlTU0lOR19SRVFVSVJFRF9GSUVMRCcsXG5cbiAgLy8gUmVzb3VyY2UgZXJyb3JzXG4gIFJFU09VUkNFX05PVF9GT1VORDogJ1JFU09VUkNFX05PVF9GT1VORCcsXG4gIFJFU09VUkNFX0FMUkVBRFlfRVhJU1RTOiAnUkVTT1VSQ0VfQUxSRUFEWV9FWElTVFMnLFxuICBSRVNPVVJDRV9GT1JCSURERU46ICdSRVNPVVJDRV9GT1JCSURERU4nLFxuXG4gIC8vIFNlcnZlciBlcnJvcnNcbiAgSU5URVJOQUxfU0VSVkVSX0VSUk9SOiAnSU5URVJOQUxfU0VSVkVSX0VSUk9SJyxcbiAgREFUQUJBU0VfRVJST1I6ICdEQVRBQkFTRV9FUlJPUicsXG4gIEVYVEVSTkFMX1NFUlZJQ0VfRVJST1I6ICdFWFRFUk5BTF9TRVJWSUNFX0VSUk9SJyxcblxuICAvLyBSYXRlIGxpbWl0aW5nXG4gIFJBVEVfTElNSVRfRVhDRUVERUQ6ICdSQVRFX0xJTUlUX0VYQ0VFREVEJyxcbn0gYXMgY29uc3RcblxuLy8gSFRUUCBzdGF0dXMgY29kZXNcbmV4cG9ydCBjb25zdCBIVFRQX1NUQVRVUyA9IHtcbiAgT0s6IDIwMCxcbiAgQ1JFQVRFRDogMjAxLFxuICBOT19DT05URU5UOiAyMDQsXG4gIEJBRF9SRVFVRVNUOiA0MDAsXG4gIFVOQVVUSE9SSVpFRDogNDAxLFxuICBGT1JCSURERU46IDQwMyxcbiAgTk9UX0ZPVU5EOiA0MDQsXG4gIE1FVEhPRF9OT1RfQUxMT1dFRDogNDA1LFxuICBDT05GTElDVDogNDA5LFxuICBVTlBST0NFU1NBQkxFX0VOVElUWTogNDIyLFxuICBUT09fTUFOWV9SRVFVRVNUUzogNDI5LFxuICBJTlRFUk5BTF9TRVJWRVJfRVJST1I6IDUwMCxcbiAgQkFEX0dBVEVXQVk6IDUwMixcbiAgU0VSVklDRV9VTkFWQUlMQUJMRTogNTAzLFxufSBhcyBjb25zdFxuXG4vLyBDYWNoZSBrZXlzXG5leHBvcnQgY29uc3QgQ0FDSEVfS0VZUyA9IHtcbiAgVklERU9TOiAndmlkZW9zJyxcbiAgVVNFUjogKGlkOiBzdHJpbmcpID0+IGB1c2VyOiR7aWR9YCxcbiAgVklERU86IChpZDogc3RyaW5nKSA9PiBgdmlkZW86JHtpZH1gLFxuICBUQUdTOiAndGFncycsXG4gIFVTRVJfVklERU9TOiAodXNlcklkOiBzdHJpbmcpID0+IGB1c2VyOiR7dXNlcklkfTp2aWRlb3NgLFxufSBhcyBjb25zdFxuXG4vLyBDYWNoZSBUVEwgKGluIHNlY29uZHMpXG5leHBvcnQgY29uc3QgQ0FDSEVfVFRMID0ge1xuICBTSE9SVDogMzAwLCAvLyA1IG1pbnV0ZXNcbiAgTUVESVVNOiAxODAwLCAvLyAzMCBtaW51dGVzXG4gIExPTkc6IDM2MDAsIC8vIDEgaG91clxuICBWRVJZX0xPTkc6IDg2NDAwLCAvLyAyNCBob3Vyc1xufSBhcyBjb25zdFxuXG4vLyBFbnZpcm9ubWVudCB0eXBlc1xuZXhwb3J0IGNvbnN0IE5PREVfRU5WID0ge1xuICBERVZFTE9QTUVOVDogJ2RldmVsb3BtZW50JyxcbiAgUFJPRFVDVElPTjogJ3Byb2R1Y3Rpb24nLFxuICBURVNUOiAndGVzdCcsXG59IGFzIGNvbnN0XG5cbi8vIFN1cHBvcnRlZCB2aWRlbyBwbGF0Zm9ybXNcbmV4cG9ydCBjb25zdCBWSURFT19QTEFURk9STVMgPSB7XG4gIFlPVVRVQkU6ICd5b3V0dWJlJyxcbiAgVklNRU86ICd2aW1lbycsXG59IGFzIGNvbnN0XG5cbi8vIFJhdGluZyBsZXZlbHNcbmV4cG9ydCBjb25zdCBSQVRJTkdfTEVWRUxTID0ge1xuICBNSU46IDEsXG4gIE1BWDogNSxcbiAgREVGQVVMVDogMyxcbn0gYXMgY29uc3RcblxuLy8gRGVmYXVsdCB2YWx1ZXNcbmV4cG9ydCBjb25zdCBERUZBVUxUUyA9IHtcbiAgQVZBVEFSX1VSTDogJy9pbWFnZXMvZGVmYXVsdC1hdmF0YXIucG5nJyxcbiAgVklERU9fVEhVTUJOQUlMOiAnL2ltYWdlcy9kZWZhdWx0LXZpZGVvLXRodW1ibmFpbC5wbmcnLFxuICBQQUdJTkFUSU9OX0xJTUlUOiBQQUdJTkFUSU9OLkRFRkFVTFRfUEFHRV9TSVpFLFxuICBSQVRJTkdfTEVWRUw6IFJBVElOR19MRVZFTFMuREVGQVVMVCxcbn0gYXMgY29uc3RcblxuLy8gRmVhdHVyZSBmbGFnc1xuZXhwb3J0IGNvbnN0IEZFQVRVUkVTID0ge1xuICBWSURFT19VUExPQUQ6IHRydWUsXG4gIFVTRVJfUkVHSVNUUkFUSU9OOiB0cnVlLFxuICBWSURFT19SQVRJTkc6IHRydWUsXG4gIFVTRVJfRk9MTE9XSU5HOiB0cnVlLFxuICBTRUFSQ0g6IHRydWUsXG4gIEFETUlOX1BBTkVMOiBmYWxzZSxcbn0gYXMgY29uc3RcblxuLy8gRXh0ZXJuYWwgc2VydmljZSBVUkxzXG5leHBvcnQgY29uc3QgRVhURVJOQUxfU0VSVklDRVMgPSB7XG4gIFlPVVRVQkVfQVBJOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20veW91dHViZS92MycsXG4gIFZJTUVPX0FQSTogJ2h0dHBzOi8vYXBpLnZpbWVvLmNvbScsXG59IGFzIGNvbnN0XG5cbi8vIEZpbGUgdXBsb2FkIGxpbWl0c1xuZXhwb3J0IGNvbnN0IFVQTE9BRF9MSU1JVFMgPSB7XG4gIE1BWF9GSUxFX1NJWkU6IDEwICogMTAyNCAqIDEwMjQsIC8vIDEwTUJcbiAgQUxMT1dFRF9JTUFHRV9UWVBFUzogWydpbWFnZS9qcGVnJywgJ2ltYWdlL3BuZycsICdpbWFnZS9naWYnLCAnaW1hZ2Uvd2VicCddLFxuICBBTExPV0VEX1ZJREVPX1RZUEVTOiBbJ3ZpZGVvL21wNCcsICd2aWRlby93ZWJtJywgJ3ZpZGVvL29nZyddLFxufSBhcyBjb25zdFxuXG4vLyBTRU8gY29uc3RhbnRzXG5leHBvcnQgY29uc3QgU0VPID0ge1xuICBERUZBVUxUX1RJVExFOiBBUFBfTkFNRSxcbiAgVElUTEVfVEVNUExBVEU6IGAlcyB8ICR7QVBQX05BTUV9YCxcbiAgREVGQVVMVF9ERVNDUklQVElPTjogQVBQX0RFU0NSSVBUSU9OLFxuICBUV0lUVEVSX0hBTkRMRTogJ0ByYXRlbWUnLFxuICBTSVRFX1VSTDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxufSBhcyBjb25zdFxuXG4vLyBTb2NpYWwgc2hhcmluZ1xuZXhwb3J0IGNvbnN0IFNPQ0lBTF9QTEFURk9STVMgPSB7XG4gIFRXSVRURVI6ICd0d2l0dGVyJyxcbiAgRkFDRUJPT0s6ICdmYWNlYm9vaycsXG4gIExJTktFRElOOiAnbGlua2VkaW4nLFxuICBSRURESVQ6ICdyZWRkaXQnLFxufSBhcyBjb25zdCJdLCJuYW1lcyI6WyJBUFBfTkFNRSIsIkFQUF9ERVNDUklQVElPTiIsIkFQUF9WRVJTSU9OIiwiQVBJX1JPVVRFUyIsIkFVVEgiLCJTSUdOSU4iLCJTSUdOVVAiLCJTSUdOT1VUIiwiVklERU9TIiwiQkFTRSIsIkJZX0lEIiwiaWQiLCJSQVRFIiwiVVNFUlMiLCJGT0xMT1ciLCJQQUdJTkFUSU9OIiwiREVGQVVMVF9QQUdFX1NJWkUiLCJNQVhfUEFHRV9TSVpFIiwiVklERU9fTElNSVRTIiwiTUFYX1RJVExFX0xFTkdUSCIsIk1BWF9ERVNDUklQVElPTl9MRU5HVEgiLCJVU0VSX0xJTUlUUyIsIk1JTl9VU0VSTkFNRV9MRU5HVEgiLCJNQVhfVVNFUk5BTUVfTEVOR1RIIiwiTUlOX1BBU1NXT1JEX0xFTkdUSCIsIk1BWF9QQVNTV09SRF9MRU5HVEgiLCJWQUxJREFUSU9OX1BBVFRFUk5TIiwiRU1BSUwiLCJVU0VSTkFNRSIsIllPVVRVQkVfVVJMIiwiVklNRU9fVVJMIiwiRVJST1JfQ09ERVMiLCJJTlZBTElEX0NSRURFTlRJQUxTIiwiVVNFUl9OT1RfRk9VTkQiLCJVU0VSX0FMUkVBRFlfRVhJU1RTIiwiVU5BVVRIT1JJWkVEIiwiU0VTU0lPTl9FWFBJUkVEIiwiVkFMSURBVElPTl9FUlJPUiIsIklOVkFMSURfSU5QVVQiLCJNSVNTSU5HX1JFUVVJUkVEX0ZJRUxEIiwiUkVTT1VSQ0VfTk9UX0ZPVU5EIiwiUkVTT1VSQ0VfQUxSRUFEWV9FWElTVFMiLCJSRVNPVVJDRV9GT1JCSURERU4iLCJJTlRFUk5BTF9TRVJWRVJfRVJST1IiLCJEQVRBQkFTRV9FUlJPUiIsIkVYVEVSTkFMX1NFUlZJQ0VfRVJST1IiLCJSQVRFX0xJTUlUX0VYQ0VFREVEIiwiSFRUUF9TVEFUVVMiLCJPSyIsIkNSRUFURUQiLCJOT19DT05URU5UIiwiQkFEX1JFUVVFU1QiLCJGT1JCSURERU4iLCJOT1RfRk9VTkQiLCJNRVRIT0RfTk9UX0FMTE9XRUQiLCJDT05GTElDVCIsIlVOUFJPQ0VTU0FCTEVfRU5USVRZIiwiVE9PX01BTllfUkVRVUVTVFMiLCJCQURfR0FURVdBWSIsIlNFUlZJQ0VfVU5BVkFJTEFCTEUiLCJDQUNIRV9LRVlTIiwiVVNFUiIsIlZJREVPIiwiVEFHUyIsIlVTRVJfVklERU9TIiwidXNlcklkIiwiQ0FDSEVfVFRMIiwiU0hPUlQiLCJNRURJVU0iLCJMT05HIiwiVkVSWV9MT05HIiwiTk9ERV9FTlYiLCJERVZFTE9QTUVOVCIsIlBST0RVQ1RJT04iLCJURVNUIiwiVklERU9fUExBVEZPUk1TIiwiWU9VVFVCRSIsIlZJTUVPIiwiUkFUSU5HX0xFVkVMUyIsIk1JTiIsIk1BWCIsIkRFRkFVTFQiLCJERUZBVUxUUyIsIkFWQVRBUl9VUkwiLCJWSURFT19USFVNQk5BSUwiLCJQQUdJTkFUSU9OX0xJTUlUIiwiUkFUSU5HX0xFVkVMIiwiRkVBVFVSRVMiLCJWSURFT19VUExPQUQiLCJVU0VSX1JFR0lTVFJBVElPTiIsIlZJREVPX1JBVElORyIsIlVTRVJfRk9MTE9XSU5HIiwiU0VBUkNIIiwiQURNSU5fUEFORUwiLCJFWFRFUk5BTF9TRVJWSUNFUyIsIllPVVRVQkVfQVBJIiwiVklNRU9fQVBJIiwiVVBMT0FEX0xJTUlUUyIsIk1BWF9GSUxFX1NJWkUiLCJBTExPV0VEX0lNQUdFX1RZUEVTIiwiQUxMT1dFRF9WSURFT19UWVBFUyIsIlNFTyIsIkRFRkFVTFRfVElUTEUiLCJUSVRMRV9URU1QTEFURSIsIkRFRkFVTFRfREVTQ1JJUFRJT04iLCJUV0lUVEVSX0hBTkRMRSIsIlNJVEVfVVJMIiwicHJvY2VzcyIsImVudiIsIk5FWFRBVVRIX1VSTCIsIlNPQ0lBTF9QTEFURk9STVMiLCJUV0lUVEVSIiwiRkFDRUJPT0siLCJMSU5LRURJTiIsIlJFRERJVCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/constants.ts\n");

/***/ }),

/***/ "(api)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst db = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = db;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLEtBQUtGLGdCQUFnQkcsTUFBTSxJQUFJLElBQUlKLHdEQUFZQSxHQUFFO0FBRTlELElBQUlLLElBQXlCLEVBQWNKLGdCQUFnQkcsTUFBTSxHQUFHRCIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdGVteS1uZXh0anMvLi9zcmMvbGliL2RiLnRzPzllNGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBkYiA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCgpXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gZGIiXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsImRiIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/db.ts\n");

/***/ }),

/***/ "(api)/./src/lib/errors.ts":
/*!***************************!*\
  !*** ./src/lib/errors.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppError: () => (/* binding */ AppError),\n/* harmony export */   AuthenticationError: () => (/* binding */ AuthenticationError),\n/* harmony export */   AuthorizationError: () => (/* binding */ AuthorizationError),\n/* harmony export */   ConflictError: () => (/* binding */ ConflictError),\n/* harmony export */   DatabaseError: () => (/* binding */ DatabaseError),\n/* harmony export */   ExternalServiceError: () => (/* binding */ ExternalServiceError),\n/* harmony export */   NotFoundError: () => (/* binding */ NotFoundError),\n/* harmony export */   RateLimitError: () => (/* binding */ RateLimitError),\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError),\n/* harmony export */   asyncWrapper: () => (/* binding */ asyncWrapper),\n/* harmony export */   createConflictError: () => (/* binding */ createConflictError),\n/* harmony export */   createNotFoundError: () => (/* binding */ createNotFoundError),\n/* harmony export */   createValidationError: () => (/* binding */ createValidationError),\n/* harmony export */   extractErrorCode: () => (/* binding */ extractErrorCode),\n/* harmony export */   extractErrorMessage: () => (/* binding */ extractErrorMessage),\n/* harmony export */   extractStatusCode: () => (/* binding */ extractStatusCode),\n/* harmony export */   handlePromiseRejection: () => (/* binding */ handlePromiseRejection),\n/* harmony export */   isAppError: () => (/* binding */ isAppError),\n/* harmony export */   isOperationalError: () => (/* binding */ isOperationalError),\n/* harmony export */   serializeError: () => (/* binding */ serializeError)\n/* harmony export */ });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ \"(api)/./src/lib/constants.ts\");\n\nclass AppError extends Error {\n    constructor(message, code = _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.INTERNAL_SERVER_ERROR, statusCode = _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.INTERNAL_SERVER_ERROR, isOperational = true, context){\n        super(message);\n        this.name = this.constructor.name;\n        this.code = code;\n        this.statusCode = statusCode;\n        this.isOperational = isOperational;\n        this.context = context;\n        Error.captureStackTrace(this, this.constructor);\n    }\n}\n// Specific error classes\nclass ValidationError extends AppError {\n    constructor(message, field, context){\n        super(message, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.VALIDATION_ERROR, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.BAD_REQUEST, true, {\n            field,\n            ...context\n        });\n    }\n}\nclass AuthenticationError extends AppError {\n    constructor(message = \"Authentication failed\", context){\n        super(message, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.UNAUTHORIZED, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.UNAUTHORIZED, true, context);\n    }\n}\nclass AuthorizationError extends AppError {\n    constructor(message = \"Access forbidden\", context){\n        super(message, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.RESOURCE_FORBIDDEN, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.FORBIDDEN, true, context);\n    }\n}\nclass NotFoundError extends AppError {\n    constructor(resource = \"Resource\", context){\n        super(`${resource} not found`, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.RESOURCE_NOT_FOUND, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.NOT_FOUND, true, context);\n    }\n}\nclass ConflictError extends AppError {\n    constructor(message, context){\n        super(message, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.RESOURCE_ALREADY_EXISTS, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.CONFLICT, true, context);\n    }\n}\nclass DatabaseError extends AppError {\n    constructor(message, context){\n        super(message, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.DATABASE_ERROR, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.INTERNAL_SERVER_ERROR, true, context);\n    }\n}\nclass ExternalServiceError extends AppError {\n    constructor(service, message, context){\n        super(`External service error (${service}): ${message}`, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.EXTERNAL_SERVICE_ERROR, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.BAD_GATEWAY, true, context);\n    }\n}\nclass RateLimitError extends AppError {\n    constructor(message = \"Rate limit exceeded\", context){\n        super(message, _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.RATE_LIMIT_EXCEEDED, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.TOO_MANY_REQUESTS, true, context);\n    }\n}\n// Error factory functions\nfunction createValidationError(field, message, value) {\n    return new ValidationError(message, field, {\n        value\n    });\n}\nfunction createNotFoundError(resource, id) {\n    return new NotFoundError(resource, {\n        id\n    });\n}\nfunction createConflictError(resource, field, value) {\n    return new ConflictError(`${resource} with ${field} '${value}' already exists`, {\n        resource,\n        field,\n        value\n    });\n}\n// Error handling utilities\nfunction isAppError(error) {\n    return error instanceof AppError;\n}\nfunction isOperationalError(error) {\n    if (isAppError(error)) {\n        return error.isOperational;\n    }\n    return false;\n}\nfunction extractErrorMessage(error) {\n    if (error instanceof Error) {\n        return error.message;\n    }\n    if (typeof error === \"string\") {\n        return error;\n    }\n    return \"An unknown error occurred\";\n}\nfunction extractErrorCode(error) {\n    if (isAppError(error)) {\n        return error.code;\n    }\n    return _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.INTERNAL_SERVER_ERROR;\n}\nfunction extractStatusCode(error) {\n    if (isAppError(error)) {\n        return error.statusCode;\n    }\n    return _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.INTERNAL_SERVER_ERROR;\n}\nfunction serializeError(error, includeStack = false) {\n    const serialized = {\n        message: extractErrorMessage(error),\n        code: extractErrorCode(error),\n        statusCode: extractStatusCode(error)\n    };\n    if (isAppError(error) && error.context) {\n        serialized.context = error.context;\n    }\n    if (includeStack && error instanceof Error) {\n        serialized.stack = error.stack;\n    }\n    return serialized;\n}\n// Async error wrapper\nfunction asyncWrapper(fn) {\n    return async (...args)=>{\n        try {\n            return await fn(...args);\n        } catch (error) {\n            if (isOperationalError(error)) {\n                throw error;\n            }\n            // Convert non-operational errors to operational ones\n            throw new AppError(extractErrorMessage(error), _constants__WEBPACK_IMPORTED_MODULE_0__.ERROR_CODES.INTERNAL_SERVER_ERROR, _constants__WEBPACK_IMPORTED_MODULE_0__.HTTP_STATUS.INTERNAL_SERVER_ERROR, false, {\n                originalError: error\n            });\n        }\n    };\n}\n// Promise error handler\nfunction handlePromiseRejection(promise) {\n    return promise.catch((error)=>{\n        if (!isOperationalError(error)) {\n            // Log unexpected errors\n            console.error(\"Unhandled promise rejection:\", error);\n        }\n        throw error;\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBcUI7QUFDMUM7QUFXTyxTQUFTMEMsZUFBZUwsS0FBVSxFQUFFTSxlQUF3QixLQUFLO0lBQ3RFLE1BQU1DLGFBQThCO1FBQ2xDOUMsU0FBU3lDLG9CQUFvQkY7UUFDN0J0QyxNQUFNeUMsaUJBQWlCSDtRQUN2QnBDLFlBQVl3QyxrQkFBa0JKO0lBQ2hDO0lBRUEsSUFBSUQsV0FBV0MsVUFBVUEsTUFBTWxDLE9BQU8sRUFBRTtRQUN0Q3lDLFdBQVd6QyxPQUFPLEdBQUdrQyxNQUFNbEMsT0FBTztJQUNwQztJQUVBLElBQUl3QyxnQkFBZ0JOLGlCQUFpQnpDLE9BQU87UUFDMUNnRCxXQUFXQyxLQUFLLEdBQUdSLE1BQU1RLEtBQUs7SUFDaEM7SUFFQSxPQUFPRDtBQUNUO0FBRUEsc0JBQXNCO0FBQ2YsU0FBU0UsYUFDZEMsRUFBOEI7SUFFOUIsT0FBTyxPQUFPLEdBQUdDO1FBQ2YsSUFBSTtZQUNGLE9BQU8sTUFBTUQsTUFBTUM7UUFDckIsRUFBRSxPQUFPWCxPQUFPO1lBQ2QsSUFBSUMsbUJBQW1CRCxRQUFRO2dCQUM3QixNQUFNQTtZQUNSO1lBRUEscURBQXFEO1lBQ3JELE1BQU0sSUFBSTFDLFNBQ1I0QyxvQkFBb0JGLFFBQ3BCNUMsbURBQVdBLENBQUNPLHFCQUFxQixFQUNqQ04sbURBQVdBLENBQUNNLHFCQUFxQixFQUNqQyxPQUNBO2dCQUFFaUQsZUFBZVo7WUFBTTtRQUUzQjtJQUNGO0FBQ0Y7QUFFQSx3QkFBd0I7QUFDakIsU0FBU2EsdUJBQXVCQyxPQUFxQjtJQUMxRCxPQUFPQSxRQUFRQyxLQUFLLENBQUMsQ0FBQ2Y7UUFDcEIsSUFBSSxDQUFDQyxtQkFBbUJELFFBQVE7WUFDOUIsd0JBQXdCO1lBQ3hCZ0IsUUFBUWhCLEtBQUssQ0FBQyxnQ0FBZ0NBO1FBQ2hEO1FBQ0EsTUFBTUE7SUFDUjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9saWIvZXJyb3JzLnRzPzQ1MWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRVJST1JfQ09ERVMsIEhUVFBfU1RBVFVTIH0gZnJvbSAnLi9jb25zdGFudHMnXG5cbmV4cG9ydCBjbGFzcyBBcHBFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHVibGljIHJlYWRvbmx5IGNvZGU6IHN0cmluZ1xuICBwdWJsaWMgcmVhZG9ubHkgc3RhdHVzQ29kZTogbnVtYmVyXG4gIHB1YmxpYyByZWFkb25seSBpc09wZXJhdGlvbmFsOiBib29sZWFuXG4gIHB1YmxpYyByZWFkb25seSBjb250ZXh0PzogYW55XG5cbiAgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGNvZGU6IHN0cmluZyA9IEVSUk9SX0NPREVTLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICBzdGF0dXNDb2RlOiBudW1iZXIgPSBIVFRQX1NUQVRVUy5JTlRFUk5BTF9TRVJWRVJfRVJST1IsXG4gICAgaXNPcGVyYXRpb25hbDogYm9vbGVhbiA9IHRydWUsXG4gICAgY29udGV4dD86IGFueVxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIFxuICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZVxuICAgIHRoaXMuY29kZSA9IGNvZGVcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlXG4gICAgdGhpcy5pc09wZXJhdGlvbmFsID0gaXNPcGVyYXRpb25hbFxuICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHRcblxuICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpXG4gIH1cbn1cblxuLy8gU3BlY2lmaWMgZXJyb3IgY2xhc3Nlc1xuZXhwb3J0IGNsYXNzIFZhbGlkYXRpb25FcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBmaWVsZD86IHN0cmluZywgY29udGV4dD86IGFueSkge1xuICAgIHN1cGVyKFxuICAgICAgbWVzc2FnZSxcbiAgICAgIEVSUk9SX0NPREVTLlZBTElEQVRJT05fRVJST1IsXG4gICAgICBIVFRQX1NUQVRVUy5CQURfUkVRVUVTVCxcbiAgICAgIHRydWUsXG4gICAgICB7IGZpZWxkLCAuLi5jb250ZXh0IH1cbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZyA9ICdBdXRoZW50aWNhdGlvbiBmYWlsZWQnLCBjb250ZXh0PzogYW55KSB7XG4gICAgc3VwZXIoXG4gICAgICBtZXNzYWdlLFxuICAgICAgRVJST1JfQ09ERVMuVU5BVVRIT1JJWkVELFxuICAgICAgSFRUUF9TVEFUVVMuVU5BVVRIT1JJWkVELFxuICAgICAgdHJ1ZSxcbiAgICAgIGNvbnRleHRcbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEF1dGhvcml6YXRpb25FcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nID0gJ0FjY2VzcyBmb3JiaWRkZW4nLCBjb250ZXh0PzogYW55KSB7XG4gICAgc3VwZXIoXG4gICAgICBtZXNzYWdlLFxuICAgICAgRVJST1JfQ09ERVMuUkVTT1VSQ0VfRk9SQklEREVOLFxuICAgICAgSFRUUF9TVEFUVVMuRk9SQklEREVOLFxuICAgICAgdHJ1ZSxcbiAgICAgIGNvbnRleHRcbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE5vdEZvdW5kRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHJlc291cmNlOiBzdHJpbmcgPSAnUmVzb3VyY2UnLCBjb250ZXh0PzogYW55KSB7XG4gICAgc3VwZXIoXG4gICAgICBgJHtyZXNvdXJjZX0gbm90IGZvdW5kYCxcbiAgICAgIEVSUk9SX0NPREVTLlJFU09VUkNFX05PVF9GT1VORCxcbiAgICAgIEhUVFBfU1RBVFVTLk5PVF9GT1VORCxcbiAgICAgIHRydWUsXG4gICAgICBjb250ZXh0XG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDb25mbGljdEVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBhbnkpIHtcbiAgICBzdXBlcihcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBFUlJPUl9DT0RFUy5SRVNPVVJDRV9BTFJFQURZX0VYSVNUUyxcbiAgICAgIEhUVFBfU1RBVFVTLkNPTkZMSUNULFxuICAgICAgdHJ1ZSxcbiAgICAgIGNvbnRleHRcbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERhdGFiYXNlRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IGFueSkge1xuICAgIHN1cGVyKFxuICAgICAgbWVzc2FnZSxcbiAgICAgIEVSUk9SX0NPREVTLkRBVEFCQVNFX0VSUk9SLFxuICAgICAgSFRUUF9TVEFUVVMuSU5URVJOQUxfU0VSVkVSX0VSUk9SLFxuICAgICAgdHJ1ZSxcbiAgICAgIGNvbnRleHRcbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEV4dGVybmFsU2VydmljZUVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihzZXJ2aWNlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IGFueSkge1xuICAgIHN1cGVyKFxuICAgICAgYEV4dGVybmFsIHNlcnZpY2UgZXJyb3IgKCR7c2VydmljZX0pOiAke21lc3NhZ2V9YCxcbiAgICAgIEVSUk9SX0NPREVTLkVYVEVSTkFMX1NFUlZJQ0VfRVJST1IsXG4gICAgICBIVFRQX1NUQVRVUy5CQURfR0FURVdBWSxcbiAgICAgIHRydWUsXG4gICAgICBjb250ZXh0XG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSYXRlTGltaXRFcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nID0gJ1JhdGUgbGltaXQgZXhjZWVkZWQnLCBjb250ZXh0PzogYW55KSB7XG4gICAgc3VwZXIoXG4gICAgICBtZXNzYWdlLFxuICAgICAgRVJST1JfQ09ERVMuUkFURV9MSU1JVF9FWENFRURFRCxcbiAgICAgIEhUVFBfU1RBVFVTLlRPT19NQU5ZX1JFUVVFU1RTLFxuICAgICAgdHJ1ZSxcbiAgICAgIGNvbnRleHRcbiAgICApXG4gIH1cbn1cblxuLy8gRXJyb3IgZmFjdG9yeSBmdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVWYWxpZGF0aW9uRXJyb3IoZmllbGQ6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCB2YWx1ZT86IGFueSk6IFZhbGlkYXRpb25FcnJvciB7XG4gIHJldHVybiBuZXcgVmFsaWRhdGlvbkVycm9yKG1lc3NhZ2UsIGZpZWxkLCB7IHZhbHVlIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOb3RGb3VuZEVycm9yKHJlc291cmNlOiBzdHJpbmcsIGlkPzogc3RyaW5nKTogTm90Rm91bmRFcnJvciB7XG4gIHJldHVybiBuZXcgTm90Rm91bmRFcnJvcihyZXNvdXJjZSwgeyBpZCB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29uZmxpY3RFcnJvcihyZXNvdXJjZTogc3RyaW5nLCBmaWVsZDogc3RyaW5nLCB2YWx1ZTogYW55KTogQ29uZmxpY3RFcnJvciB7XG4gIHJldHVybiBuZXcgQ29uZmxpY3RFcnJvcihcbiAgICBgJHtyZXNvdXJjZX0gd2l0aCAke2ZpZWxkfSAnJHt2YWx1ZX0nIGFscmVhZHkgZXhpc3RzYCxcbiAgICB7IHJlc291cmNlLCBmaWVsZCwgdmFsdWUgfVxuICApXG59XG5cbi8vIEVycm9yIGhhbmRsaW5nIHV0aWxpdGllc1xuZXhwb3J0IGZ1bmN0aW9uIGlzQXBwRXJyb3IoZXJyb3I6IGFueSk6IGVycm9yIGlzIEFwcEVycm9yIHtcbiAgcmV0dXJuIGVycm9yIGluc3RhbmNlb2YgQXBwRXJyb3Jcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzT3BlcmF0aW9uYWxFcnJvcihlcnJvcjogYW55KTogYm9vbGVhbiB7XG4gIGlmIChpc0FwcEVycm9yKGVycm9yKSkge1xuICAgIHJldHVybiBlcnJvci5pc09wZXJhdGlvbmFsXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0RXJyb3JNZXNzYWdlKGVycm9yOiBhbnkpOiBzdHJpbmcge1xuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHJldHVybiBlcnJvci5tZXNzYWdlXG4gIH1cbiAgaWYgKHR5cGVvZiBlcnJvciA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZXJyb3JcbiAgfVxuICByZXR1cm4gJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0RXJyb3JDb2RlKGVycm9yOiBhbnkpOiBzdHJpbmcge1xuICBpZiAoaXNBcHBFcnJvcihlcnJvcikpIHtcbiAgICByZXR1cm4gZXJyb3IuY29kZVxuICB9XG4gIHJldHVybiBFUlJPUl9DT0RFUy5JTlRFUk5BTF9TRVJWRVJfRVJST1Jcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RTdGF0dXNDb2RlKGVycm9yOiBhbnkpOiBudW1iZXIge1xuICBpZiAoaXNBcHBFcnJvcihlcnJvcikpIHtcbiAgICByZXR1cm4gZXJyb3Iuc3RhdHVzQ29kZVxuICB9XG4gIHJldHVybiBIVFRQX1NUQVRVUy5JTlRFUk5BTF9TRVJWRVJfRVJST1Jcbn1cblxuLy8gRXJyb3Igc2VyaWFsaXphdGlvblxuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkRXJyb3Ige1xuICBtZXNzYWdlOiBzdHJpbmdcbiAgY29kZTogc3RyaW5nXG4gIHN0YXR1c0NvZGU6IG51bWJlclxuICBjb250ZXh0PzogYW55XG4gIHN0YWNrPzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVFcnJvcihlcnJvcjogYW55LCBpbmNsdWRlU3RhY2s6IGJvb2xlYW4gPSBmYWxzZSk6IFNlcmlhbGl6ZWRFcnJvciB7XG4gIGNvbnN0IHNlcmlhbGl6ZWQ6IFNlcmlhbGl6ZWRFcnJvciA9IHtcbiAgICBtZXNzYWdlOiBleHRyYWN0RXJyb3JNZXNzYWdlKGVycm9yKSxcbiAgICBjb2RlOiBleHRyYWN0RXJyb3JDb2RlKGVycm9yKSxcbiAgICBzdGF0dXNDb2RlOiBleHRyYWN0U3RhdHVzQ29kZShlcnJvciksXG4gIH1cblxuICBpZiAoaXNBcHBFcnJvcihlcnJvcikgJiYgZXJyb3IuY29udGV4dCkge1xuICAgIHNlcmlhbGl6ZWQuY29udGV4dCA9IGVycm9yLmNvbnRleHRcbiAgfVxuXG4gIGlmIChpbmNsdWRlU3RhY2sgJiYgZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHNlcmlhbGl6ZWQuc3RhY2sgPSBlcnJvci5zdGFja1xuICB9XG5cbiAgcmV0dXJuIHNlcmlhbGl6ZWRcbn1cblxuLy8gQXN5bmMgZXJyb3Igd3JhcHBlclxuZXhwb3J0IGZ1bmN0aW9uIGFzeW5jV3JhcHBlcjxUIGV4dGVuZHMgYW55W10sIFI+KFxuICBmbjogKC4uLmFyZ3M6IFQpID0+IFByb21pc2U8Uj5cbikge1xuICByZXR1cm4gYXN5bmMgKC4uLmFyZ3M6IFQpOiBQcm9taXNlPFI+ID0+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGZuKC4uLmFyZ3MpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChpc09wZXJhdGlvbmFsRXJyb3IoZXJyb3IpKSB7XG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENvbnZlcnQgbm9uLW9wZXJhdGlvbmFsIGVycm9ycyB0byBvcGVyYXRpb25hbCBvbmVzXG4gICAgICB0aHJvdyBuZXcgQXBwRXJyb3IoXG4gICAgICAgIGV4dHJhY3RFcnJvck1lc3NhZ2UoZXJyb3IpLFxuICAgICAgICBFUlJPUl9DT0RFUy5JTlRFUk5BTF9TRVJWRVJfRVJST1IsXG4gICAgICAgIEhUVFBfU1RBVFVTLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIHsgb3JpZ2luYWxFcnJvcjogZXJyb3IgfVxuICAgICAgKVxuICAgIH1cbiAgfVxufVxuXG4vLyBQcm9taXNlIGVycm9yIGhhbmRsZXJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVQcm9taXNlUmVqZWN0aW9uKHByb21pc2U6IFByb21pc2U8YW55Pik6IFByb21pc2U8YW55PiB7XG4gIHJldHVybiBwcm9taXNlLmNhdGNoKChlcnJvcikgPT4ge1xuICAgIGlmICghaXNPcGVyYXRpb25hbEVycm9yKGVycm9yKSkge1xuICAgICAgLy8gTG9nIHVuZXhwZWN0ZWQgZXJyb3JzXG4gICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb246JywgZXJyb3IpXG4gICAgfVxuICAgIHRocm93IGVycm9yXG4gIH0pXG59Il0sIm5hbWVzIjpbIkVSUk9SX0NPREVTIiwiSFRUUF9TVEFUVVMiLCJBcHBFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwiY29kZSIsIklOVEVSTkFMX1NFUlZFUl9FUlJPUiIsInN0YXR1c0NvZGUiLCJpc09wZXJhdGlvbmFsIiwiY29udGV4dCIsIm5hbWUiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIlZhbGlkYXRpb25FcnJvciIsImZpZWxkIiwiVkFMSURBVElPTl9FUlJPUiIsIkJBRF9SRVFVRVNUIiwiQXV0aGVudGljYXRpb25FcnJvciIsIlVOQVVUSE9SSVpFRCIsIkF1dGhvcml6YXRpb25FcnJvciIsIlJFU09VUkNFX0ZPUkJJRERFTiIsIkZPUkJJRERFTiIsIk5vdEZvdW5kRXJyb3IiLCJyZXNvdXJjZSIsIlJFU09VUkNFX05PVF9GT1VORCIsIk5PVF9GT1VORCIsIkNvbmZsaWN0RXJyb3IiLCJSRVNPVVJDRV9BTFJFQURZX0VYSVNUUyIsIkNPTkZMSUNUIiwiRGF0YWJhc2VFcnJvciIsIkRBVEFCQVNFX0VSUk9SIiwiRXh0ZXJuYWxTZXJ2aWNlRXJyb3IiLCJzZXJ2aWNlIiwiRVhURVJOQUxfU0VSVklDRV9FUlJPUiIsIkJBRF9HQVRFV0FZIiwiUmF0ZUxpbWl0RXJyb3IiLCJSQVRFX0xJTUlUX0VYQ0VFREVEIiwiVE9PX01BTllfUkVRVUVTVFMiLCJjcmVhdGVWYWxpZGF0aW9uRXJyb3IiLCJ2YWx1ZSIsImNyZWF0ZU5vdEZvdW5kRXJyb3IiLCJpZCIsImNyZWF0ZUNvbmZsaWN0RXJyb3IiLCJpc0FwcEVycm9yIiwiZXJyb3IiLCJpc09wZXJhdGlvbmFsRXJyb3IiLCJleHRyYWN0RXJyb3JNZXNzYWdlIiwiZXh0cmFjdEVycm9yQ29kZSIsImV4dHJhY3RTdGF0dXNDb2RlIiwic2VyaWFsaXplRXJyb3IiLCJpbmNsdWRlU3RhY2siLCJzZXJpYWxpemVkIiwic3RhY2siLCJhc3luY1dyYXBwZXIiLCJmbiIsImFyZ3MiLCJvcmlnaW5hbEVycm9yIiwiaGFuZGxlUHJvbWlzZVJlamVjdGlvbiIsInByb21pc2UiLCJjYXRjaCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/lib/errors.ts\n");

/***/ }),

/***/ "(api)/./src/lib/logger.ts":
/*!***************************!*\
  !*** ./src/lib/logger.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LogLevel: () => (/* binding */ LogLevel),\n/* harmony export */   logApiError: () => (/* binding */ logApiError),\n/* harmony export */   logApiRequest: () => (/* binding */ logApiRequest),\n/* harmony export */   logDatabaseConnection: () => (/* binding */ logDatabaseConnection),\n/* harmony export */   logDatabaseQuery: () => (/* binding */ logDatabaseQuery),\n/* harmony export */   logError: () => (/* binding */ logError),\n/* harmony export */   logHealthCheck: () => (/* binding */ logHealthCheck),\n/* harmony export */   logNetworkInfo: () => (/* binding */ logNetworkInfo),\n/* harmony export */   logStartup: () => (/* binding */ logStartup),\n/* harmony export */   logSystemEvent: () => (/* binding */ logSystemEvent),\n/* harmony export */   logUserAction: () => (/* binding */ logUserAction),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config */ \"(api)/./src/lib/config.ts\");\n\nvar LogLevel;\n(function(LogLevel) {\n    LogLevel[LogLevel[\"ERROR\"] = 0] = \"ERROR\";\n    LogLevel[LogLevel[\"WARN\"] = 1] = \"WARN\";\n    LogLevel[LogLevel[\"INFO\"] = 2] = \"INFO\";\n    LogLevel[LogLevel[\"DEBUG\"] = 3] = \"DEBUG\";\n})(LogLevel || (LogLevel = {}));\nclass ConsoleLogger {\n    constructor(level){\n        this.level = this.parseLogLevel(level);\n    }\n    parseLogLevel(level) {\n        switch(level.toLowerCase()){\n            case \"error\":\n                return 0;\n            case \"warn\":\n                return 1;\n            case \"info\":\n                return 2;\n            case \"debug\":\n                return 3;\n            default:\n                return 2;\n        }\n    }\n    shouldLog(level) {\n        return level <= this.level;\n    }\n    formatMessage(level, message, context) {\n        const timestamp = new Date().toISOString();\n        const baseMessage = `[${timestamp}] ${level.toUpperCase()}: ${message}`;\n        if (context && Object.keys(context).length > 0) {\n            if (_config__WEBPACK_IMPORTED_MODULE_0__.config.logging.pretty) {\n                return `${baseMessage}\\n${JSON.stringify(context, null, 2)}`;\n            } else {\n                return `${baseMessage} ${JSON.stringify(context)}`;\n            }\n        }\n        return baseMessage;\n    }\n    error(message, context) {\n        if (this.shouldLog(0)) {\n            console.error(this.formatMessage(\"error\", message, context));\n        }\n    }\n    warn(message, context) {\n        if (this.shouldLog(1)) {\n            console.warn(this.formatMessage(\"warn\", message, context));\n        }\n    }\n    info(message, context) {\n        if (this.shouldLog(2)) {\n            console.info(this.formatMessage(\"info\", message, context));\n        }\n    }\n    debug(message, context) {\n        if (this.shouldLog(3)) {\n            console.debug(this.formatMessage(\"debug\", message, context));\n        }\n    }\n}\n// Create singleton logger instance\nconst logger = new ConsoleLogger(_config__WEBPACK_IMPORTED_MODULE_0__.config.logging.level);\n// Utility functions for structured logging\nfunction logError(error, context) {\n    logger.error(error.message, {\n        ...context,\n        stack: error.stack,\n        name: error.name\n    });\n}\nfunction logApiRequest(method, url, userId, duration) {\n    logger.info(\"API Request\", {\n        method,\n        url,\n        userId,\n        duration: duration ? `${duration}ms` : undefined\n    });\n}\nfunction logApiError(method, url, error, userId) {\n    logger.error(\"API Error\", {\n        method,\n        url,\n        userId,\n        error: error.message,\n        stack: error.stack\n    });\n}\nfunction logDatabaseQuery(query, duration, error) {\n    if (error) {\n        logger.error(\"Database Query Error\", {\n            query,\n            duration: duration ? `${duration}ms` : undefined,\n            error: error.message\n        });\n    } else {\n        logger.debug(\"Database Query\", {\n            query,\n            duration: duration ? `${duration}ms` : undefined\n        });\n    }\n}\nfunction logUserAction(action, userId, context) {\n    logger.info(\"User Action\", {\n        action,\n        userId,\n        ...context\n    });\n}\nfunction logSystemEvent(event, context) {\n    logger.info(\"System Event\", {\n        event,\n        ...context\n    });\n}\nfunction logStartup(component, status, context) {\n    const level = status === \"failed\" ? \"error\" : \"info\";\n    logger[level](`🚀 ${component} ${status.toUpperCase()}`, {\n        component,\n        status,\n        timestamp: new Date().toISOString(),\n        ...context\n    });\n}\nfunction logHealthCheck(component, healthy, context) {\n    const status = healthy ? \"healthy\" : \"unhealthy\";\n    const level = healthy ? \"info\" : \"error\";\n    logger[level](`💚 Health Check: ${component} is ${status}`, {\n        component,\n        healthy,\n        ...context\n    });\n}\nfunction logNetworkInfo(port, host = \"localhost\", context) {\n    logger.info(\"\\uD83C\\uDF10 Server Network Configuration\", {\n        port,\n        host,\n        url: `http://${host}:${port}`,\n        ...context\n    });\n}\nfunction logDatabaseConnection(status, context) {\n    const level = status === \"failed\" ? \"error\" : \"info\";\n    const emoji = status === \"connected\" ? \"✅\" : status === \"connecting\" ? \"\\uD83D\\uDD04\" : \"❌\";\n    logger[level](`${emoji} Database ${status.toUpperCase()}`, {\n        status,\n        ...context\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL2xvZ2dlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQWlDOztVQUVyQkM7Ozs7O0dBQUFBLGFBQUFBO0FBa0JaLE1BQU1DO0lBR0pDLFlBQVlDLEtBQWEsQ0FBRTtRQUN6QixJQUFJLENBQUNBLEtBQUssR0FBRyxJQUFJLENBQUNDLGFBQWEsQ0FBQ0Q7SUFDbEM7SUFFUUMsY0FBY0QsS0FBYSxFQUFZO1FBQzdDLE9BQVFBLE1BQU1FLFdBQVc7WUFDdkIsS0FBSztnQkFBUztZQUNkLEtBQUs7Z0JBQVE7WUFDYixLQUFLO2dCQUFRO1lBQ2IsS0FBSztnQkFBUztZQUNkO2dCQUFTO1FBQ1g7SUFDRjtJQUVRQyxVQUFVSCxLQUFlLEVBQVc7UUFDMUMsT0FBT0EsU0FBUyxJQUFJLENBQUNBLEtBQUs7SUFDNUI7SUFFUUksY0FBY0osS0FBYSxFQUFFSyxPQUFlLEVBQUVDLE9BQW9CLEVBQVU7UUFDbEYsTUFBTUMsWUFBWSxJQUFJQyxPQUFPQyxXQUFXO1FBQ3hDLE1BQU1DLGNBQWMsQ0FBQyxDQUFDLEVBQUVILFVBQVUsRUFBRSxFQUFFUCxNQUFNVyxXQUFXLEdBQUcsRUFBRSxFQUFFTixRQUFRLENBQUM7UUFFdkUsSUFBSUMsV0FBV00sT0FBT0MsSUFBSSxDQUFDUCxTQUFTUSxNQUFNLEdBQUcsR0FBRztZQUM5QyxJQUFJbEIsMkNBQU1BLENBQUNtQixPQUFPLENBQUNDLE1BQU0sRUFBRTtnQkFDekIsT0FBTyxDQUFDLEVBQUVOLFlBQVksRUFBRSxFQUFFTyxLQUFLQyxTQUFTLENBQUNaLFNBQVMsTUFBTSxHQUFHLENBQUM7WUFDOUQsT0FBTztnQkFDTCxPQUFPLENBQUMsRUFBRUksWUFBWSxDQUFDLEVBQUVPLEtBQUtDLFNBQVMsQ0FBQ1osU0FBUyxDQUFDO1lBQ3BEO1FBQ0Y7UUFFQSxPQUFPSTtJQUNUO0lBRUFTLE1BQU1kLE9BQWUsRUFBRUMsT0FBb0IsRUFBUTtRQUNqRCxJQUFJLElBQUksQ0FBQ0gsU0FBUyxLQUFrQjtZQUNsQ2lCLFFBQVFELEtBQUssQ0FBQyxJQUFJLENBQUNmLGFBQWEsQ0FBQyxTQUFTQyxTQUFTQztRQUNyRDtJQUNGO0lBRUFlLEtBQUtoQixPQUFlLEVBQUVDLE9BQW9CLEVBQVE7UUFDaEQsSUFBSSxJQUFJLENBQUNILFNBQVMsS0FBaUI7WUFDakNpQixRQUFRQyxJQUFJLENBQUMsSUFBSSxDQUFDakIsYUFBYSxDQUFDLFFBQVFDLFNBQVNDO1FBQ25EO0lBQ0Y7SUFFQWdCLEtBQUtqQixPQUFlLEVBQUVDLE9BQW9CLEVBQVE7UUFDaEQsSUFBSSxJQUFJLENBQUNILFNBQVMsS0FBaUI7WUFDakNpQixRQUFRRSxJQUFJLENBQUMsSUFBSSxDQUFDbEIsYUFBYSxDQUFDLFFBQVFDLFNBQVNDO1FBQ25EO0lBQ0Y7SUFFQWlCLE1BQU1sQixPQUFlLEVBQUVDLE9BQW9CLEVBQVE7UUFDakQsSUFBSSxJQUFJLENBQUNILFNBQVMsS0FBa0I7WUFDbENpQixRQUFRRyxLQUFLLENBQUMsSUFBSSxDQUFDbkIsYUFBYSxDQUFDLFNBQVNDLFNBQVNDO1FBQ3JEO0lBQ0Y7QUFDRjtBQUVBLG1DQUFtQztBQUM1QixNQUFNa0IsU0FBaUIsSUFBSTFCLGNBQWNGLDJDQUFNQSxDQUFDbUIsT0FBTyxDQUFDZixLQUFLLEVBQUM7QUFFckUsMkNBQTJDO0FBQ3BDLFNBQVN5QixTQUFTTixLQUFZLEVBQUViLE9BQW9CO0lBQ3pEa0IsT0FBT0wsS0FBSyxDQUFDQSxNQUFNZCxPQUFPLEVBQUU7UUFDMUIsR0FBR0MsT0FBTztRQUNWb0IsT0FBT1AsTUFBTU8sS0FBSztRQUNsQkMsTUFBTVIsTUFBTVEsSUFBSTtJQUNsQjtBQUNGO0FBRU8sU0FBU0MsY0FBY0MsTUFBYyxFQUFFQyxHQUFXLEVBQUVDLE1BQWUsRUFBRUMsUUFBaUI7SUFDM0ZSLE9BQU9GLElBQUksQ0FBQyxlQUFlO1FBQ3pCTztRQUNBQztRQUNBQztRQUNBQyxVQUFVQSxXQUFXLENBQUMsRUFBRUEsU0FBUyxFQUFFLENBQUMsR0FBR0M7SUFDekM7QUFDRjtBQUVPLFNBQVNDLFlBQVlMLE1BQWMsRUFBRUMsR0FBVyxFQUFFWCxLQUFZLEVBQUVZLE1BQWU7SUFDcEZQLE9BQU9MLEtBQUssQ0FBQyxhQUFhO1FBQ3hCVTtRQUNBQztRQUNBQztRQUNBWixPQUFPQSxNQUFNZCxPQUFPO1FBQ3BCcUIsT0FBT1AsTUFBTU8sS0FBSztJQUNwQjtBQUNGO0FBRU8sU0FBU1MsaUJBQWlCQyxLQUFhLEVBQUVKLFFBQWlCLEVBQUViLEtBQWE7SUFDOUUsSUFBSUEsT0FBTztRQUNUSyxPQUFPTCxLQUFLLENBQUMsd0JBQXdCO1lBQ25DaUI7WUFDQUosVUFBVUEsV0FBVyxDQUFDLEVBQUVBLFNBQVMsRUFBRSxDQUFDLEdBQUdDO1lBQ3ZDZCxPQUFPQSxNQUFNZCxPQUFPO1FBQ3RCO0lBQ0YsT0FBTztRQUNMbUIsT0FBT0QsS0FBSyxDQUFDLGtCQUFrQjtZQUM3QmE7WUFDQUosVUFBVUEsV0FBVyxDQUFDLEVBQUVBLFNBQVMsRUFBRSxDQUFDLEdBQUdDO1FBQ3pDO0lBQ0Y7QUFDRjtBQUVPLFNBQVNJLGNBQWNDLE1BQWMsRUFBRVAsTUFBYyxFQUFFekIsT0FBb0I7SUFDaEZrQixPQUFPRixJQUFJLENBQUMsZUFBZTtRQUN6QmdCO1FBQ0FQO1FBQ0EsR0FBR3pCLE9BQU87SUFDWjtBQUNGO0FBRU8sU0FBU2lDLGVBQWVDLEtBQWEsRUFBRWxDLE9BQW9CO0lBQ2hFa0IsT0FBT0YsSUFBSSxDQUFDLGdCQUFnQjtRQUMxQmtCO1FBQ0EsR0FBR2xDLE9BQU87SUFDWjtBQUNGO0FBRU8sU0FBU21DLFdBQVdDLFNBQWlCLEVBQUVDLE1BQXVDLEVBQUVyQyxPQUFvQjtJQUN6RyxNQUFNTixRQUFRMkMsV0FBVyxXQUFXLFVBQVU7SUFDOUNuQixNQUFNLENBQUN4QixNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUwQyxVQUFVLENBQUMsRUFBRUMsT0FBT2hDLFdBQVcsR0FBRyxDQUFDLEVBQUU7UUFDdkQrQjtRQUNBQztRQUNBcEMsV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1FBQ2pDLEdBQUdILE9BQU87SUFDWjtBQUNGO0FBRU8sU0FBU3NDLGVBQWVGLFNBQWlCLEVBQUVHLE9BQWdCLEVBQUV2QyxPQUFvQjtJQUN0RixNQUFNcUMsU0FBU0UsVUFBVSxZQUFZO0lBQ3JDLE1BQU03QyxRQUFRNkMsVUFBVSxTQUFTO0lBQ2pDckIsTUFBTSxDQUFDeEIsTUFBTSxDQUFDLENBQUMsaUJBQWlCLEVBQUUwQyxVQUFVLElBQUksRUFBRUMsT0FBTyxDQUFDLEVBQUU7UUFDMUREO1FBQ0FHO1FBQ0EsR0FBR3ZDLE9BQU87SUFDWjtBQUNGO0FBRU8sU0FBU3dDLGVBQWVDLElBQVksRUFBRUMsT0FBTyxXQUFXLEVBQUUxQyxPQUFvQjtJQUNuRmtCLE9BQU9GLElBQUksQ0FBQyw2Q0FBbUM7UUFDN0N5QjtRQUNBQztRQUNBbEIsS0FBSyxDQUFDLE9BQU8sRUFBRWtCLEtBQUssQ0FBQyxFQUFFRCxLQUFLLENBQUM7UUFDN0IsR0FBR3pDLE9BQU87SUFDWjtBQUNGO0FBRU8sU0FBUzJDLHNCQUFzQk4sTUFBNkMsRUFBRXJDLE9BQW9CO0lBQ3ZHLE1BQU1OLFFBQVEyQyxXQUFXLFdBQVcsVUFBVTtJQUM5QyxNQUFNTyxRQUFRUCxXQUFXLGNBQWMsTUFBTUEsV0FBVyxlQUFlLGlCQUFPO0lBQzlFbkIsTUFBTSxDQUFDeEIsTUFBTSxDQUFDLENBQUMsRUFBRWtELE1BQU0sVUFBVSxFQUFFUCxPQUFPaEMsV0FBVyxHQUFHLENBQUMsRUFBRTtRQUN6RGdDO1FBQ0EsR0FBR3JDLE9BQU87SUFDWjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9saWIvbG9nZ2VyLnRzP2I0OWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi9jb25maWcnXG5cbmV4cG9ydCBlbnVtIExvZ0xldmVsIHtcbiAgRVJST1IgPSAwLFxuICBXQVJOID0gMSxcbiAgSU5GTyA9IDIsXG4gIERFQlVHID0gMyxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2dDb250ZXh0IHtcbiAgW2tleTogc3RyaW5nXTogYW55XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyIHtcbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCk6IHZvaWRcbiAgd2FybihtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBMb2dDb250ZXh0KTogdm9pZFxuICBpbmZvKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IExvZ0NvbnRleHQpOiB2b2lkXG4gIGRlYnVnKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IExvZ0NvbnRleHQpOiB2b2lkXG59XG5cbmNsYXNzIENvbnNvbGVMb2dnZXIgaW1wbGVtZW50cyBMb2dnZXIge1xuICBwcml2YXRlIGxldmVsOiBMb2dMZXZlbFxuXG4gIGNvbnN0cnVjdG9yKGxldmVsOiBzdHJpbmcpIHtcbiAgICB0aGlzLmxldmVsID0gdGhpcy5wYXJzZUxvZ0xldmVsKGxldmVsKVxuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZUxvZ0xldmVsKGxldmVsOiBzdHJpbmcpOiBMb2dMZXZlbCB7XG4gICAgc3dpdGNoIChsZXZlbC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICBjYXNlICdlcnJvcic6IHJldHVybiBMb2dMZXZlbC5FUlJPUlxuICAgICAgY2FzZSAnd2Fybic6IHJldHVybiBMb2dMZXZlbC5XQVJOXG4gICAgICBjYXNlICdpbmZvJzogcmV0dXJuIExvZ0xldmVsLklORk9cbiAgICAgIGNhc2UgJ2RlYnVnJzogcmV0dXJuIExvZ0xldmVsLkRFQlVHXG4gICAgICBkZWZhdWx0OiByZXR1cm4gTG9nTGV2ZWwuSU5GT1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2hvdWxkTG9nKGxldmVsOiBMb2dMZXZlbCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBsZXZlbCA8PSB0aGlzLmxldmVsXG4gIH1cblxuICBwcml2YXRlIGZvcm1hdE1lc3NhZ2UobGV2ZWw6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCk6IHN0cmluZyB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgY29uc3QgYmFzZU1lc3NhZ2UgPSBgWyR7dGltZXN0YW1wfV0gJHtsZXZlbC50b1VwcGVyQ2FzZSgpfTogJHttZXNzYWdlfWBcbiAgICBcbiAgICBpZiAoY29udGV4dCAmJiBPYmplY3Qua2V5cyhjb250ZXh0KS5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoY29uZmlnLmxvZ2dpbmcucHJldHR5KSB7XG4gICAgICAgIHJldHVybiBgJHtiYXNlTWVzc2FnZX1cXG4ke0pTT04uc3RyaW5naWZ5KGNvbnRleHQsIG51bGwsIDIpfWBcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgJHtiYXNlTWVzc2FnZX0gJHtKU09OLnN0cmluZ2lmeShjb250ZXh0KX1gXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBiYXNlTWVzc2FnZVxuICB9XG5cbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNob3VsZExvZyhMb2dMZXZlbC5FUlJPUikpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5mb3JtYXRNZXNzYWdlKCdlcnJvcicsIG1lc3NhZ2UsIGNvbnRleHQpKVxuICAgIH1cbiAgfVxuXG4gIHdhcm4obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNob3VsZExvZyhMb2dMZXZlbC5XQVJOKSkge1xuICAgICAgY29uc29sZS53YXJuKHRoaXMuZm9ybWF0TWVzc2FnZSgnd2FybicsIG1lc3NhZ2UsIGNvbnRleHQpKVxuICAgIH1cbiAgfVxuXG4gIGluZm8obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNob3VsZExvZyhMb2dMZXZlbC5JTkZPKSkge1xuICAgICAgY29uc29sZS5pbmZvKHRoaXMuZm9ybWF0TWVzc2FnZSgnaW5mbycsIG1lc3NhZ2UsIGNvbnRleHQpKVxuICAgIH1cbiAgfVxuXG4gIGRlYnVnKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IExvZ0NvbnRleHQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zaG91bGRMb2coTG9nTGV2ZWwuREVCVUcpKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKHRoaXMuZm9ybWF0TWVzc2FnZSgnZGVidWcnLCBtZXNzYWdlLCBjb250ZXh0KSlcbiAgICB9XG4gIH1cbn1cblxuLy8gQ3JlYXRlIHNpbmdsZXRvbiBsb2dnZXIgaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBsb2dnZXI6IExvZ2dlciA9IG5ldyBDb25zb2xlTG9nZ2VyKGNvbmZpZy5sb2dnaW5nLmxldmVsKVxuXG4vLyBVdGlsaXR5IGZ1bmN0aW9ucyBmb3Igc3RydWN0dXJlZCBsb2dnaW5nXG5leHBvcnQgZnVuY3Rpb24gbG9nRXJyb3IoZXJyb3I6IEVycm9yLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xuICBsb2dnZXIuZXJyb3IoZXJyb3IubWVzc2FnZSwge1xuICAgIC4uLmNvbnRleHQsXG4gICAgc3RhY2s6IGVycm9yLnN0YWNrLFxuICAgIG5hbWU6IGVycm9yLm5hbWUsXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dBcGlSZXF1ZXN0KG1ldGhvZDogc3RyaW5nLCB1cmw6IHN0cmluZywgdXNlcklkPzogc3RyaW5nLCBkdXJhdGlvbj86IG51bWJlcikge1xuICBsb2dnZXIuaW5mbygnQVBJIFJlcXVlc3QnLCB7XG4gICAgbWV0aG9kLFxuICAgIHVybCxcbiAgICB1c2VySWQsXG4gICAgZHVyYXRpb246IGR1cmF0aW9uID8gYCR7ZHVyYXRpb259bXNgIDogdW5kZWZpbmVkLFxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nQXBpRXJyb3IobWV0aG9kOiBzdHJpbmcsIHVybDogc3RyaW5nLCBlcnJvcjogRXJyb3IsIHVzZXJJZD86IHN0cmluZykge1xuICBsb2dnZXIuZXJyb3IoJ0FQSSBFcnJvcicsIHtcbiAgICBtZXRob2QsXG4gICAgdXJsLFxuICAgIHVzZXJJZCxcbiAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICBzdGFjazogZXJyb3Iuc3RhY2ssXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dEYXRhYmFzZVF1ZXJ5KHF1ZXJ5OiBzdHJpbmcsIGR1cmF0aW9uPzogbnVtYmVyLCBlcnJvcj86IEVycm9yKSB7XG4gIGlmIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRGF0YWJhc2UgUXVlcnkgRXJyb3InLCB7XG4gICAgICBxdWVyeSxcbiAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiA/IGAke2R1cmF0aW9ufW1zYCA6IHVuZGVmaW5lZCxcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgIH0pXG4gIH0gZWxzZSB7XG4gICAgbG9nZ2VyLmRlYnVnKCdEYXRhYmFzZSBRdWVyeScsIHtcbiAgICAgIHF1ZXJ5LFxuICAgICAgZHVyYXRpb246IGR1cmF0aW9uID8gYCR7ZHVyYXRpb259bXNgIDogdW5kZWZpbmVkLFxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1VzZXJBY3Rpb24oYWN0aW9uOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xuICBsb2dnZXIuaW5mbygnVXNlciBBY3Rpb24nLCB7XG4gICAgYWN0aW9uLFxuICAgIHVzZXJJZCxcbiAgICAuLi5jb250ZXh0LFxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nU3lzdGVtRXZlbnQoZXZlbnQ6IHN0cmluZywgY29udGV4dD86IExvZ0NvbnRleHQpIHtcbiAgbG9nZ2VyLmluZm8oJ1N5c3RlbSBFdmVudCcsIHtcbiAgICBldmVudCxcbiAgICAuLi5jb250ZXh0LFxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nU3RhcnR1cChjb21wb25lbnQ6IHN0cmluZywgc3RhdHVzOiAnc3RhcnRpbmcnIHwgJ3JlYWR5JyB8ICdmYWlsZWQnLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xuICBjb25zdCBsZXZlbCA9IHN0YXR1cyA9PT0gJ2ZhaWxlZCcgPyAnZXJyb3InIDogJ2luZm8nXG4gIGxvZ2dlcltsZXZlbF0oYPCfmoAgJHtjb21wb25lbnR9ICR7c3RhdHVzLnRvVXBwZXJDYXNlKCl9YCwge1xuICAgIGNvbXBvbmVudCxcbiAgICBzdGF0dXMsXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgLi4uY29udGV4dCxcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ0hlYWx0aENoZWNrKGNvbXBvbmVudDogc3RyaW5nLCBoZWFsdGh5OiBib29sZWFuLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xuICBjb25zdCBzdGF0dXMgPSBoZWFsdGh5ID8gJ2hlYWx0aHknIDogJ3VuaGVhbHRoeSdcbiAgY29uc3QgbGV2ZWwgPSBoZWFsdGh5ID8gJ2luZm8nIDogJ2Vycm9yJ1xuICBsb2dnZXJbbGV2ZWxdKGDwn5KaIEhlYWx0aCBDaGVjazogJHtjb21wb25lbnR9IGlzICR7c3RhdHVzfWAsIHtcbiAgICBjb21wb25lbnQsXG4gICAgaGVhbHRoeSxcbiAgICAuLi5jb250ZXh0LFxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nTmV0d29ya0luZm8ocG9ydDogbnVtYmVyLCBob3N0ID0gJ2xvY2FsaG9zdCcsIGNvbnRleHQ/OiBMb2dDb250ZXh0KSB7XG4gIGxvZ2dlci5pbmZvKCfwn4yQIFNlcnZlciBOZXR3b3JrIENvbmZpZ3VyYXRpb24nLCB7XG4gICAgcG9ydCxcbiAgICBob3N0LFxuICAgIHVybDogYGh0dHA6Ly8ke2hvc3R9OiR7cG9ydH1gLFxuICAgIC4uLmNvbnRleHQsXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dEYXRhYmFzZUNvbm5lY3Rpb24oc3RhdHVzOiAnY29ubmVjdGluZycgfCAnY29ubmVjdGVkJyB8ICdmYWlsZWQnLCBjb250ZXh0PzogTG9nQ29udGV4dCkge1xuICBjb25zdCBsZXZlbCA9IHN0YXR1cyA9PT0gJ2ZhaWxlZCcgPyAnZXJyb3InIDogJ2luZm8nXG4gIGNvbnN0IGVtb2ppID0gc3RhdHVzID09PSAnY29ubmVjdGVkJyA/ICfinIUnIDogc3RhdHVzID09PSAnY29ubmVjdGluZycgPyAn8J+UhCcgOiAn4p2MJ1xuICBsb2dnZXJbbGV2ZWxdKGAke2Vtb2ppfSBEYXRhYmFzZSAke3N0YXR1cy50b1VwcGVyQ2FzZSgpfWAsIHtcbiAgICBzdGF0dXMsXG4gICAgLi4uY29udGV4dCxcbiAgfSlcbn0iXSwibmFtZXMiOlsiY29uZmlnIiwiTG9nTGV2ZWwiLCJDb25zb2xlTG9nZ2VyIiwiY29uc3RydWN0b3IiLCJsZXZlbCIsInBhcnNlTG9nTGV2ZWwiLCJ0b0xvd2VyQ2FzZSIsInNob3VsZExvZyIsImZvcm1hdE1lc3NhZ2UiLCJtZXNzYWdlIiwiY29udGV4dCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImJhc2VNZXNzYWdlIiwidG9VcHBlckNhc2UiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwibG9nZ2luZyIsInByZXR0eSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiaW5mbyIsImRlYnVnIiwibG9nZ2VyIiwibG9nRXJyb3IiLCJzdGFjayIsIm5hbWUiLCJsb2dBcGlSZXF1ZXN0IiwibWV0aG9kIiwidXJsIiwidXNlcklkIiwiZHVyYXRpb24iLCJ1bmRlZmluZWQiLCJsb2dBcGlFcnJvciIsImxvZ0RhdGFiYXNlUXVlcnkiLCJxdWVyeSIsImxvZ1VzZXJBY3Rpb24iLCJhY3Rpb24iLCJsb2dTeXN0ZW1FdmVudCIsImV2ZW50IiwibG9nU3RhcnR1cCIsImNvbXBvbmVudCIsInN0YXR1cyIsImxvZ0hlYWx0aENoZWNrIiwiaGVhbHRoeSIsImxvZ05ldHdvcmtJbmZvIiwicG9ydCIsImhvc3QiLCJsb2dEYXRhYmFzZUNvbm5lY3Rpb24iLCJlbW9qaSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/logger.ts\n");

/***/ }),

/***/ "(api)/./src/lib/performance-monitor.ts":
/*!****************************************!*\
  !*** ./src/lib/performance-monitor.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PerformanceMonitor: () => (/* binding */ PerformanceMonitor),\n/* harmony export */   performanceMonitor: () => (/* binding */ performanceMonitor),\n/* harmony export */   timeRatingOperation: () => (/* binding */ timeRatingOperation)\n/* harmony export */ });\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logger */ \"(api)/./src/lib/logger.ts\");\n\nclass PerformanceMonitor {\n    // Start timing an operation\n    start(operationId, operation, metadata) {\n        this.timers.set(operationId, performance.now());\n        if (metadata) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__.logger.debug(`Performance monitor: Starting ${operation}`, metadata);\n        }\n    }\n    // End timing an operation and record the metric\n    end(operationId, operation, metadata) {\n        const startTime = this.timers.get(operationId);\n        if (!startTime) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn(`Performance monitor: No start time found for operation ${operationId}`);\n            return 0;\n        }\n        const duration = performance.now() - startTime;\n        this.timers.delete(operationId);\n        const metric = {\n            operation,\n            duration,\n            timestamp: Date.now(),\n            metadata\n        };\n        this.metrics.push(metric);\n        // Keep only the most recent metrics\n        if (this.metrics.length > this.maxMetrics) {\n            this.metrics = this.metrics.slice(-this.maxMetrics);\n        }\n        // Log slow operations (> 1000ms)\n        if (duration > 1000) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn(`Slow operation detected: ${operation}`, {\n                duration,\n                operationId,\n                ...metadata\n            });\n        } else if (duration > 100) {\n            // Log medium operations for debugging\n            _logger__WEBPACK_IMPORTED_MODULE_0__.logger.debug(`Performance: ${operation} took ${duration.toFixed(2)}ms`, {\n                operationId,\n                ...metadata\n            });\n        }\n        return duration;\n    }\n    // Time a function execution\n    async timeFunction(operation, fn, metadata) {\n        const operationId = `${operation}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        this.start(operationId, operation, metadata);\n        try {\n            const result = await fn();\n            const duration = this.end(operationId, operation, metadata);\n            return {\n                result,\n                duration\n            };\n        } catch (error) {\n            const duration = this.end(operationId, operation, {\n                ...metadata,\n                error: true\n            });\n            throw error;\n        }\n    }\n    // Get performance statistics\n    getStats(operation) {\n        const filteredMetrics = operation ? this.metrics.filter((m)=>m.operation === operation) : this.metrics;\n        if (filteredMetrics.length === 0) {\n            return {\n                totalOperations: 0,\n                averageDuration: 0,\n                minDuration: 0,\n                maxDuration: 0,\n                recentOperations: 0,\n                slowOperations: 0\n            };\n        }\n        const durations = filteredMetrics.map((m)=>m.duration);\n        const recentCutoff = Date.now() - 5 * 60 * 1000 // Last 5 minutes\n        ;\n        return {\n            totalOperations: filteredMetrics.length,\n            averageDuration: durations.reduce((a, b)=>a + b, 0) / durations.length,\n            minDuration: Math.min(...durations),\n            maxDuration: Math.max(...durations),\n            recentOperations: filteredMetrics.filter((m)=>m.timestamp > recentCutoff).length,\n            slowOperations: filteredMetrics.filter((m)=>m.duration > 1000).length\n        };\n    }\n    // Get recent slow operations\n    getSlowOperations(limit = 10) {\n        return this.metrics.filter((m)=>m.duration > 1000).sort((a, b)=>b.timestamp - a.timestamp).slice(0, limit).map((m)=>({\n                operation: m.operation,\n                duration: m.duration,\n                timestamp: m.timestamp,\n                metadata: m.metadata\n            }));\n    }\n    // Get operation breakdown\n    getOperationBreakdown() {\n        const breakdown = {};\n        this.metrics.forEach((metric)=>{\n            if (!breakdown[metric.operation]) {\n                breakdown[metric.operation] = {\n                    count: 0,\n                    totalDuration: 0,\n                    averageDuration: 0,\n                    maxDuration: 0\n                };\n            }\n            const op = breakdown[metric.operation];\n            op.count += 1;\n            op.totalDuration += metric.duration;\n            op.maxDuration = Math.max(op.maxDuration, metric.duration);\n        });\n        // Calculate averages\n        Object.values(breakdown).forEach((op)=>{\n            op.averageDuration = op.totalDuration / op.count;\n        });\n        return breakdown;\n    }\n    // Clear all metrics\n    clear() {\n        this.metrics = [];\n        this.timers.clear();\n        _logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Performance monitor cleared\");\n    }\n    // Export metrics for analysis\n    exportMetrics() {\n        return [\n            ...this.metrics\n        ];\n    }\n    constructor(){\n        this.metrics = [];\n        this.maxMetrics = 1000 // Keep last 1000 operations\n        ;\n        this.timers = new Map();\n    }\n}\n// Export singleton instance\nconst performanceMonitor = new PerformanceMonitor();\n// Helper function for timing rating operations specifically\nconst timeRatingOperation = async (operation, fn, metadata)=>{\n    const { result } = await performanceMonitor.timeFunction(`rating_${operation}`, fn, metadata);\n    return result;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxJQUFJNEQ7O0FBaUx2QjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNQyxxQkFBcUIsSUFBSWxFLHFCQUFvQjtBQUUxRCw0REFBNEQ7QUFDckQsTUFBTW1FLHNCQUFzQixPQUNqQ2hFLFdBQ0F1QixJQUNBdEI7SUFFQSxNQUFNLEVBQUUyQixNQUFNLEVBQUUsR0FBRyxNQUFNbUMsbUJBQW1CekMsWUFBWSxDQUN0RCxDQUFDLE9BQU8sRUFBRXRCLFVBQVUsQ0FBQyxFQUNyQnVCLElBQ0F0QjtJQUVGLE9BQU8yQjtBQUNULEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yYXRlbXktbmV4dGpzLy4vc3JjL2xpYi9wZXJmb3JtYW5jZS1tb25pdG9yLnRzPzNjNTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInXG5cbmludGVyZmFjZSBQZXJmb3JtYW5jZU1ldHJpYyB7XG4gIG9wZXJhdGlvbjogc3RyaW5nXG4gIGR1cmF0aW9uOiBudW1iZXJcbiAgdGltZXN0YW1wOiBudW1iZXJcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG59XG5cbmV4cG9ydCBjbGFzcyBQZXJmb3JtYW5jZU1vbml0b3Ige1xuICBwcml2YXRlIG1ldHJpY3M6IFBlcmZvcm1hbmNlTWV0cmljW10gPSBbXVxuICBwcml2YXRlIG1heE1ldHJpY3MgPSAxMDAwIC8vIEtlZXAgbGFzdCAxMDAwIG9wZXJhdGlvbnNcbiAgcHJpdmF0ZSB0aW1lcnMgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpXG5cbiAgLy8gU3RhcnQgdGltaW5nIGFuIG9wZXJhdGlvblxuICBzdGFydChvcGVyYXRpb25JZDogc3RyaW5nLCBvcGVyYXRpb246IHN0cmluZywgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogdm9pZCB7XG4gICAgdGhpcy50aW1lcnMuc2V0KG9wZXJhdGlvbklkLCBwZXJmb3JtYW5jZS5ub3coKSlcbiAgICBpZiAobWV0YWRhdGEpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgUGVyZm9ybWFuY2UgbW9uaXRvcjogU3RhcnRpbmcgJHtvcGVyYXRpb259YCwgbWV0YWRhdGEpXG4gICAgfVxuICB9XG5cbiAgLy8gRW5kIHRpbWluZyBhbiBvcGVyYXRpb24gYW5kIHJlY29yZCB0aGUgbWV0cmljXG4gIGVuZChvcGVyYXRpb25JZDogc3RyaW5nLCBvcGVyYXRpb246IHN0cmluZywgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogbnVtYmVyIHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSB0aGlzLnRpbWVycy5nZXQob3BlcmF0aW9uSWQpXG4gICAgaWYgKCFzdGFydFRpbWUpIHtcbiAgICAgIGxvZ2dlci53YXJuKGBQZXJmb3JtYW5jZSBtb25pdG9yOiBObyBzdGFydCB0aW1lIGZvdW5kIGZvciBvcGVyYXRpb24gJHtvcGVyYXRpb25JZH1gKVxuICAgICAgcmV0dXJuIDBcbiAgICB9XG5cbiAgICBjb25zdCBkdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgdGhpcy50aW1lcnMuZGVsZXRlKG9wZXJhdGlvbklkKVxuXG4gICAgY29uc3QgbWV0cmljOiBQZXJmb3JtYW5jZU1ldHJpYyA9IHtcbiAgICAgIG9wZXJhdGlvbixcbiAgICAgIGR1cmF0aW9uLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgbWV0YWRhdGFcbiAgICB9XG5cbiAgICB0aGlzLm1ldHJpY3MucHVzaChtZXRyaWMpXG5cbiAgICAvLyBLZWVwIG9ubHkgdGhlIG1vc3QgcmVjZW50IG1ldHJpY3NcbiAgICBpZiAodGhpcy5tZXRyaWNzLmxlbmd0aCA+IHRoaXMubWF4TWV0cmljcykge1xuICAgICAgdGhpcy5tZXRyaWNzID0gdGhpcy5tZXRyaWNzLnNsaWNlKC10aGlzLm1heE1ldHJpY3MpXG4gICAgfVxuXG4gICAgLy8gTG9nIHNsb3cgb3BlcmF0aW9ucyAoPiAxMDAwbXMpXG4gICAgaWYgKGR1cmF0aW9uID4gMTAwMCkge1xuICAgICAgbG9nZ2VyLndhcm4oYFNsb3cgb3BlcmF0aW9uIGRldGVjdGVkOiAke29wZXJhdGlvbn1gLCB7XG4gICAgICAgIGR1cmF0aW9uLFxuICAgICAgICBvcGVyYXRpb25JZCxcbiAgICAgICAgLi4ubWV0YWRhdGFcbiAgICAgIH0pXG4gICAgfSBlbHNlIGlmIChkdXJhdGlvbiA+IDEwMCkge1xuICAgICAgLy8gTG9nIG1lZGl1bSBvcGVyYXRpb25zIGZvciBkZWJ1Z2dpbmdcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgUGVyZm9ybWFuY2U6ICR7b3BlcmF0aW9ufSB0b29rICR7ZHVyYXRpb24udG9GaXhlZCgyKX1tc2AsIHtcbiAgICAgICAgb3BlcmF0aW9uSWQsXG4gICAgICAgIC4uLm1ldGFkYXRhXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiBkdXJhdGlvblxuICB9XG5cbiAgLy8gVGltZSBhIGZ1bmN0aW9uIGV4ZWN1dGlvblxuICBhc3luYyB0aW1lRnVuY3Rpb248VD4oXG4gICAgb3BlcmF0aW9uOiBzdHJpbmcsXG4gICAgZm46ICgpID0+IFByb21pc2U8VD4gfCBULFxuICAgIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxuICApOiBQcm9taXNlPHsgcmVzdWx0OiBUOyBkdXJhdGlvbjogbnVtYmVyIH0+IHtcbiAgICBjb25zdCBvcGVyYXRpb25JZCA9IGAke29wZXJhdGlvbn0tJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gXG4gICAgXG4gICAgdGhpcy5zdGFydChvcGVyYXRpb25JZCwgb3BlcmF0aW9uLCBtZXRhZGF0YSlcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKVxuICAgICAgY29uc3QgZHVyYXRpb24gPSB0aGlzLmVuZChvcGVyYXRpb25JZCwgb3BlcmF0aW9uLCBtZXRhZGF0YSlcbiAgICAgIHJldHVybiB7IHJlc3VsdCwgZHVyYXRpb24gfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHRoaXMuZW5kKG9wZXJhdGlvbklkLCBvcGVyYXRpb24sIHsgLi4ubWV0YWRhdGEsIGVycm9yOiB0cnVlIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8vIEdldCBwZXJmb3JtYW5jZSBzdGF0aXN0aWNzXG4gIGdldFN0YXRzKG9wZXJhdGlvbj86IHN0cmluZyk6IHtcbiAgICB0b3RhbE9wZXJhdGlvbnM6IG51bWJlclxuICAgIGF2ZXJhZ2VEdXJhdGlvbjogbnVtYmVyXG4gICAgbWluRHVyYXRpb246IG51bWJlclxuICAgIG1heER1cmF0aW9uOiBudW1iZXJcbiAgICByZWNlbnRPcGVyYXRpb25zOiBudW1iZXJcbiAgICBzbG93T3BlcmF0aW9uczogbnVtYmVyXG4gIH0ge1xuICAgIGNvbnN0IGZpbHRlcmVkTWV0cmljcyA9IG9wZXJhdGlvbiBcbiAgICAgID8gdGhpcy5tZXRyaWNzLmZpbHRlcihtID0+IG0ub3BlcmF0aW9uID09PSBvcGVyYXRpb24pXG4gICAgICA6IHRoaXMubWV0cmljc1xuXG4gICAgaWYgKGZpbHRlcmVkTWV0cmljcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsT3BlcmF0aW9uczogMCxcbiAgICAgICAgYXZlcmFnZUR1cmF0aW9uOiAwLFxuICAgICAgICBtaW5EdXJhdGlvbjogMCxcbiAgICAgICAgbWF4RHVyYXRpb246IDAsXG4gICAgICAgIHJlY2VudE9wZXJhdGlvbnM6IDAsXG4gICAgICAgIHNsb3dPcGVyYXRpb25zOiAwXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZHVyYXRpb25zID0gZmlsdGVyZWRNZXRyaWNzLm1hcChtID0+IG0uZHVyYXRpb24pXG4gICAgY29uc3QgcmVjZW50Q3V0b2ZmID0gRGF0ZS5ub3coKSAtIDUgKiA2MCAqIDEwMDAgLy8gTGFzdCA1IG1pbnV0ZXNcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxPcGVyYXRpb25zOiBmaWx0ZXJlZE1ldHJpY3MubGVuZ3RoLFxuICAgICAgYXZlcmFnZUR1cmF0aW9uOiBkdXJhdGlvbnMucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyBkdXJhdGlvbnMubGVuZ3RoLFxuICAgICAgbWluRHVyYXRpb246IE1hdGgubWluKC4uLmR1cmF0aW9ucyksXG4gICAgICBtYXhEdXJhdGlvbjogTWF0aC5tYXgoLi4uZHVyYXRpb25zKSxcbiAgICAgIHJlY2VudE9wZXJhdGlvbnM6IGZpbHRlcmVkTWV0cmljcy5maWx0ZXIobSA9PiBtLnRpbWVzdGFtcCA+IHJlY2VudEN1dG9mZikubGVuZ3RoLFxuICAgICAgc2xvd09wZXJhdGlvbnM6IGZpbHRlcmVkTWV0cmljcy5maWx0ZXIobSA9PiBtLmR1cmF0aW9uID4gMTAwMCkubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHJlY2VudCBzbG93IG9wZXJhdGlvbnNcbiAgZ2V0U2xvd09wZXJhdGlvbnMobGltaXQgPSAxMCk6IEFycmF5PHtcbiAgICBvcGVyYXRpb246IHN0cmluZ1xuICAgIGR1cmF0aW9uOiBudW1iZXJcbiAgICB0aW1lc3RhbXA6IG51bWJlclxuICAgIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljc1xuICAgICAgLmZpbHRlcihtID0+IG0uZHVyYXRpb24gPiAxMDAwKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIudGltZXN0YW1wIC0gYS50aW1lc3RhbXApXG4gICAgICAuc2xpY2UoMCwgbGltaXQpXG4gICAgICAubWFwKG0gPT4gKHtcbiAgICAgICAgb3BlcmF0aW9uOiBtLm9wZXJhdGlvbixcbiAgICAgICAgZHVyYXRpb246IG0uZHVyYXRpb24sXG4gICAgICAgIHRpbWVzdGFtcDogbS50aW1lc3RhbXAsXG4gICAgICAgIG1ldGFkYXRhOiBtLm1ldGFkYXRhXG4gICAgICB9KSlcbiAgfVxuXG4gIC8vIEdldCBvcGVyYXRpb24gYnJlYWtkb3duXG4gIGdldE9wZXJhdGlvbkJyZWFrZG93bigpOiBSZWNvcmQ8c3RyaW5nLCB7XG4gICAgY291bnQ6IG51bWJlclxuICAgIHRvdGFsRHVyYXRpb246IG51bWJlclxuICAgIGF2ZXJhZ2VEdXJhdGlvbjogbnVtYmVyXG4gICAgbWF4RHVyYXRpb246IG51bWJlclxuICB9PiB7XG4gICAgY29uc3QgYnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCB7XG4gICAgICBjb3VudDogbnVtYmVyXG4gICAgICB0b3RhbER1cmF0aW9uOiBudW1iZXJcbiAgICAgIGF2ZXJhZ2VEdXJhdGlvbjogbnVtYmVyXG4gICAgICBtYXhEdXJhdGlvbjogbnVtYmVyXG4gICAgfT4gPSB7fVxuXG4gICAgdGhpcy5tZXRyaWNzLmZvckVhY2gobWV0cmljID0+IHtcbiAgICAgIGlmICghYnJlYWtkb3duW21ldHJpYy5vcGVyYXRpb25dKSB7XG4gICAgICAgIGJyZWFrZG93blttZXRyaWMub3BlcmF0aW9uXSA9IHtcbiAgICAgICAgICBjb3VudDogMCxcbiAgICAgICAgICB0b3RhbER1cmF0aW9uOiAwLFxuICAgICAgICAgIGF2ZXJhZ2VEdXJhdGlvbjogMCxcbiAgICAgICAgICBtYXhEdXJhdGlvbjogMFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG9wID0gYnJlYWtkb3duW21ldHJpYy5vcGVyYXRpb25dXG4gICAgICBvcC5jb3VudCArPSAxXG4gICAgICBvcC50b3RhbER1cmF0aW9uICs9IG1ldHJpYy5kdXJhdGlvblxuICAgICAgb3AubWF4RHVyYXRpb24gPSBNYXRoLm1heChvcC5tYXhEdXJhdGlvbiwgbWV0cmljLmR1cmF0aW9uKVxuICAgIH0pXG5cbiAgICAvLyBDYWxjdWxhdGUgYXZlcmFnZXNcbiAgICBPYmplY3QudmFsdWVzKGJyZWFrZG93bikuZm9yRWFjaChvcCA9PiB7XG4gICAgICBvcC5hdmVyYWdlRHVyYXRpb24gPSBvcC50b3RhbER1cmF0aW9uIC8gb3AuY291bnRcbiAgICB9KVxuXG4gICAgcmV0dXJuIGJyZWFrZG93blxuICB9XG5cbiAgLy8gQ2xlYXIgYWxsIG1ldHJpY3NcbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5tZXRyaWNzID0gW11cbiAgICB0aGlzLnRpbWVycy5jbGVhcigpXG4gICAgbG9nZ2VyLmluZm8oJ1BlcmZvcm1hbmNlIG1vbml0b3IgY2xlYXJlZCcpXG4gIH1cblxuICAvLyBFeHBvcnQgbWV0cmljcyBmb3IgYW5hbHlzaXNcbiAgZXhwb3J0TWV0cmljcygpOiBQZXJmb3JtYW5jZU1ldHJpY1tdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMubWV0cmljc11cbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgcGVyZm9ybWFuY2VNb25pdG9yID0gbmV3IFBlcmZvcm1hbmNlTW9uaXRvcigpXG5cbi8vIEhlbHBlciBmdW5jdGlvbiBmb3IgdGltaW5nIHJhdGluZyBvcGVyYXRpb25zIHNwZWNpZmljYWxseVxuZXhwb3J0IGNvbnN0IHRpbWVSYXRpbmdPcGVyYXRpb24gPSBhc3luYyA8VD4oXG4gIG9wZXJhdGlvbjogc3RyaW5nLFxuICBmbjogKCkgPT4gUHJvbWlzZTxUPiB8IFQsXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxuKTogUHJvbWlzZTxUPiA9PiB7XG4gIGNvbnN0IHsgcmVzdWx0IH0gPSBhd2FpdCBwZXJmb3JtYW5jZU1vbml0b3IudGltZUZ1bmN0aW9uKFxuICAgIGByYXRpbmdfJHtvcGVyYXRpb259YCxcbiAgICBmbixcbiAgICBtZXRhZGF0YVxuICApXG4gIHJldHVybiByZXN1bHRcbn0iXSwibmFtZXMiOlsibG9nZ2VyIiwiUGVyZm9ybWFuY2VNb25pdG9yIiwic3RhcnQiLCJvcGVyYXRpb25JZCIsIm9wZXJhdGlvbiIsIm1ldGFkYXRhIiwidGltZXJzIiwic2V0IiwicGVyZm9ybWFuY2UiLCJub3ciLCJkZWJ1ZyIsImVuZCIsInN0YXJ0VGltZSIsImdldCIsIndhcm4iLCJkdXJhdGlvbiIsImRlbGV0ZSIsIm1ldHJpYyIsInRpbWVzdGFtcCIsIkRhdGUiLCJtZXRyaWNzIiwicHVzaCIsImxlbmd0aCIsIm1heE1ldHJpY3MiLCJzbGljZSIsInRvRml4ZWQiLCJ0aW1lRnVuY3Rpb24iLCJmbiIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsInJlc3VsdCIsImVycm9yIiwiZ2V0U3RhdHMiLCJmaWx0ZXJlZE1ldHJpY3MiLCJmaWx0ZXIiLCJtIiwidG90YWxPcGVyYXRpb25zIiwiYXZlcmFnZUR1cmF0aW9uIiwibWluRHVyYXRpb24iLCJtYXhEdXJhdGlvbiIsInJlY2VudE9wZXJhdGlvbnMiLCJzbG93T3BlcmF0aW9ucyIsImR1cmF0aW9ucyIsIm1hcCIsInJlY2VudEN1dG9mZiIsInJlZHVjZSIsImEiLCJiIiwibWluIiwibWF4IiwiZ2V0U2xvd09wZXJhdGlvbnMiLCJsaW1pdCIsInNvcnQiLCJnZXRPcGVyYXRpb25CcmVha2Rvd24iLCJicmVha2Rvd24iLCJmb3JFYWNoIiwiY291bnQiLCJ0b3RhbER1cmF0aW9uIiwib3AiLCJPYmplY3QiLCJ2YWx1ZXMiLCJjbGVhciIsImluZm8iLCJleHBvcnRNZXRyaWNzIiwiTWFwIiwicGVyZm9ybWFuY2VNb25pdG9yIiwidGltZVJhdGluZ09wZXJhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/performance-monitor.ts\n");

/***/ }),

/***/ "(api)/./src/lib/validation.ts":
/*!*******************************!*\
  !*** ./src/lib/validation.ts ***!
  \*******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createVideoSchema: () => (/* binding */ createVideoSchema),\n/* harmony export */   emailSchema: () => (/* binding */ emailSchema),\n/* harmony export */   isValidEmail: () => (/* binding */ isValidEmail),\n/* harmony export */   isValidPassword: () => (/* binding */ isValidPassword),\n/* harmony export */   isValidUsername: () => (/* binding */ isValidUsername),\n/* harmony export */   isValidVideoUrl: () => (/* binding */ isValidVideoUrl),\n/* harmony export */   paginationSchema: () => (/* binding */ paginationSchema),\n/* harmony export */   passwordSchema: () => (/* binding */ passwordSchema),\n/* harmony export */   ratingSchema: () => (/* binding */ ratingSchema),\n/* harmony export */   safeValidateSchema: () => (/* binding */ safeValidateSchema),\n/* harmony export */   sanitizeArray: () => (/* binding */ sanitizeArray),\n/* harmony export */   sanitizeString: () => (/* binding */ sanitizeString),\n/* harmony export */   sanitizeTags: () => (/* binding */ sanitizeTags),\n/* harmony export */   searchSchema: () => (/* binding */ searchSchema),\n/* harmony export */   signInSchema: () => (/* binding */ signInSchema),\n/* harmony export */   signUpSchema: () => (/* binding */ signUpSchema),\n/* harmony export */   updateUserSchema: () => (/* binding */ updateUserSchema),\n/* harmony export */   updateVideoSchema: () => (/* binding */ updateVideoSchema),\n/* harmony export */   urlSchema: () => (/* binding */ urlSchema),\n/* harmony export */   usernameSchema: () => (/* binding */ usernameSchema),\n/* harmony export */   uuidSchema: () => (/* binding */ uuidSchema),\n/* harmony export */   validateArrayOfStrings: () => (/* binding */ validateArrayOfStrings),\n/* harmony export */   validateOptionalString: () => (/* binding */ validateOptionalString),\n/* harmony export */   validatePartialSchema: () => (/* binding */ validatePartialSchema),\n/* harmony export */   validateSchema: () => (/* binding */ validateSchema),\n/* harmony export */   videoFilterQuerySchema: () => (/* binding */ videoFilterQuerySchema),\n/* harmony export */   videoFilterSchema: () => (/* binding */ videoFilterSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"zod\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./constants */ \"(api)/./src/lib/constants.ts\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./errors */ \"(api)/./src/lib/errors.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([zod__WEBPACK_IMPORTED_MODULE_0__]);\nzod__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Base validation schemas\nconst emailSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().email(\"Please enter a valid email address\").min(1, \"Email is required\");\nconst passwordSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MIN_PASSWORD_LENGTH, `Password must be at least ${_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MIN_PASSWORD_LENGTH} characters long`).max(_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MAX_PASSWORD_LENGTH, `Password must be at most ${_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MAX_PASSWORD_LENGTH} characters long`);\nconst usernameSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MIN_USERNAME_LENGTH, `Username must be at least ${_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MIN_USERNAME_LENGTH} characters long`).max(_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MAX_USERNAME_LENGTH, `Username must be at most ${_constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MAX_USERNAME_LENGTH} characters long`).regex(_constants__WEBPACK_IMPORTED_MODULE_1__.VALIDATION_PATTERNS.USERNAME, \"Username can only contain letters, numbers, and underscores\");\nconst urlSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().url(\"Please enter a valid URL\").min(1, \"URL is required\");\n// User validation schemas\nconst signInSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    email: emailSchema,\n    password: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, \"Password is required\")\n});\nconst signUpSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    email: emailSchema,\n    username: usernameSchema,\n    password: passwordSchema,\n    confirmPassword: zod__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n    firstName: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, \"First name is required\").max(50, \"First name is too long\"),\n    lastName: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, \"Last name is required\").max(50, \"Last name is too long\")\n}).refine((data)=>data.password === data.confirmPassword, {\n    message: \"Passwords do not match\",\n    path: [\n        \"confirmPassword\"\n    ]\n});\nconst updateUserSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    firstName: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(50, \"First name is too long\").optional(),\n    lastName: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(50, \"Last name is too long\").optional(),\n    city: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(100, \"City name is too long\").optional(),\n    birthDay: zod__WEBPACK_IMPORTED_MODULE_0__.z.date().optional(),\n    gender: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"male\",\n        \"female\",\n        \"other\"\n    ]).optional()\n}).partial();\n// Video validation schemas\nconst createVideoSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    title: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(_constants__WEBPACK_IMPORTED_MODULE_1__.VIDEO_LIMITS.MAX_TITLE_LENGTH, `Title must be at most ${_constants__WEBPACK_IMPORTED_MODULE_1__.VIDEO_LIMITS.MAX_TITLE_LENGTH} characters long`).optional(),\n    originalUrl: urlSchema,\n    description: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(_constants__WEBPACK_IMPORTED_MODULE_1__.VIDEO_LIMITS.MAX_DESCRIPTION_LENGTH, `Description must be at most ${_constants__WEBPACK_IMPORTED_MODULE_1__.VIDEO_LIMITS.MAX_DESCRIPTION_LENGTH} characters long`).optional(),\n    isNsfw: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().optional(),\n    tags: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1).max(50)).optional().default([]),\n    tagRatings: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n        name: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1).max(50),\n        rating: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().min(0).max(5)\n    })).optional().default([]),\n    embedUrl: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    thumbnail: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().url().optional().nullable(),\n    previewUrl: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().url().optional().nullable()\n});\nconst updateVideoSchema = createVideoSchema.partial();\n// Tag rating filter schema\nconst tagRatingFilterSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    tagName: zod__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n    minRating: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().min(1).max(5),\n    maxRating: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().min(1).max(5)\n});\n// Schema for validating query parameters (strings from URL)\nconst videoFilterQuerySchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    search: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    tags: zod__WEBPACK_IMPORTED_MODULE_0__.z.union([\n        zod__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n        zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.string())\n    ]).optional().default([]).transform((val)=>{\n        if (!val || val.length === 0) return [];\n        return Array.isArray(val) ? val : [\n            val\n        ];\n    }),\n    tagRatings: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional().transform((val)=>{\n        if (!val) return [];\n        try {\n            const parsed = JSON.parse(val);\n            return Array.isArray(parsed) ? zod__WEBPACK_IMPORTED_MODULE_0__.z.array(tagRatingFilterSchema).parse(parsed) : [];\n        } catch  {\n            return [];\n        }\n    }),\n    includeNsfw: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional().default(\"true\").transform((val)=>val === \"true\"),\n    userId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().uuid().optional(),\n    sortBy: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"createdAt\",\n        \"title\",\n        \"ratings\"\n    ]).default(\"createdAt\"),\n    sortOrder: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"asc\",\n        \"desc\"\n    ]).default(\"desc\"),\n    page: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional().default(\"1\").transform((val)=>parseInt(val, 10)).pipe(zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1)),\n    limit: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional().default(\"12\").transform((val)=>parseInt(val, 10)).pipe(zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1).max(50))\n});\n// Schema for validating already-typed filter objects (for service layer)\nconst videoFilterSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    search: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    tags: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.string()).default([]),\n    tagRatings: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(tagRatingFilterSchema).default([]),\n    includeNsfw: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(true),\n    userId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().uuid().optional(),\n    sortBy: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"createdAt\",\n        \"title\",\n        \"ratings\"\n    ]).default(\"createdAt\"),\n    sortOrder: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"asc\",\n        \"desc\"\n    ]).default(\"desc\"),\n    page: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1).default(1),\n    limit: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1).max(50).default(12)\n});\n// Rating validation schema\nconst ratingSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    tagId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().cuid(\"Invalid tag ID\"),\n    level: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1, \"Rating must be at least 1\").max(5, \"Rating must be at most 5\")\n});\n// Query parameter schemas\nconst paginationSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    page: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().transform(Number).pipe(zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1).default(1)),\n    limit: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().transform(Number).pipe(zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1).max(50).default(12))\n});\nconst searchSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    q: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, \"Search query is required\").max(100, \"Search query is too long\")\n});\n// ID validation schemas\nconst uuidSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.string().uuid(\"Invalid ID format\");\n// Validation utility functions\nfunction validateSchema(schema, data) {\n    try {\n        return schema.parse(data);\n    } catch (error) {\n        if (error instanceof zod__WEBPACK_IMPORTED_MODULE_0__.z.ZodError) {\n            const firstError = error.errors[0];\n            throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(firstError.message, firstError.path.join(\".\"), {\n                field: firstError.path.join(\".\"),\n                value: firstError.code === \"invalid_type\" ? data : undefined,\n                errors: error.errors\n            });\n        }\n        throw error;\n    }\n}\nfunction validatePartialSchema(schema, data) {\n    return validateSchema(schema.partial(), data);\n}\nfunction safeValidateSchema(schema, data) {\n    try {\n        const validatedData = validateSchema(schema, data);\n        return {\n            success: true,\n            data: validatedData\n        };\n    } catch (error) {\n        if (error instanceof _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError) {\n            return {\n                success: false,\n                error\n            };\n        }\n        return {\n            success: false,\n            error: new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(\"Validation failed\", undefined, {\n                originalError: error\n            })\n        };\n    }\n}\n// Field-specific validators\nfunction isValidEmail(email) {\n    return _constants__WEBPACK_IMPORTED_MODULE_1__.VALIDATION_PATTERNS.EMAIL.test(email);\n}\nfunction isValidUsername(username) {\n    return username.length >= _constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MIN_USERNAME_LENGTH && username.length <= _constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MAX_USERNAME_LENGTH && _constants__WEBPACK_IMPORTED_MODULE_1__.VALIDATION_PATTERNS.USERNAME.test(username);\n}\nfunction isValidPassword(password) {\n    return password.length >= _constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MIN_PASSWORD_LENGTH && password.length <= _constants__WEBPACK_IMPORTED_MODULE_1__.USER_LIMITS.MAX_PASSWORD_LENGTH;\n}\nfunction isValidVideoUrl(url) {\n    try {\n        new URL(url) // Check if it's a valid URL\n        ;\n        return true // Accept any valid URL now that we support multiple platforms\n        ;\n    } catch  {\n        return false;\n    }\n}\n// Custom validation helpers\nfunction validateArrayOfStrings(array, fieldName, maxLength) {\n    if (!Array.isArray(array)) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(`${fieldName} must be an array`, fieldName);\n    }\n    if (maxLength && array.length > maxLength) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(`${fieldName} cannot have more than ${maxLength} items`, fieldName, {\n            maxLength,\n            currentLength: array.length\n        });\n    }\n    return array.map((item, index)=>{\n        if (typeof item !== \"string\") {\n            throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(`${fieldName}[${index}] must be a string`, `${fieldName}[${index}]`, {\n                value: item,\n                type: typeof item\n            });\n        }\n        return item.trim();\n    }).filter((item)=>item.length > 0);\n}\nfunction validateOptionalString(value, fieldName, maxLength) {\n    if (value === null || value === undefined || value === \"\") {\n        return undefined;\n    }\n    if (typeof value !== \"string\") {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(`${fieldName} must be a string`, fieldName, {\n            value,\n            type: typeof value\n        });\n    }\n    if (maxLength && value.length > maxLength) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(`${fieldName} cannot be longer than ${maxLength} characters`, fieldName, {\n            maxLength,\n            currentLength: value.length\n        });\n    }\n    return value.trim();\n}\n// Sanitization helpers\nfunction sanitizeString(input) {\n    return input.trim().replace(/\\s+/g, \" \");\n}\nfunction sanitizeArray(input) {\n    return input.map((item)=>sanitizeString(item)).filter((item)=>item.length > 0).filter((item, index, arr)=>arr.indexOf(item) === index) // Remove duplicates\n    ;\n}\nfunction sanitizeTags(tags) {\n    return sanitizeArray(tags).map((tag)=>tag.toLowerCase().trim()).filter((tag)=>tag.length >= 2 && tag.length <= 50) // Reasonable tag length limits\n    .filter((tag)=>/^[a-z0-9\\s-_]+$/i.test(tag)) // Only allow alphanumeric, spaces, hyphens, underscores\n    ;\n// Removed tag limit - allow unlimited tags\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFDNURELFdBQ0E7WUFBRUM7WUFBV0MsZUFBZWxCLE1BQU1sQyxNQUFNO1FBQUM7SUFFN0M7SUFFQSxPQUFPa0MsTUFBTXVCLElBQUk7QUFDbkI7QUFFQSx1QkFBdUI7QUFDaEIsU0FBU0csZUFBZUMsS0FBYTtJQUMxQyxPQUFPQSxNQUFNSixJQUFJLEdBQUdLLE9BQU8sQ0FBQyxRQUFRO0FBQ3RDO0FBRU8sU0FBU0MsY0FBY0YsS0FBZTtJQUMzQyxPQUFPQSxNQUNKUixHQUFHLENBQUNDLENBQUFBLE9BQVFNLGVBQWVOLE9BQzNCSSxNQUFNLENBQUNKLENBQUFBLE9BQVFBLEtBQUt0RCxNQUFNLEdBQUcsR0FDN0IwRCxNQUFNLENBQUMsQ0FBQ0osTUFBTUMsT0FBT1MsTUFBUUEsSUFBSUMsT0FBTyxDQUFDWCxVQUFVQyxPQUFPLG9CQUFvQjs7QUFDbkY7QUFFTyxTQUFTVyxhQUFhdkYsSUFBYztJQUN6QyxPQUFPb0YsY0FBY3BGLE1BQ2xCMEUsR0FBRyxDQUFDYyxDQUFBQSxNQUFPQSxJQUFJQyxXQUFXLEdBQUdYLElBQUksSUFDakNDLE1BQU0sQ0FBQ1MsQ0FBQUEsTUFBT0EsSUFBSW5FLE1BQU0sSUFBSSxLQUFLbUUsSUFBSW5FLE1BQU0sSUFBSSxJQUFJLCtCQUErQjtLQUNsRjBELE1BQU0sQ0FBQ1MsQ0FBQUEsTUFBTyxtQkFBbUJ2QixJQUFJLENBQUN1QixNQUFNLHdEQUF3RDs7QUFDckcsMkNBQTJDO0FBQy9DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9saWIvdmFsaWRhdGlvbi50cz80NjBmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHogfSBmcm9tICd6b2QnXG5pbXBvcnQgeyBWQUxJREFUSU9OX1BBVFRFUk5TLCBVU0VSX0xJTUlUUywgVklERU9fTElNSVRTIH0gZnJvbSAnLi9jb25zdGFudHMnXG5pbXBvcnQgeyBWYWxpZGF0aW9uRXJyb3IgfSBmcm9tICcuL2Vycm9ycydcblxuLy8gQmFzZSB2YWxpZGF0aW9uIHNjaGVtYXNcbmV4cG9ydCBjb25zdCBlbWFpbFNjaGVtYSA9IHpcbiAgLnN0cmluZygpXG4gIC5lbWFpbCgnUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcycpXG4gIC5taW4oMSwgJ0VtYWlsIGlzIHJlcXVpcmVkJylcblxuZXhwb3J0IGNvbnN0IHBhc3N3b3JkU2NoZW1hID0gelxuICAuc3RyaW5nKClcbiAgLm1pbihVU0VSX0xJTUlUUy5NSU5fUEFTU1dPUkRfTEVOR1RILCBgUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCAke1VTRVJfTElNSVRTLk1JTl9QQVNTV09SRF9MRU5HVEh9IGNoYXJhY3RlcnMgbG9uZ2ApXG4gIC5tYXgoVVNFUl9MSU1JVFMuTUFYX1BBU1NXT1JEX0xFTkdUSCwgYFBhc3N3b3JkIG11c3QgYmUgYXQgbW9zdCAke1VTRVJfTElNSVRTLk1BWF9QQVNTV09SRF9MRU5HVEh9IGNoYXJhY3RlcnMgbG9uZ2ApXG5cbmV4cG9ydCBjb25zdCB1c2VybmFtZVNjaGVtYSA9IHpcbiAgLnN0cmluZygpXG4gIC5taW4oVVNFUl9MSU1JVFMuTUlOX1VTRVJOQU1FX0xFTkdUSCwgYFVzZXJuYW1lIG11c3QgYmUgYXQgbGVhc3QgJHtVU0VSX0xJTUlUUy5NSU5fVVNFUk5BTUVfTEVOR1RIfSBjaGFyYWN0ZXJzIGxvbmdgKVxuICAubWF4KFVTRVJfTElNSVRTLk1BWF9VU0VSTkFNRV9MRU5HVEgsIGBVc2VybmFtZSBtdXN0IGJlIGF0IG1vc3QgJHtVU0VSX0xJTUlUUy5NQVhfVVNFUk5BTUVfTEVOR1RIfSBjaGFyYWN0ZXJzIGxvbmdgKVxuICAucmVnZXgoVkFMSURBVElPTl9QQVRURVJOUy5VU0VSTkFNRSwgJ1VzZXJuYW1lIGNhbiBvbmx5IGNvbnRhaW4gbGV0dGVycywgbnVtYmVycywgYW5kIHVuZGVyc2NvcmVzJylcblxuZXhwb3J0IGNvbnN0IHVybFNjaGVtYSA9IHpcbiAgLnN0cmluZygpXG4gIC51cmwoJ1BsZWFzZSBlbnRlciBhIHZhbGlkIFVSTCcpXG4gIC5taW4oMSwgJ1VSTCBpcyByZXF1aXJlZCcpXG5cblxuLy8gVXNlciB2YWxpZGF0aW9uIHNjaGVtYXNcbmV4cG9ydCBjb25zdCBzaWduSW5TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGVtYWlsOiBlbWFpbFNjaGVtYSxcbiAgcGFzc3dvcmQ6IHouc3RyaW5nKCkubWluKDEsICdQYXNzd29yZCBpcyByZXF1aXJlZCcpLFxufSlcblxuZXhwb3J0IGNvbnN0IHNpZ25VcFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZW1haWw6IGVtYWlsU2NoZW1hLFxuICB1c2VybmFtZTogdXNlcm5hbWVTY2hlbWEsXG4gIHBhc3N3b3JkOiBwYXNzd29yZFNjaGVtYSxcbiAgY29uZmlybVBhc3N3b3JkOiB6LnN0cmluZygpLFxuICBmaXJzdE5hbWU6IHouc3RyaW5nKCkubWluKDEsICdGaXJzdCBuYW1lIGlzIHJlcXVpcmVkJykubWF4KDUwLCAnRmlyc3QgbmFtZSBpcyB0b28gbG9uZycpLFxuICBsYXN0TmFtZTogei5zdHJpbmcoKS5taW4oMSwgJ0xhc3QgbmFtZSBpcyByZXF1aXJlZCcpLm1heCg1MCwgJ0xhc3QgbmFtZSBpcyB0b28gbG9uZycpLFxufSkucmVmaW5lKChkYXRhKSA9PiBkYXRhLnBhc3N3b3JkID09PSBkYXRhLmNvbmZpcm1QYXNzd29yZCwge1xuICBtZXNzYWdlOiAnUGFzc3dvcmRzIGRvIG5vdCBtYXRjaCcsXG4gIHBhdGg6IFsnY29uZmlybVBhc3N3b3JkJ10sXG59KVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlclNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZmlyc3ROYW1lOiB6LnN0cmluZygpLm1heCg1MCwgJ0ZpcnN0IG5hbWUgaXMgdG9vIGxvbmcnKS5vcHRpb25hbCgpLFxuICBsYXN0TmFtZTogei5zdHJpbmcoKS5tYXgoNTAsICdMYXN0IG5hbWUgaXMgdG9vIGxvbmcnKS5vcHRpb25hbCgpLFxuICBjaXR5OiB6LnN0cmluZygpLm1heCgxMDAsICdDaXR5IG5hbWUgaXMgdG9vIGxvbmcnKS5vcHRpb25hbCgpLFxuICBiaXJ0aERheTogei5kYXRlKCkub3B0aW9uYWwoKSxcbiAgZ2VuZGVyOiB6LmVudW0oWydtYWxlJywgJ2ZlbWFsZScsICdvdGhlciddKS5vcHRpb25hbCgpLFxufSkucGFydGlhbCgpXG5cbi8vIFZpZGVvIHZhbGlkYXRpb24gc2NoZW1hc1xuZXhwb3J0IGNvbnN0IGNyZWF0ZVZpZGVvU2NoZW1hID0gei5vYmplY3Qoe1xuICB0aXRsZTogelxuICAgIC5zdHJpbmcoKVxuICAgIC5tYXgoVklERU9fTElNSVRTLk1BWF9USVRMRV9MRU5HVEgsIGBUaXRsZSBtdXN0IGJlIGF0IG1vc3QgJHtWSURFT19MSU1JVFMuTUFYX1RJVExFX0xFTkdUSH0gY2hhcmFjdGVycyBsb25nYClcbiAgICAub3B0aW9uYWwoKSwgLy8gVGl0bGUgY2FuIGJlIGF1dG8tZXh0cmFjdGVkXG4gIG9yaWdpbmFsVXJsOiB1cmxTY2hlbWEsXG4gIGRlc2NyaXB0aW9uOiB6XG4gICAgLnN0cmluZygpXG4gICAgLm1heChWSURFT19MSU1JVFMuTUFYX0RFU0NSSVBUSU9OX0xFTkdUSCwgYERlc2NyaXB0aW9uIG11c3QgYmUgYXQgbW9zdCAke1ZJREVPX0xJTUlUUy5NQVhfREVTQ1JJUFRJT05fTEVOR1RIfSBjaGFyYWN0ZXJzIGxvbmdgKVxuICAgIC5vcHRpb25hbCgpLFxuICBpc05zZnc6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksIC8vIEF1dG8tZGV0ZWN0ZWQsIGJ1dCBjYW4gYmUgbWFudWFsbHkgc2V0XG4gIHRhZ3M6IHpcbiAgICAuYXJyYXkoei5zdHJpbmcoKS5taW4oMSkubWF4KDUwKSlcbiAgICAub3B0aW9uYWwoKVxuICAgIC5kZWZhdWx0KFtdKSxcbiAgdGFnUmF0aW5nczogelxuICAgIC5hcnJheSh6Lm9iamVjdCh7XG4gICAgICBuYW1lOiB6LnN0cmluZygpLm1pbigxKS5tYXgoNTApLFxuICAgICAgcmF0aW5nOiB6Lm51bWJlcigpLm1pbigwKS5tYXgoNSlcbiAgICB9KSlcbiAgICAub3B0aW9uYWwoKVxuICAgIC5kZWZhdWx0KFtdKSxcbiAgZW1iZWRVcmw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSwgLy8gRm9yIHByb3ZpZGVkIGVtYmVkIFVSTHNcbiAgdGh1bWJuYWlsOiB6LnN0cmluZygpLnVybCgpLm9wdGlvbmFsKCkubnVsbGFibGUoKSwgLy8gRm9yIHByb3ZpZGVkIHRodW1ibmFpbHNcbiAgcHJldmlld1VybDogei5zdHJpbmcoKS51cmwoKS5vcHRpb25hbCgpLm51bGxhYmxlKCksIC8vIEZvciBwcm92aWRlZCBwcmV2aWV3IFVSTHNcbn0pXG5cbmV4cG9ydCBjb25zdCB1cGRhdGVWaWRlb1NjaGVtYSA9IGNyZWF0ZVZpZGVvU2NoZW1hLnBhcnRpYWwoKVxuXG4vLyBUYWcgcmF0aW5nIGZpbHRlciBzY2hlbWFcbmNvbnN0IHRhZ1JhdGluZ0ZpbHRlclNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdGFnTmFtZTogei5zdHJpbmcoKSxcbiAgbWluUmF0aW5nOiB6Lm51bWJlcigpLm1pbigxKS5tYXgoNSksXG4gIG1heFJhdGluZzogei5udW1iZXIoKS5taW4oMSkubWF4KDUpLFxufSlcblxuLy8gU2NoZW1hIGZvciB2YWxpZGF0aW5nIHF1ZXJ5IHBhcmFtZXRlcnMgKHN0cmluZ3MgZnJvbSBVUkwpXG5leHBvcnQgY29uc3QgdmlkZW9GaWx0ZXJRdWVyeVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgc2VhcmNoOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHRhZ3M6IHoudW5pb24oW3ouc3RyaW5nKCksIHouYXJyYXkoei5zdHJpbmcoKSldKS5vcHRpb25hbCgpLmRlZmF1bHQoW10pLnRyYW5zZm9ybSh2YWwgPT4ge1xuICAgIGlmICghdmFsIHx8IHZhbC5sZW5ndGggPT09IDApIHJldHVybiBbXVxuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHZhbCkgPyB2YWwgOiBbdmFsXVxuICB9KSxcbiAgdGFnUmF0aW5nczogei5zdHJpbmcoKS5vcHRpb25hbCgpLnRyYW5zZm9ybSh2YWwgPT4ge1xuICAgIGlmICghdmFsKSByZXR1cm4gW11cbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZSh2YWwpXG4gICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShwYXJzZWQpID8gei5hcnJheSh0YWdSYXRpbmdGaWx0ZXJTY2hlbWEpLnBhcnNlKHBhcnNlZCkgOiBbXVxuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9KSxcbiAgaW5jbHVkZU5zZnc6IHouc3RyaW5nKCkub3B0aW9uYWwoKS5kZWZhdWx0KCd0cnVlJykudHJhbnNmb3JtKHZhbCA9PiB2YWwgPT09ICd0cnVlJyksXG4gIHVzZXJJZDogei5zdHJpbmcoKS51dWlkKCkub3B0aW9uYWwoKSxcbiAgc29ydEJ5OiB6LmVudW0oWydjcmVhdGVkQXQnLCAndGl0bGUnLCAncmF0aW5ncyddKS5kZWZhdWx0KCdjcmVhdGVkQXQnKSxcbiAgc29ydE9yZGVyOiB6LmVudW0oWydhc2MnLCAnZGVzYyddKS5kZWZhdWx0KCdkZXNjJyksXG4gIHBhZ2U6IHouc3RyaW5nKCkub3B0aW9uYWwoKS5kZWZhdWx0KCcxJykudHJhbnNmb3JtKHZhbCA9PiBwYXJzZUludCh2YWwsIDEwKSkucGlwZSh6Lm51bWJlcigpLmludCgpLm1pbigxKSksXG4gIGxpbWl0OiB6LnN0cmluZygpLm9wdGlvbmFsKCkuZGVmYXVsdCgnMTInKS50cmFuc2Zvcm0odmFsID0+IHBhcnNlSW50KHZhbCwgMTApKS5waXBlKHoubnVtYmVyKCkuaW50KCkubWluKDEpLm1heCg1MCkpLFxufSlcblxuLy8gU2NoZW1hIGZvciB2YWxpZGF0aW5nIGFscmVhZHktdHlwZWQgZmlsdGVyIG9iamVjdHMgKGZvciBzZXJ2aWNlIGxheWVyKVxuZXhwb3J0IGNvbnN0IHZpZGVvRmlsdGVyU2NoZW1hID0gei5vYmplY3Qoe1xuICBzZWFyY2g6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdGFnczogei5hcnJheSh6LnN0cmluZygpKS5kZWZhdWx0KFtdKSxcbiAgdGFnUmF0aW5nczogei5hcnJheSh0YWdSYXRpbmdGaWx0ZXJTY2hlbWEpLmRlZmF1bHQoW10pLFxuICBpbmNsdWRlTnNmdzogei5ib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgdXNlcklkOiB6LnN0cmluZygpLnV1aWQoKS5vcHRpb25hbCgpLFxuICBzb3J0Qnk6IHouZW51bShbJ2NyZWF0ZWRBdCcsICd0aXRsZScsICdyYXRpbmdzJ10pLmRlZmF1bHQoJ2NyZWF0ZWRBdCcpLFxuICBzb3J0T3JkZXI6IHouZW51bShbJ2FzYycsICdkZXNjJ10pLmRlZmF1bHQoJ2Rlc2MnKSxcbiAgcGFnZTogei5udW1iZXIoKS5pbnQoKS5taW4oMSkuZGVmYXVsdCgxKSxcbiAgbGltaXQ6IHoubnVtYmVyKCkuaW50KCkubWluKDEpLm1heCg1MCkuZGVmYXVsdCgxMiksXG59KVxuXG4vLyBSYXRpbmcgdmFsaWRhdGlvbiBzY2hlbWFcbmV4cG9ydCBjb25zdCByYXRpbmdTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHRhZ0lkOiB6LnN0cmluZygpLmN1aWQoJ0ludmFsaWQgdGFnIElEJyksXG4gIGxldmVsOiB6Lm51bWJlcigpLmludCgpLm1pbigxLCAnUmF0aW5nIG11c3QgYmUgYXQgbGVhc3QgMScpLm1heCg1LCAnUmF0aW5nIG11c3QgYmUgYXQgbW9zdCA1JyksXG59KVxuXG4vLyBRdWVyeSBwYXJhbWV0ZXIgc2NoZW1hc1xuZXhwb3J0IGNvbnN0IHBhZ2luYXRpb25TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHBhZ2U6IHouc3RyaW5nKCkudHJhbnNmb3JtKE51bWJlcikucGlwZSh6Lm51bWJlcigpLmludCgpLm1pbigxKS5kZWZhdWx0KDEpKSxcbiAgbGltaXQ6IHouc3RyaW5nKCkudHJhbnNmb3JtKE51bWJlcikucGlwZSh6Lm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoNTApLmRlZmF1bHQoMTIpKSxcbn0pXG5cbmV4cG9ydCBjb25zdCBzZWFyY2hTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHE6IHouc3RyaW5nKCkubWluKDEsICdTZWFyY2ggcXVlcnkgaXMgcmVxdWlyZWQnKS5tYXgoMTAwLCAnU2VhcmNoIHF1ZXJ5IGlzIHRvbyBsb25nJyksXG59KVxuXG4vLyBJRCB2YWxpZGF0aW9uIHNjaGVtYXNcbmV4cG9ydCBjb25zdCB1dWlkU2NoZW1hID0gei5zdHJpbmcoKS51dWlkKCdJbnZhbGlkIElEIGZvcm1hdCcpXG5cbi8vIFZhbGlkYXRpb24gdXRpbGl0eSBmdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVNjaGVtYTxUPihzY2hlbWE6IHouWm9kU2NoZW1hPFQ+LCBkYXRhOiB1bmtub3duKTogVCB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHNjaGVtYS5wYXJzZShkYXRhKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIHouWm9kRXJyb3IpIHtcbiAgICAgIGNvbnN0IGZpcnN0RXJyb3IgPSBlcnJvci5lcnJvcnNbMF1cbiAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoZmlyc3RFcnJvci5tZXNzYWdlLCBmaXJzdEVycm9yLnBhdGguam9pbignLicpLCB7XG4gICAgICAgIGZpZWxkOiBmaXJzdEVycm9yLnBhdGguam9pbignLicpLFxuICAgICAgICB2YWx1ZTogZmlyc3RFcnJvci5jb2RlID09PSAnaW52YWxpZF90eXBlJyA/IGRhdGEgOiB1bmRlZmluZWQsXG4gICAgICAgIGVycm9yczogZXJyb3IuZXJyb3JzLFxuICAgICAgfSlcbiAgICB9XG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQYXJ0aWFsU2NoZW1hPFQ+KHNjaGVtYTogei5ab2RPYmplY3Q8YW55PiwgZGF0YTogdW5rbm93bik6IFBhcnRpYWw8VD4ge1xuICByZXR1cm4gdmFsaWRhdGVTY2hlbWEoc2NoZW1hLnBhcnRpYWwoKSwgZGF0YSkgYXMgUGFydGlhbDxUPlxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2FmZVZhbGlkYXRlU2NoZW1hPFQ+KFxuICBzY2hlbWE6IHouWm9kU2NoZW1hPFQ+LFxuICBkYXRhOiB1bmtub3duXG4pOiB7IHN1Y2Nlc3M6IHRydWU7IGRhdGE6IFQgfSB8IHsgc3VjY2VzczogZmFsc2U7IGVycm9yOiBWYWxpZGF0aW9uRXJyb3IgfSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IHZhbGlkYXRlU2NoZW1hKHNjaGVtYSwgZGF0YSlcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB2YWxpZGF0ZWREYXRhIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBWYWxpZGF0aW9uRXJyb3IpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvciB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBuZXcgVmFsaWRhdGlvbkVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcsIHVuZGVmaW5lZCwgeyBvcmlnaW5hbEVycm9yOiBlcnJvciB9KVxuICAgIH1cbiAgfVxufVxuXG4vLyBGaWVsZC1zcGVjaWZpYyB2YWxpZGF0b3JzXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZEVtYWlsKGVtYWlsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIFZBTElEQVRJT05fUEFUVEVSTlMuRU1BSUwudGVzdChlbWFpbClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRVc2VybmFtZSh1c2VybmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAoXG4gICAgdXNlcm5hbWUubGVuZ3RoID49IFVTRVJfTElNSVRTLk1JTl9VU0VSTkFNRV9MRU5HVEggJiZcbiAgICB1c2VybmFtZS5sZW5ndGggPD0gVVNFUl9MSU1JVFMuTUFYX1VTRVJOQU1FX0xFTkdUSCAmJlxuICAgIFZBTElEQVRJT05fUEFUVEVSTlMuVVNFUk5BTUUudGVzdCh1c2VybmFtZSlcbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZFBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIChcbiAgICBwYXNzd29yZC5sZW5ndGggPj0gVVNFUl9MSU1JVFMuTUlOX1BBU1NXT1JEX0xFTkdUSCAmJlxuICAgIHBhc3N3b3JkLmxlbmd0aCA8PSBVU0VSX0xJTUlUUy5NQVhfUEFTU1dPUkRfTEVOR1RIXG4gIClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRWaWRlb1VybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIG5ldyBVUkwodXJsKSAvLyBDaGVjayBpZiBpdCdzIGEgdmFsaWQgVVJMXG4gICAgcmV0dXJuIHRydWUgLy8gQWNjZXB0IGFueSB2YWxpZCBVUkwgbm93IHRoYXQgd2Ugc3VwcG9ydCBtdWx0aXBsZSBwbGF0Zm9ybXNcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuLy8gQ3VzdG9tIHZhbGlkYXRpb24gaGVscGVyc1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQXJyYXlPZlN0cmluZ3MoXG4gIGFycmF5OiB1bmtub3duLFxuICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgbWF4TGVuZ3RoPzogbnVtYmVyXG4pOiBzdHJpbmdbXSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhbiBhcnJheWAsIGZpZWxkTmFtZSlcbiAgfVxuXG4gIGlmIChtYXhMZW5ndGggJiYgYXJyYXkubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcbiAgICAgIGAke2ZpZWxkTmFtZX0gY2Fubm90IGhhdmUgbW9yZSB0aGFuICR7bWF4TGVuZ3RofSBpdGVtc2AsXG4gICAgICBmaWVsZE5hbWUsXG4gICAgICB7IG1heExlbmd0aCwgY3VycmVudExlbmd0aDogYXJyYXkubGVuZ3RoIH1cbiAgICApXG4gIH1cblxuICByZXR1cm4gYXJyYXkubWFwKChpdGVtLCBpbmRleCkgPT4ge1xuICAgIGlmICh0eXBlb2YgaXRlbSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgIGAke2ZpZWxkTmFtZX1bJHtpbmRleH1dIG11c3QgYmUgYSBzdHJpbmdgLFxuICAgICAgICBgJHtmaWVsZE5hbWV9WyR7aW5kZXh9XWAsXG4gICAgICAgIHsgdmFsdWU6IGl0ZW0sIHR5cGU6IHR5cGVvZiBpdGVtIH1cbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIGl0ZW0udHJpbSgpXG4gIH0pLmZpbHRlcihpdGVtID0+IGl0ZW0ubGVuZ3RoID4gMClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlT3B0aW9uYWxTdHJpbmcoXG4gIHZhbHVlOiB1bmtub3duLFxuICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgbWF4TGVuZ3RoPzogbnVtYmVyXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gJycpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH1cblxuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7ZmllbGROYW1lfSBtdXN0IGJlIGEgc3RyaW5nYCwgZmllbGROYW1lLCB7XG4gICAgICB2YWx1ZSxcbiAgICAgIHR5cGU6IHR5cGVvZiB2YWx1ZVxuICAgIH0pXG4gIH1cblxuICBpZiAobWF4TGVuZ3RoICYmIHZhbHVlLmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXG4gICAgICBgJHtmaWVsZE5hbWV9IGNhbm5vdCBiZSBsb25nZXIgdGhhbiAke21heExlbmd0aH0gY2hhcmFjdGVyc2AsXG4gICAgICBmaWVsZE5hbWUsXG4gICAgICB7IG1heExlbmd0aCwgY3VycmVudExlbmd0aDogdmFsdWUubGVuZ3RoIH1cbiAgICApXG4gIH1cblxuICByZXR1cm4gdmFsdWUudHJpbSgpXG59XG5cbi8vIFNhbml0aXphdGlvbiBoZWxwZXJzXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVTdHJpbmcoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBpbnB1dC50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnICcpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGl6ZUFycmF5KGlucHV0OiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIGlucHV0XG4gICAgLm1hcChpdGVtID0+IHNhbml0aXplU3RyaW5nKGl0ZW0pKVxuICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLmxlbmd0aCA+IDApXG4gICAgLmZpbHRlcigoaXRlbSwgaW5kZXgsIGFycikgPT4gYXJyLmluZGV4T2YoaXRlbSkgPT09IGluZGV4KSAvLyBSZW1vdmUgZHVwbGljYXRlc1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVUYWdzKHRhZ3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICByZXR1cm4gc2FuaXRpemVBcnJheSh0YWdzKVxuICAgIC5tYXAodGFnID0+IHRhZy50b0xvd2VyQ2FzZSgpLnRyaW0oKSlcbiAgICAuZmlsdGVyKHRhZyA9PiB0YWcubGVuZ3RoID49IDIgJiYgdGFnLmxlbmd0aCA8PSA1MCkgLy8gUmVhc29uYWJsZSB0YWcgbGVuZ3RoIGxpbWl0c1xuICAgIC5maWx0ZXIodGFnID0+IC9eW2EtejAtOVxccy1fXSskL2kudGVzdCh0YWcpKSAvLyBPbmx5IGFsbG93IGFscGhhbnVtZXJpYywgc3BhY2VzLCBoeXBoZW5zLCB1bmRlcnNjb3Jlc1xuICAgIC8vIFJlbW92ZWQgdGFnIGxpbWl0IC0gYWxsb3cgdW5saW1pdGVkIHRhZ3Ncbn0iXSwibmFtZXMiOlsieiIsIlZBTElEQVRJT05fUEFUVEVSTlMiLCJVU0VSX0xJTUlUUyIsIlZJREVPX0xJTUlUUyIsIlZhbGlkYXRpb25FcnJvciIsImVtYWlsU2NoZW1hIiwic3RyaW5nIiwiZW1haWwiLCJtaW4iLCJwYXNzd29yZFNjaGVtYSIsIk1JTl9QQVNTV09SRF9MRU5HVEgiLCJtYXgiLCJNQVhfUEFTU1dPUkRfTEVOR1RIIiwidXNlcm5hbWVTY2hlbWEiLCJNSU5fVVNFUk5BTUVfTEVOR1RIIiwiTUFYX1VTRVJOQU1FX0xFTkdUSCIsInJlZ2V4IiwiVVNFUk5BTUUiLCJ1cmxTY2hlbWEiLCJ1cmwiLCJzaWduSW5TY2hlbWEiLCJvYmplY3QiLCJwYXNzd29yZCIsInNpZ25VcFNjaGVtYSIsInVzZXJuYW1lIiwiY29uZmlybVBhc3N3b3JkIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJyZWZpbmUiLCJkYXRhIiwibWVzc2FnZSIsInBhdGgiLCJ1cGRhdGVVc2VyU2NoZW1hIiwib3B0aW9uYWwiLCJjaXR5IiwiYmlydGhEYXkiLCJkYXRlIiwiZ2VuZGVyIiwiZW51bSIsInBhcnRpYWwiLCJjcmVhdGVWaWRlb1NjaGVtYSIsInRpdGxlIiwiTUFYX1RJVExFX0xFTkdUSCIsIm9yaWdpbmFsVXJsIiwiZGVzY3JpcHRpb24iLCJNQVhfREVTQ1JJUFRJT05fTEVOR1RIIiwiaXNOc2Z3IiwiYm9vbGVhbiIsInRhZ3MiLCJhcnJheSIsImRlZmF1bHQiLCJ0YWdSYXRpbmdzIiwibmFtZSIsInJhdGluZyIsIm51bWJlciIsImVtYmVkVXJsIiwidGh1bWJuYWlsIiwibnVsbGFibGUiLCJwcmV2aWV3VXJsIiwidXBkYXRlVmlkZW9TY2hlbWEiLCJ0YWdSYXRpbmdGaWx0ZXJTY2hlbWEiLCJ0YWdOYW1lIiwibWluUmF0aW5nIiwibWF4UmF0aW5nIiwidmlkZW9GaWx0ZXJRdWVyeVNjaGVtYSIsInNlYXJjaCIsInVuaW9uIiwidHJhbnNmb3JtIiwidmFsIiwibGVuZ3RoIiwiQXJyYXkiLCJpc0FycmF5IiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwiaW5jbHVkZU5zZnciLCJ1c2VySWQiLCJ1dWlkIiwic29ydEJ5Iiwic29ydE9yZGVyIiwicGFnZSIsInBhcnNlSW50IiwicGlwZSIsImludCIsImxpbWl0IiwidmlkZW9GaWx0ZXJTY2hlbWEiLCJyYXRpbmdTY2hlbWEiLCJ0YWdJZCIsImN1aWQiLCJsZXZlbCIsInBhZ2luYXRpb25TY2hlbWEiLCJOdW1iZXIiLCJzZWFyY2hTY2hlbWEiLCJxIiwidXVpZFNjaGVtYSIsInZhbGlkYXRlU2NoZW1hIiwic2NoZW1hIiwiZXJyb3IiLCJab2RFcnJvciIsImZpcnN0RXJyb3IiLCJlcnJvcnMiLCJqb2luIiwiZmllbGQiLCJ2YWx1ZSIsImNvZGUiLCJ1bmRlZmluZWQiLCJ2YWxpZGF0ZVBhcnRpYWxTY2hlbWEiLCJzYWZlVmFsaWRhdGVTY2hlbWEiLCJ2YWxpZGF0ZWREYXRhIiwic3VjY2VzcyIsIm9yaWdpbmFsRXJyb3IiLCJpc1ZhbGlkRW1haWwiLCJFTUFJTCIsInRlc3QiLCJpc1ZhbGlkVXNlcm5hbWUiLCJpc1ZhbGlkUGFzc3dvcmQiLCJpc1ZhbGlkVmlkZW9VcmwiLCJVUkwiLCJ2YWxpZGF0ZUFycmF5T2ZTdHJpbmdzIiwiZmllbGROYW1lIiwibWF4TGVuZ3RoIiwiY3VycmVudExlbmd0aCIsIm1hcCIsIml0ZW0iLCJpbmRleCIsInR5cGUiLCJ0cmltIiwiZmlsdGVyIiwidmFsaWRhdGVPcHRpb25hbFN0cmluZyIsInNhbml0aXplU3RyaW5nIiwiaW5wdXQiLCJyZXBsYWNlIiwic2FuaXRpemVBcnJheSIsImFyciIsImluZGV4T2YiLCJzYW5pdGl6ZVRhZ3MiLCJ0YWciLCJ0b0xvd2VyQ2FzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/validation.ts\n");

/***/ }),

/***/ "(api)/./src/repositories/base.repository.ts":
/*!*********************************************!*\
  !*** ./src/repositories/base.repository.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseRepository: () => (/* binding */ BaseRepository)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n\n\nclass BaseRepository {\n    async findById(id) {\n        try {\n            const result = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].findUnique({\n                where: {\n                    id\n                }\n            });\n            return result;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error finding ${this.tableName} by id`, {\n                id,\n                error\n            });\n            throw error;\n        }\n    }\n    async findMany(filters) {\n        try {\n            const result = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].findMany(filters);\n            return result;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error finding many ${this.tableName}`, {\n                filters,\n                error\n            });\n            throw error;\n        }\n    }\n    async create(data) {\n        try {\n            const result = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].create({\n                data\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`Created ${this.tableName}`, {\n                id: result.id\n            });\n            return result;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error creating ${this.tableName}`, {\n                data,\n                error\n            });\n            throw error;\n        }\n    }\n    async update(id, data) {\n        try {\n            const result = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].update({\n                where: {\n                    id\n                },\n                data\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`Updated ${this.tableName}`, {\n                id\n            });\n            return result;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error updating ${this.tableName}`, {\n                id,\n                data,\n                error\n            });\n            throw error;\n        }\n    }\n    async delete(id) {\n        try {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].delete({\n                where: {\n                    id\n                }\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`Deleted ${this.tableName}`, {\n                id\n            });\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error deleting ${this.tableName}`, {\n                id,\n                error\n            });\n            throw error;\n        }\n    }\n    async count(filters) {\n        try {\n            const result = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].count(filters);\n            return result;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error counting ${this.tableName}`, {\n                filters,\n                error\n            });\n            throw error;\n        }\n    }\n    async findManyWithPagination(filters = {}, page = 1, limit = 10) {\n        try {\n            const skip = (page - 1) * limit;\n            const [items, total] = await Promise.all([\n                _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].findMany({\n                    ...filters,\n                    skip,\n                    take: limit\n                }),\n                _lib_db__WEBPACK_IMPORTED_MODULE_0__.db[this.tableName].count({\n                    where: filters.where\n                })\n            ]);\n            const totalPages = Math.ceil(total / limit);\n            return {\n                items,\n                total,\n                totalPages\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(`Error finding ${this.tableName} with pagination`, {\n                filters,\n                page,\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcmVwb3NpdG9yaWVzL2Jhc2UucmVwb3NpdG9yeS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEI7QUFDUTtBQUcvQixNQUFlRTtJQUdwQixNQUFNQyxTQUFTQyxFQUFVLEVBQXFCO1FBQzVDLElBQUk7WUFDRixNQUFNQyxTQUFTLE1BQU0sdUNBQVcsQ0FBQyxJQUFJLENBQUNDLFNBQVMsQ0FBQyxDQUFDQyxVQUFVLENBQUM7Z0JBQzFEQyxPQUFPO29CQUFFSjtnQkFBRztZQUNkO1lBQ0EsT0FBT0M7UUFDVCxFQUFFLE9BQU9JLE9BQU87WUFDZFIsK0NBQU1BLENBQUNRLEtBQUssQ0FBQyxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUNILFNBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRTtnQkFBRUY7Z0JBQUlLO1lBQU07WUFDbEUsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTUMsU0FBU0MsT0FBYSxFQUFnQjtRQUMxQyxJQUFJO1lBQ0YsTUFBTU4sU0FBUyxNQUFNLHVDQUFXLENBQUMsSUFBSSxDQUFDQyxTQUFTLENBQUMsQ0FBQ0ksUUFBUSxDQUFDQztZQUMxRCxPQUFPTjtRQUNULEVBQUUsT0FBT0ksT0FBTztZQUNkUiwrQ0FBTUEsQ0FBQ1EsS0FBSyxDQUFDLENBQUMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDSCxTQUFTLENBQUMsQ0FBQyxFQUFFO2dCQUFFSztnQkFBU0Y7WUFBTTtZQUN0RSxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxNQUFNRyxPQUFPQyxJQUErQyxFQUFjO1FBQ3hFLElBQUk7WUFDRixNQUFNUixTQUFTLE1BQU0sdUNBQVcsQ0FBQyxJQUFJLENBQUNDLFNBQVMsQ0FBQyxDQUFDTSxNQUFNLENBQUM7Z0JBQ3REQztZQUNGO1lBQ0FaLCtDQUFNQSxDQUFDYSxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDUixTQUFTLENBQUMsQ0FBQyxFQUFFO2dCQUFFRixJQUFJQyxPQUFPRCxFQUFFO1lBQUM7WUFDekQsT0FBT0M7UUFD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cG9zaXRvcmllcy9iYXNlLnJlcG9zaXRvcnkudHM/YWEwMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkYiB9IGZyb20gJy4uL2xpYi9kYidcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uL2xpYi9sb2dnZXInXG5pbXBvcnQgeyBSZXBvc2l0b3J5IH0gZnJvbSAnLi4vdHlwZXMnXG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBCYXNlUmVwb3NpdG9yeTxUPiBpbXBsZW1lbnRzIFJlcG9zaXRvcnk8VD4ge1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgdGFibGVOYW1lOiBzdHJpbmdcblxuICBhc3luYyBmaW5kQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoZGIgYXMgYW55KVt0aGlzLnRhYmxlTmFtZV0uZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihgRXJyb3IgZmluZGluZyAke3RoaXMudGFibGVOYW1lfSBieSBpZGAsIHsgaWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZpbmRNYW55KGZpbHRlcnM/OiBhbnkpOiBQcm9taXNlPFRbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoZGIgYXMgYW55KVt0aGlzLnRhYmxlTmFtZV0uZmluZE1hbnkoZmlsdGVycylcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKGBFcnJvciBmaW5kaW5nIG1hbnkgJHt0aGlzLnRhYmxlTmFtZX1gLCB7IGZpbHRlcnMsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZShkYXRhOiBPbWl0PFQsICdpZCcgfCAnY3JlYXRlZEF0JyB8ICd1cGRhdGVkQXQnPik6IFByb21pc2U8VD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoZGIgYXMgYW55KVt0aGlzLnRhYmxlTmFtZV0uY3JlYXRlKHtcbiAgICAgICAgZGF0YVxuICAgICAgfSlcbiAgICAgIGxvZ2dlci5pbmZvKGBDcmVhdGVkICR7dGhpcy50YWJsZU5hbWV9YCwgeyBpZDogcmVzdWx0LmlkIH0pXG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihgRXJyb3IgY3JlYXRpbmcgJHt0aGlzLnRhYmxlTmFtZX1gLCB7IGRhdGEsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZShpZDogc3RyaW5nLCBkYXRhOiBQYXJ0aWFsPFQ+KTogUHJvbWlzZTxUPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChkYiBhcyBhbnkpW3RoaXMudGFibGVOYW1lXS51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgICBkYXRhXG4gICAgICB9KVxuICAgICAgbG9nZ2VyLmluZm8oYFVwZGF0ZWQgJHt0aGlzLnRhYmxlTmFtZX1gLCB7IGlkIH0pXG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihgRXJyb3IgdXBkYXRpbmcgJHt0aGlzLnRhYmxlTmFtZX1gLCB7IGlkLCBkYXRhLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBkZWxldGUoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCAoZGIgYXMgYW55KVt0aGlzLnRhYmxlTmFtZV0uZGVsZXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQgfVxuICAgICAgfSlcbiAgICAgIGxvZ2dlci5pbmZvKGBEZWxldGVkICR7dGhpcy50YWJsZU5hbWV9YCwgeyBpZCB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoYEVycm9yIGRlbGV0aW5nICR7dGhpcy50YWJsZU5hbWV9YCwgeyBpZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY291bnQoZmlsdGVycz86IGFueSk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChkYiBhcyBhbnkpW3RoaXMudGFibGVOYW1lXS5jb3VudChmaWx0ZXJzKVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoYEVycm9yIGNvdW50aW5nICR7dGhpcy50YWJsZU5hbWV9YCwgeyBmaWx0ZXJzLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgYXN5bmMgZmluZE1hbnlXaXRoUGFnaW5hdGlvbihcbiAgICBmaWx0ZXJzOiBhbnkgPSB7fSxcbiAgICBwYWdlOiBudW1iZXIgPSAxLFxuICAgIGxpbWl0OiBudW1iZXIgPSAxMFxuICApOiBQcm9taXNlPHsgaXRlbXM6IFRbXTsgdG90YWw6IG51bWJlcjsgdG90YWxQYWdlczogbnVtYmVyIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBsaW1pdFxuICAgICAgY29uc3QgW2l0ZW1zLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIChkYiBhcyBhbnkpW3RoaXMudGFibGVOYW1lXS5maW5kTWFueSh7XG4gICAgICAgICAgLi4uZmlsdGVycyxcbiAgICAgICAgICBza2lwLFxuICAgICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICB9KSxcbiAgICAgICAgKGRiIGFzIGFueSlbdGhpcy50YWJsZU5hbWVdLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogZmlsdGVycy53aGVyZSxcbiAgICAgICAgfSksXG4gICAgICBdKVxuXG4gICAgICBjb25zdCB0b3RhbFBhZ2VzID0gTWF0aC5jZWlsKHRvdGFsIC8gbGltaXQpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGl0ZW1zLFxuICAgICAgICB0b3RhbCxcbiAgICAgICAgdG90YWxQYWdlcyxcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKGBFcnJvciBmaW5kaW5nICR7dGhpcy50YWJsZU5hbWV9IHdpdGggcGFnaW5hdGlvbmAsIHtcbiAgICAgICAgZmlsdGVycyxcbiAgICAgICAgcGFnZSxcbiAgICAgICAgbGltaXQsXG4gICAgICAgIGVycm9yLFxuICAgICAgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbImRiIiwibG9nZ2VyIiwiQmFzZVJlcG9zaXRvcnkiLCJmaW5kQnlJZCIsImlkIiwicmVzdWx0IiwidGFibGVOYW1lIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiZXJyb3IiLCJmaW5kTWFueSIsImZpbHRlcnMiLCJjcmVhdGUiLCJkYXRhIiwiaW5mbyIsInVwZGF0ZSIsImRlbGV0ZSIsImNvdW50IiwiZmluZE1hbnlXaXRoUGFnaW5hdGlvbiIsInBhZ2UiLCJsaW1pdCIsInNraXAiLCJpdGVtcyIsInRvdGFsIiwiUHJvbWlzZSIsImFsbCIsInRha2UiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/repositories/base.repository.ts\n");

/***/ }),

/***/ "(api)/./src/repositories/rating.repository.ts":
/*!***********************************************!*\
  !*** ./src/repositories/rating.repository.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RatingRepositoryImpl: () => (/* binding */ RatingRepositoryImpl),\n/* harmony export */   ratingRepository: () => (/* binding */ ratingRepository)\n/* harmony export */ });\n/* harmony import */ var _base_repository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.repository */ \"(api)/./src/repositories/base.repository.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_performance_monitor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/performance-monitor */ \"(api)/./src/lib/performance-monitor.ts\");\n\n\n\n\nclass RatingRepositoryImpl extends _base_repository__WEBPACK_IMPORTED_MODULE_0__.BaseRepository {\n    async findByVideoId(videoId) {\n        try {\n            const ratings = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.findMany({\n                where: {\n                    videoId\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tag: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return ratings;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding ratings by video id\", {\n                videoId,\n                error\n            });\n            throw error;\n        }\n    }\n    async findByUserId(userId) {\n        try {\n            const ratings = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.findMany({\n                where: {\n                    userId\n                },\n                include: {\n                    video: {\n                        include: {\n                            user: {\n                                select: {\n                                    id: true,\n                                    username: true,\n                                    firstName: true,\n                                    lastName: true,\n                                    avatar: true\n                                }\n                            }\n                        }\n                    },\n                    tag: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return ratings;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding ratings by user id\", {\n                userId,\n                error\n            });\n            throw error;\n        }\n    }\n    async findByUserAndVideo(userId, videoId) {\n        try {\n            const ratings = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.findMany({\n                where: {\n                    userId,\n                    videoId\n                },\n                include: {\n                    tag: true\n                }\n            });\n            return ratings;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding ratings by user and video\", {\n                userId,\n                videoId,\n                error\n            });\n            throw error;\n        }\n    }\n    async upsertRating(videoId, userId, tagId, level) {\n        try {\n            const rating = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.upsert({\n                where: {\n                    videoId_userId_tagId: {\n                        videoId,\n                        userId,\n                        tagId\n                    }\n                },\n                update: {\n                    level\n                },\n                create: {\n                    videoId,\n                    userId,\n                    tagId,\n                    level\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tag: true\n                }\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Upserted rating\", {\n                videoId,\n                userId,\n                tagId,\n                level\n            });\n            return rating;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error upserting rating\", {\n                videoId,\n                userId,\n                tagId,\n                level,\n                error\n            });\n            throw error;\n        }\n    }\n    async deleteRating(videoId, userId, tagId) {\n        try {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.delete({\n                where: {\n                    videoId_userId_tagId: {\n                        videoId,\n                        userId,\n                        tagId\n                    }\n                }\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Deleted rating\", {\n                videoId,\n                userId,\n                tagId\n            });\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error deleting rating\", {\n                videoId,\n                userId,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getAverageRating(videoId, tagId) {\n        try {\n            const where = {\n                videoId\n            };\n            if (tagId) {\n                where.tagId = tagId;\n            }\n            const result = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.aggregate({\n                where,\n                _avg: {\n                    level: true\n                }\n            });\n            return result._avg.level || 0;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting average rating\", {\n                videoId,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getRatingDistribution(videoId, tagId) {\n        try {\n            const where = {\n                videoId\n            };\n            if (tagId) {\n                where.tagId = tagId;\n            }\n            const distribution = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.groupBy({\n                by: [\n                    \"level\"\n                ],\n                where,\n                _count: {\n                    level: true\n                },\n                orderBy: {\n                    level: \"asc\"\n                }\n            });\n            return distribution.map((item)=>({\n                    level: item.level,\n                    count: item._count.level\n                }));\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting rating distribution\", {\n                videoId,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getUserRatingForVideo(userId, videoId, tagId) {\n        try {\n            const rating = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.findUnique({\n                where: {\n                    videoId_userId_tagId: {\n                        videoId,\n                        userId,\n                        tagId\n                    }\n                },\n                include: {\n                    tag: true\n                }\n            });\n            return rating;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting user rating for video\", {\n                userId,\n                videoId,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getTopRatedVideos(limit = 10, tagId) {\n        try {\n            const where = {};\n            if (tagId) {\n                where.tagId = tagId;\n            }\n            const topRated = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.groupBy({\n                by: [\n                    \"videoId\"\n                ],\n                where,\n                _avg: {\n                    level: true\n                },\n                _count: {\n                    level: true\n                },\n                having: {\n                    level: {\n                        _count: {\n                            gte: 3 // At least 3 ratings to be considered\n                        }\n                    }\n                },\n                orderBy: {\n                    _avg: {\n                        level: \"desc\"\n                    }\n                },\n                take: limit\n            });\n            return topRated.map((item)=>({\n                    videoId: item.videoId,\n                    averageRating: item._avg.level || 0,\n                    ratingCount: item._count.level\n                }));\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting top rated videos\", {\n                limit,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async bulkUpsertRatings(ratings) {\n        return (0,_lib_performance_monitor__WEBPACK_IMPORTED_MODULE_3__.timeRatingOperation)(\"bulk_upsert\", async ()=>{\n            try {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Starting bulk rating upsert\", {\n                    count: ratings.length\n                });\n                // Use transaction for consistency\n                const result = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.$transaction(async (tx)=>{\n                    const upsertPromises = ratings.map((rating)=>tx.rating.upsert({\n                            where: {\n                                videoId_userId_tagId: {\n                                    videoId: rating.videoId,\n                                    userId: rating.userId,\n                                    tagId: rating.tagId\n                                }\n                            },\n                            update: {\n                                level: rating.level,\n                                updatedAt: new Date()\n                            },\n                            create: {\n                                videoId: rating.videoId,\n                                userId: rating.userId,\n                                tagId: rating.tagId,\n                                level: rating.level\n                            },\n                            include: {\n                                user: {\n                                    select: {\n                                        id: true,\n                                        username: true,\n                                        firstName: true,\n                                        lastName: true,\n                                        avatar: true\n                                    }\n                                },\n                                tag: true\n                            }\n                        }));\n                    return Promise.all(upsertPromises);\n                });\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Bulk rating upsert completed\", {\n                    count: ratings.length,\n                    successful: result.length\n                });\n                return result;\n            } catch (error) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error in bulk rating upsert\", {\n                    count: ratings.length,\n                    error\n                });\n                throw error;\n            }\n        }, {\n            ratingsCount: ratings.length\n        });\n    }\n    async getRatingsByVideoIds(videoIds) {\n        try {\n            if (videoIds.length === 0) return new Map();\n            const ratings = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.findMany({\n                where: {\n                    videoId: {\n                        in: videoIds\n                    }\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tag: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            // Group ratings by video ID\n            const ratingsByVideo = new Map();\n            ratings.forEach((rating)=>{\n                if (!ratingsByVideo.has(rating.videoId)) {\n                    ratingsByVideo.set(rating.videoId, []);\n                }\n                ratingsByVideo.get(rating.videoId).push(rating);\n            });\n            return ratingsByVideo;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting ratings by video IDs\", {\n                videoIds: videoIds.length,\n                error\n            });\n            throw error;\n        }\n    }\n    async getAverageRatingsByVideoIds(videoIds, tagId) {\n        try {\n            if (videoIds.length === 0) return new Map();\n            const where = {\n                videoId: {\n                    in: videoIds\n                }\n            };\n            if (tagId) {\n                where.tagId = tagId;\n            }\n            const averages = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.groupBy({\n                by: [\n                    \"videoId\"\n                ],\n                where,\n                _avg: {\n                    level: true\n                }\n            });\n            const averageMap = new Map();\n            averages.forEach((avg)=>{\n                averageMap.set(avg.videoId, avg._avg.level || 0);\n            });\n            return averageMap;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting average ratings by video IDs\", {\n                videoIds: videoIds.length,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    constructor(...args){\n        super(...args);\n        this.tableName = \"rating\";\n    }\n}\n// Export singleton instance\nconst ratingRepository = new RatingRepositoryImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcmVwb3NpdG9yaWVzL3JhdGluZy5yZXBvc2l0b3J5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUNrRDtBQUNwQjtBQUNRO0FBQzBCO0FBRXpELE1BQU1JLDZCQUE2QkosNERBQWNBO0lBR3RELE1BQU1LLGNBQWNDLE9BQWUsRUFBa0I7UUFDbkQsSUFBSTtZQUNGLE1BQU1DLFVBQVUsTUFBTU4sdUNBQUVBLENBQUNPLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDO2dCQUN2Q0MsT0FBTztvQkFBRUo7Z0JBQVE7Z0JBQ2pCSyxTQUFTO29CQUNQQyxNQUFNO3dCQUNKQyxRQUFROzRCQUNOQyxJQUFJOzRCQUNKQyxVQUFVOzRCQUNWQyxXQUFXOzRCQUNYQyxVQUFVOzRCQUNWQyxRQUFRO3dCQUNWO29CQUNGO29CQUNBQyxLQUFLO2dCQUNQO2dCQUNBQyxTQUFTO29CQUNQQyxXQUFXO2dCQUNiO1lBQ0Y7WUFDQSxPQUFPZDtRQUNULEVBQUUsT0FBT2UsT0FBTztZQUNkcEIsK0NBQU1BLENBQUNvQixLQUFLLENBQUMscUNBQXFDO2dCQUFFaEI7Z0JBQVNnQjtZQUFNO1lBQ25FLE1BQU1BO1FBQ1I7SUFDRjtJQUVBLE1BQU1DLGFBQWFDLE1BQWMsRUFBa0I7UUFDakQsSUFBSTtZQUNGLE1BQU1qQixVQUFVLE1BQU1OLHVDQUFFQSxDQUFDTyxNQUFNLENBQUNDLFFBQVEsQ0FBQztnQkFDdkNDLE9BQU87b0JBQUVjO2dCQUFPO2dCQUNoQmIsU0FBUztvQkFDUGMsT0FBTzt3QkFDTGQsU0FBUzs0QkFDUEMsTUFBTTtnQ0FDSkMsUUFBUTtvQ0FDTkMsSUFBSTtvQ0FDSkMsVUFBVTtvQ0FDVkMsV0FBVztvQ0FDWEMsVUFBVTtvQ0FDVkMsUUFBUTtnQ0FDVjs0QkFDRjt3QkFDRjtvQkFDRjtvQkFDQUMsS0FBSztnQkFDUDtnQkFDQUMsU0FBUztvQkFDUEMsV0FBVztnQkFDYjtZQUNGO1lBQ0EsT0FBT2Q7UUFDVCxFQUFFLE9BQU9lLE9BQU87WUFDZHBCLCtDQUFN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Q1Q7WUFDRjtZQUVBLE1BQU1xRCxhQUFhLElBQUlWO1lBQ3ZCUyxTQUFTTixPQUFPLENBQUNRLENBQUFBO2dCQUNmRCxXQUFXTCxHQUFHLENBQUNNLElBQUk3RSxPQUFPLEVBQUU2RSxJQUFJM0MsSUFBSSxDQUFDWCxLQUFLLElBQUk7WUFDaEQ7WUFFQSxPQUFPcUQ7UUFDVCxFQUFFLE9BQU81RCxPQUFPO1lBQ2RwQiwrQ0FBTUEsQ0FBQ29CLEtBQUssQ0FBQyw4Q0FBOEM7Z0JBQUVpRCxVQUFVQSxTQUFTWCxNQUFNO2dCQUFFaEM7Z0JBQU9OO1lBQU07WUFDckcsTUFBTUE7UUFDUjtJQUNGOzs7YUFsWlU4RCxZQUFZOztBQW1aeEI7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUMsbUJBQW1CLElBQUlqRix1QkFBc0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yYXRlbXktbmV4dGpzLy4vc3JjL3JlcG9zaXRvcmllcy9yYXRpbmcucmVwb3NpdG9yeS50cz9hOTcwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJhdGluZyB9IGZyb20gJy4uL3R5cGVzJ1xuaW1wb3J0IHsgQmFzZVJlcG9zaXRvcnkgfSBmcm9tICcuL2Jhc2UucmVwb3NpdG9yeSdcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vbGliL2RiJ1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vbGliL2xvZ2dlcidcbmltcG9ydCB7IHRpbWVSYXRpbmdPcGVyYXRpb24gfSBmcm9tICcuLi9saWIvcGVyZm9ybWFuY2UtbW9uaXRvcidcblxuZXhwb3J0IGNsYXNzIFJhdGluZ1JlcG9zaXRvcnlJbXBsIGV4dGVuZHMgQmFzZVJlcG9zaXRvcnk8UmF0aW5nPiB7XG4gIHByb3RlY3RlZCB0YWJsZU5hbWUgPSAncmF0aW5nJ1xuXG4gIGFzeW5jIGZpbmRCeVZpZGVvSWQodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByYXRpbmdzID0gYXdhaXQgZGIucmF0aW5nLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdmlkZW9JZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHJhdGluZ3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBmaW5kaW5nIHJhdGluZ3MgYnkgdmlkZW8gaWQnLCB7IHZpZGVvSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZpbmRCeVVzZXJJZCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmF0aW5ncyA9IGF3YWl0IGRiLnJhdGluZy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdmlkZW86IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHJhdGluZ3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBmaW5kaW5nIHJhdGluZ3MgYnkgdXNlciBpZCcsIHsgdXNlcklkLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBmaW5kQnlVc2VyQW5kVmlkZW8odXNlcklkOiBzdHJpbmcsIHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmF0aW5ncyA9IGF3YWl0IGRiLnJhdGluZy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHZpZGVvSWRcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHJhdGluZ3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBmaW5kaW5nIHJhdGluZ3MgYnkgdXNlciBhbmQgdmlkZW8nLCB7IHVzZXJJZCwgdmlkZW9JZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdXBzZXJ0UmF0aW5nKFxuICAgIHZpZGVvSWQ6IHN0cmluZyxcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICB0YWdJZDogc3RyaW5nLFxuICAgIGxldmVsOiBudW1iZXJcbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmF0aW5nID0gYXdhaXQgZGIucmF0aW5nLnVwc2VydCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgdmlkZW9JZF91c2VySWRfdGFnSWQ6IHtcbiAgICAgICAgICAgIHZpZGVvSWQsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICB0YWdJZFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgbGV2ZWxcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgdmlkZW9JZCxcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgdGFnSWQsXG4gICAgICAgICAgbGV2ZWxcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgdXNlcm5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGF2YXRhcjogdHJ1ZSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBsb2dnZXIuaW5mbygnVXBzZXJ0ZWQgcmF0aW5nJywgeyB2aWRlb0lkLCB1c2VySWQsIHRhZ0lkLCBsZXZlbCB9KVxuICAgICAgcmV0dXJuIHJhdGluZ1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHVwc2VydGluZyByYXRpbmcnLCB7IHZpZGVvSWQsIHVzZXJJZCwgdGFnSWQsIGxldmVsLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBkZWxldGVSYXRpbmcodmlkZW9JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgdGFnSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkYi5yYXRpbmcuZGVsZXRlKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICB2aWRlb0lkX3VzZXJJZF90YWdJZDoge1xuICAgICAgICAgICAgdmlkZW9JZCxcbiAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgIHRhZ0lkXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBsb2dnZXIuaW5mbygnRGVsZXRlZCByYXRpbmcnLCB7IHZpZGVvSWQsIHVzZXJJZCwgdGFnSWQgfSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBkZWxldGluZyByYXRpbmcnLCB7IHZpZGVvSWQsIHVzZXJJZCwgdGFnSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldEF2ZXJhZ2VSYXRpbmcodmlkZW9JZDogc3RyaW5nLCB0YWdJZD86IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IHZpZGVvSWQgfVxuICAgICAgaWYgKHRhZ0lkKSB7XG4gICAgICAgIHdoZXJlLnRhZ0lkID0gdGFnSWRcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucmF0aW5nLmFnZ3JlZ2F0ZSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBfYXZnOiB7XG4gICAgICAgICAgbGV2ZWw6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHJlc3VsdC5fYXZnLmxldmVsIHx8IDBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGF2ZXJhZ2UgcmF0aW5nJywgeyB2aWRlb0lkLCB0YWdJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UmF0aW5nRGlzdHJpYnV0aW9uKHZpZGVvSWQ6IHN0cmluZywgdGFnSWQ/OiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgY291bnQ6IG51bWJlciB9Pj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB3aGVyZTogYW55ID0geyB2aWRlb0lkIH1cbiAgICAgIGlmICh0YWdJZCkge1xuICAgICAgICB3aGVyZS50YWdJZCA9IHRhZ0lkXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRpc3RyaWJ1dGlvbiA9IGF3YWl0IGRiLnJhdGluZy5ncm91cEJ5KHtcbiAgICAgICAgYnk6IFsnbGV2ZWwnXSxcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIF9jb3VudDoge1xuICAgICAgICAgIGxldmVsOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBsZXZlbDogJ2FzYydcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIGRpc3RyaWJ1dGlvbi5tYXAoaXRlbSA9PiAoe1xuICAgICAgICBsZXZlbDogaXRlbS5sZXZlbCxcbiAgICAgICAgY291bnQ6IGl0ZW0uX2NvdW50LmxldmVsXG4gICAgICB9KSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHJhdGluZyBkaXN0cmlidXRpb24nLCB7IHZpZGVvSWQsIHRhZ0lkLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRVc2VyUmF0aW5nRm9yVmlkZW8oXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgdmlkZW9JZDogc3RyaW5nLFxuICAgIHRhZ0lkOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxhbnkgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJhdGluZyA9IGF3YWl0IGRiLnJhdGluZy5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICB2aWRlb0lkX3VzZXJJZF90YWdJZDoge1xuICAgICAgICAgICAgdmlkZW9JZCxcbiAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgIHRhZ0lkXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdGFnOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gcmF0aW5nXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyB1c2VyIHJhdGluZyBmb3IgdmlkZW8nLCB7IHVzZXJJZCwgdmlkZW9JZCwgdGFnSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFRvcFJhdGVkVmlkZW9zKGxpbWl0OiBudW1iZXIgPSAxMCwgdGFnSWQ/OiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PHtcbiAgICB2aWRlb0lkOiBzdHJpbmc7XG4gICAgYXZlcmFnZVJhdGluZzogbnVtYmVyO1xuICAgIHJhdGluZ0NvdW50OiBudW1iZXI7XG4gIH0+PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7fVxuICAgICAgaWYgKHRhZ0lkKSB7XG4gICAgICAgIHdoZXJlLnRhZ0lkID0gdGFnSWRcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG9wUmF0ZWQgPSBhd2FpdCBkYi5yYXRpbmcuZ3JvdXBCeSh7XG4gICAgICAgIGJ5OiBbJ3ZpZGVvSWQnXSxcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIF9hdmc6IHtcbiAgICAgICAgICBsZXZlbDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICBsZXZlbDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBoYXZpbmc6IHtcbiAgICAgICAgICBsZXZlbDoge1xuICAgICAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgICAgIGd0ZTogMyAvLyBBdCBsZWFzdCAzIHJhdGluZ3MgdG8gYmUgY29uc2lkZXJlZFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgIF9hdmc6IHtcbiAgICAgICAgICAgIGxldmVsOiAnZGVzYydcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0XG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gdG9wUmF0ZWQubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgdmlkZW9JZDogaXRlbS52aWRlb0lkLFxuICAgICAgICBhdmVyYWdlUmF0aW5nOiBpdGVtLl9hdmcubGV2ZWwgfHwgMCxcbiAgICAgICAgcmF0aW5nQ291bnQ6IGl0ZW0uX2NvdW50LmxldmVsXG4gICAgICB9KSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHRvcCByYXRlZCB2aWRlb3MnLCB7IGxpbWl0LCB0YWdJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYnVsa1Vwc2VydFJhdGluZ3MocmF0aW5nczogQXJyYXk8e1xuICAgIHZpZGVvSWQ6IHN0cmluZztcbiAgICB1c2VySWQ6IHN0cmluZztcbiAgICB0YWdJZDogc3RyaW5nO1xuICAgIGxldmVsOiBudW1iZXI7XG4gIH0+KTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHJldHVybiB0aW1lUmF0aW5nT3BlcmF0aW9uKCdidWxrX3Vwc2VydCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdTdGFydGluZyBidWxrIHJhdGluZyB1cHNlcnQnLCB7IGNvdW50OiByYXRpbmdzLmxlbmd0aCB9KVxuICAgICAgICBcbiAgICAgICAgLy8gVXNlIHRyYW5zYWN0aW9uIGZvciBjb25zaXN0ZW5jeVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgICAgICAgY29uc3QgdXBzZXJ0UHJvbWlzZXMgPSByYXRpbmdzLm1hcChyYXRpbmcgPT4gXG4gICAgICAgICAgICB0eC5yYXRpbmcudXBzZXJ0KHtcbiAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB2aWRlb0lkX3VzZXJJZF90YWdJZDoge1xuICAgICAgICAgICAgICAgICAgdmlkZW9JZDogcmF0aW5nLnZpZGVvSWQsXG4gICAgICAgICAgICAgICAgICB1c2VySWQ6IHJhdGluZy51c2VySWQsXG4gICAgICAgICAgICAgICAgICB0YWdJZDogcmF0aW5nLnRhZ0lkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgICBsZXZlbDogcmF0aW5nLmxldmVsLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICAgICAgICB2aWRlb0lkOiByYXRpbmcudmlkZW9JZCxcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHJhdGluZy51c2VySWQsXG4gICAgICAgICAgICAgICAgdGFnSWQ6IHJhdGluZy50YWdJZCxcbiAgICAgICAgICAgICAgICBsZXZlbDogcmF0aW5nLmxldmVsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICApXG5cbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwodXBzZXJ0UHJvbWlzZXMpXG4gICAgICAgIH0pXG5cbiAgICAgICAgbG9nZ2VyLmluZm8oJ0J1bGsgcmF0aW5nIHVwc2VydCBjb21wbGV0ZWQnLCB7IFxuICAgICAgICAgIGNvdW50OiByYXRpbmdzLmxlbmd0aCxcbiAgICAgICAgICBzdWNjZXNzZnVsOiByZXN1bHQubGVuZ3RoIFxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBpbiBidWxrIHJhdGluZyB1cHNlcnQnLCB7IFxuICAgICAgICAgIGNvdW50OiByYXRpbmdzLmxlbmd0aCwgXG4gICAgICAgICAgZXJyb3IgXG4gICAgICAgIH0pXG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgfSwgeyByYXRpbmdzQ291bnQ6IHJhdGluZ3MubGVuZ3RoIH0pXG4gIH1cblxuICBhc3luYyBnZXRSYXRpbmdzQnlWaWRlb0lkcyh2aWRlb0lkczogc3RyaW5nW10pOiBQcm9taXNlPE1hcDxzdHJpbmcsIGFueVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAodmlkZW9JZHMubGVuZ3RoID09PSAwKSByZXR1cm4gbmV3IE1hcCgpXG5cbiAgICAgIGNvbnN0IHJhdGluZ3MgPSBhd2FpdCBkYi5yYXRpbmcuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIHZpZGVvSWQ6IHtcbiAgICAgICAgICAgIGluOiB2aWRlb0lkc1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgdXNlcm5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGF2YXRhcjogdHJ1ZSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiAnZGVzYydcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gR3JvdXAgcmF0aW5ncyBieSB2aWRlbyBJRFxuICAgICAgY29uc3QgcmF0aW5nc0J5VmlkZW8gPSBuZXcgTWFwPHN0cmluZywgYW55W10+KClcbiAgICAgIHJhdGluZ3MuZm9yRWFjaChyYXRpbmcgPT4ge1xuICAgICAgICBpZiAoIXJhdGluZ3NCeVZpZGVvLmhhcyhyYXRpbmcudmlkZW9JZCkpIHtcbiAgICAgICAgICByYXRpbmdzQnlWaWRlby5zZXQocmF0aW5nLnZpZGVvSWQsIFtdKVxuICAgICAgICB9XG4gICAgICAgIHJhdGluZ3NCeVZpZGVvLmdldChyYXRpbmcudmlkZW9JZCkhLnB1c2gocmF0aW5nKVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHJhdGluZ3NCeVZpZGVvXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyByYXRpbmdzIGJ5IHZpZGVvIElEcycsIHsgdmlkZW9JZHM6IHZpZGVvSWRzLmxlbmd0aCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0QXZlcmFnZVJhdGluZ3NCeVZpZGVvSWRzKHZpZGVvSWRzOiBzdHJpbmdbXSwgdGFnSWQ/OiBzdHJpbmcpOiBQcm9taXNlPE1hcDxzdHJpbmcsIG51bWJlcj4+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHZpZGVvSWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG5ldyBNYXAoKVxuXG4gICAgICBjb25zdCB3aGVyZTogYW55ID0ge1xuICAgICAgICB2aWRlb0lkOiB7XG4gICAgICAgICAgaW46IHZpZGVvSWRzXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0YWdJZCkge1xuICAgICAgICB3aGVyZS50YWdJZCA9IHRhZ0lkXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGF2ZXJhZ2VzID0gYXdhaXQgZGIucmF0aW5nLmdyb3VwQnkoe1xuICAgICAgICBieTogWyd2aWRlb0lkJ10sXG4gICAgICAgIHdoZXJlLFxuICAgICAgICBfYXZnOiB7XG4gICAgICAgICAgbGV2ZWw6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgY29uc3QgYXZlcmFnZU1hcCA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KClcbiAgICAgIGF2ZXJhZ2VzLmZvckVhY2goYXZnID0+IHtcbiAgICAgICAgYXZlcmFnZU1hcC5zZXQoYXZnLnZpZGVvSWQsIGF2Zy5fYXZnLmxldmVsIHx8IDApXG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gYXZlcmFnZU1hcFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgYXZlcmFnZSByYXRpbmdzIGJ5IHZpZGVvIElEcycsIHsgdmlkZW9JZHM6IHZpZGVvSWRzLmxlbmd0aCwgdGFnSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgcmF0aW5nUmVwb3NpdG9yeSA9IG5ldyBSYXRpbmdSZXBvc2l0b3J5SW1wbCgpIl0sIm5hbWVzIjpbIkJhc2VSZXBvc2l0b3J5IiwiZGIiLCJsb2dnZXIiLCJ0aW1lUmF0aW5nT3BlcmF0aW9uIiwiUmF0aW5nUmVwb3NpdG9yeUltcGwiLCJmaW5kQnlWaWRlb0lkIiwidmlkZW9JZCIsInJhdGluZ3MiLCJyYXRpbmciLCJmaW5kTWFueSIsIndoZXJlIiwiaW5jbHVkZSIsInVzZXIiLCJzZWxlY3QiLCJpZCIsInVzZXJuYW1lIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJhdmF0YXIiLCJ0YWciLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwiZXJyb3IiLCJmaW5kQnlVc2VySWQiLCJ1c2VySWQiLCJ2aWRlbyIsImZpbmRCeVVzZXJBbmRWaWRlbyIsInVwc2VydFJhdGluZyIsInRhZ0lkIiwibGV2ZWwiLCJ1cHNlcnQiLCJ2aWRlb0lkX3VzZXJJZF90YWdJZCIsInVwZGF0ZSIsImNyZWF0ZSIsImluZm8iLCJkZWxldGVSYXRpbmciLCJkZWxldGUiLCJnZXRBdmVyYWdlUmF0aW5nIiwicmVzdWx0IiwiYWdncmVnYXRlIiwiX2F2ZyIsImdldFJhdGluZ0Rpc3RyaWJ1dGlvbiIsImRpc3RyaWJ1dGlvbiIsImdyb3VwQnkiLCJieSIsIl9jb3VudCIsIm1hcCIsIml0ZW0iLCJjb3VudCIsImdldFVzZXJSYXRpbmdGb3JWaWRlbyIsImZpbmRVbmlxdWUiLCJnZXRUb3BSYXRlZFZpZGVvcyIsImxpbWl0IiwidG9wUmF0ZWQiLCJoYXZpbmciLCJndGUiLCJ0YWtlIiwiYXZlcmFnZVJhdGluZyIsInJhdGluZ0NvdW50IiwiYnVsa1Vwc2VydFJhdGluZ3MiLCJsZW5ndGgiLCIkdHJhbnNhY3Rpb24iLCJ0eCIsInVwc2VydFByb21pc2VzIiwidXBkYXRlZEF0IiwiRGF0ZSIsIlByb21pc2UiLCJhbGwiLCJzdWNjZXNzZnVsIiwicmF0aW5nc0NvdW50IiwiZ2V0UmF0aW5nc0J5VmlkZW9JZHMiLCJ2aWRlb0lkcyIsIk1hcCIsImluIiwicmF0aW5nc0J5VmlkZW8iLCJmb3JFYWNoIiwiaGFzIiwic2V0IiwiZ2V0IiwicHVzaCIsImdldEF2ZXJhZ2VSYXRpbmdzQnlWaWRlb0lkcyIsImF2ZXJhZ2VzIiwiYXZlcmFnZU1hcCIsImF2ZyIsInRhYmxlTmFtZSIsInJhdGluZ1JlcG9zaXRvcnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/repositories/rating.repository.ts\n");

/***/ }),

/***/ "(api)/./src/repositories/tag.repository.ts":
/*!********************************************!*\
  !*** ./src/repositories/tag.repository.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TagRepositoryImpl: () => (/* binding */ TagRepositoryImpl),\n/* harmony export */   tagRepository: () => (/* binding */ tagRepository)\n/* harmony export */ });\n/* harmony import */ var _base_repository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.repository */ \"(api)/./src/repositories/base.repository.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n\n\n\nclass TagRepositoryImpl extends _base_repository__WEBPACK_IMPORTED_MODULE_0__.BaseRepository {\n    async findByName(name) {\n        try {\n            const tag = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findUnique({\n                where: {\n                    name\n                }\n            });\n            return tag;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding tag by name\", {\n                name,\n                error\n            });\n            throw error;\n        }\n    }\n    async findOrCreate(name) {\n        try {\n            const tag = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.upsert({\n                where: {\n                    name\n                },\n                update: {},\n                create: {\n                    name\n                }\n            });\n            return tag;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding or creating tag\", {\n                name,\n                error\n            });\n            throw error;\n        }\n    }\n    async findManyByNames(names) {\n        try {\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                where: {\n                    name: {\n                        in: names\n                    }\n                }\n            });\n            return tags;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding tags by names\", {\n                names,\n                error\n            });\n            throw error;\n        }\n    }\n    async searchTags(query, limit = 10) {\n        try {\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                where: {\n                    name: {\n                        contains: query,\n                        mode: \"insensitive\"\n                    }\n                },\n                take: limit,\n                orderBy: {\n                    name: \"asc\"\n                }\n            });\n            return tags;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error searching tags\", {\n                query,\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    async getPopularTags(limit = 20) {\n        try {\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                include: {\n                    _count: {\n                        select: {\n                            videos: true\n                        }\n                    }\n                },\n                orderBy: {\n                    videos: {\n                        _count: \"desc\"\n                    }\n                },\n                take: limit\n            });\n            return tags;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting popular tags\", {\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    async getTagsWithVideoCount() {\n        try {\n            const tagsWithCount = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                include: {\n                    _count: {\n                        select: {\n                            videos: true\n                        }\n                    }\n                },\n                orderBy: {\n                    name: \"asc\"\n                }\n            });\n            return tagsWithCount.map((tag)=>({\n                    ...tag,\n                    videoCount: tag._count.videos\n                }));\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting tags with video count\", {\n                error\n            });\n            throw error;\n        }\n    }\n    async getTagsByVideoId(videoId) {\n        try {\n            const videoTags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.videoTag.findMany({\n                where: {\n                    videoId\n                },\n                include: {\n                    tag: true\n                }\n            });\n            return videoTags.map((vt)=>vt.tag);\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting tags by video id\", {\n                videoId,\n                error\n            });\n            throw error;\n        }\n    }\n    async createMultiple(names) {\n        try {\n            // Filter out existing tags\n            const existingTags = await this.findManyByNames(names);\n            const existingNames = existingTags.map((tag)=>tag.name);\n            const newNames = names.filter((name)=>!existingNames.includes(name));\n            if (newNames.length === 0) {\n                return existingTags;\n            }\n            // Create new tags\n            const newTags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.createMany({\n                data: newNames.map((name)=>({\n                        name\n                    })),\n                skipDuplicates: true\n            });\n            // Return all tags (existing + new)\n            return this.findManyByNames(names);\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error creating multiple tags\", {\n                names,\n                error\n            });\n            throw error;\n        }\n    }\n    async getTagUsageStats(tagId) {\n        try {\n            const [videoCount, ratingStats] = await Promise.all([\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.videoTag.count({\n                    where: {\n                        tagId\n                    }\n                }),\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.aggregate({\n                    where: {\n                        tagId\n                    },\n                    _count: {\n                        level: true\n                    },\n                    _avg: {\n                        level: true\n                    }\n                })\n            ]);\n            return {\n                totalVideos: videoCount,\n                totalRatings: ratingStats._count.level,\n                averageRating: ratingStats._avg.level || 0\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting tag usage stats\", {\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getTrendingTags(days = 7, limit = 10) {\n        try {\n            const dateThreshold = new Date();\n            dateThreshold.setDate(dateThreshold.getDate() - days);\n            const trendingTags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                include: {\n                    videos: {\n                        where: {\n                            video: {\n                                createdAt: {\n                                    gte: dateThreshold\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            const tagsWithCounts = trendingTags.map((tag)=>({\n                    ...tag,\n                    recentVideos: tag.videos.length\n                })).filter((tag)=>tag.recentVideos > 0).sort((a, b)=>b.recentVideos - a.recentVideos).slice(0, limit);\n            return tagsWithCounts;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting trending tags\", {\n                days,\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    async findAllWithCounts() {\n        try {\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                include: {\n                    _count: {\n                        select: {\n                            videos: true\n                        }\n                    }\n                },\n                orderBy: {\n                    name: \"asc\"\n                }\n            });\n            return tags;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding all tags with counts\", {\n                error\n            });\n            throw error;\n        }\n    }\n    async findPopular(limit = 20) {\n        try {\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                include: {\n                    _count: {\n                        select: {\n                            videos: true\n                        }\n                    }\n                },\n                orderBy: {\n                    videos: {\n                        _count: \"desc\"\n                    }\n                },\n                take: limit\n            });\n            return tags;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding popular tags\", {\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    async search(query, limit = 10) {\n        try {\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                where: {\n                    name: {\n                        contains: query,\n                        mode: \"insensitive\"\n                    }\n                },\n                take: limit,\n                orderBy: {\n                    name: \"asc\"\n                }\n            });\n            return tags;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error searching tags\", {\n                query,\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    constructor(...args){\n        super(...args);\n        this.tableName = \"tag\";\n    }\n}\n// Export singleton instance\nconst tagRepository = new TagRepositoryImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcmVwb3NpdG9yaWVzL3RhZy5yZXBvc2l0b3J5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQ2tEO0FBQ3BCO0FBQ1E7QUFFL0IsTUFBTUcsMEJBQTBCSCw0REFBY0E7SUFHbkQsTUFBTUksV0FBV0MsSUFBWSxFQUF1QjtRQUNsRCxJQUFJO1lBQ0YsTUFBTUMsTUFBTSxNQUFNTCx1Q0FBRUEsQ0FBQ0ssR0FBRyxDQUFDQyxVQUFVLENBQUM7Z0JBQ2xDQyxPQUFPO29CQUFFSDtnQkFBSztZQUNoQjtZQUNBLE9BQU9DO1FBQ1QsRUFBRSxPQUFPRyxPQUFPO1lBQ2RQLCtDQUFNQSxDQUFDTyxLQUFLLENBQUMsNkJBQTZCO2dCQUFFSjtnQkFBTUk7WUFBTTtZQUN4RCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxNQUFNQyxhQUFhTCxJQUFZLEVBQWdCO1FBQzdDLElBQUk7WUFDRixNQUFNQyxNQUFNLE1BQU1MLHVDQUFFQSxDQUFDSyxHQUFHLENBQUNLLE1BQU0sQ0FBQztnQkFDOUJILE9BQU87b0JBQUVIO2dCQUFLO2dCQUNkTyxRQUFRLENBQUM7Z0JBQ1RDLFFBQVE7b0JBQUVSO2dCQUFLO1lBQ2pCO1lBQ0EsT0FBT0M7UUFDVCxFQUFFLE9BQU9HLE9BQU87WUFDZFAsK0NBQU1BLENBQUNPLEtBQUssQ0FBQyxpQ0FBaUM7Z0JBQUVKO2dCQUFNSTtZQUFNO1lBQzVELE1BQU1BO1FBQ1I7SUFDRjtJQUVBLE1BQU1LLGdCQUFnQkMsS0FBZSxFQUFrQjtRQUNyRCxJQUFJO1lBQ0YsTUFBTUMsT0FBTyxNQUFNZix1Q0FBRUEsQ0FBQ0ssR0FBRyxDQUFDVyxRQUFRLENBQUM7Z0JBQ2pDVCxPQUFPO29CQUNMSCxNQUFNO3dCQUNKYSxJQUFJSDtvQkFDTjtnQkFDRjtZQUNGO1lBQ0EsT0FBT0M7UUFDVCxFQUFFLE9BQU9QLE9BQU87WUFDZFAsK0NBQU1BLENBQUNPLEtBQUssQ0FBQywrQkFBK0I7Z0JBQUVNO2dCQUFPTjtZQUFNO1lBQzNELE1BQU1BO1FBQ1I7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TkMsUUFBUTs0QkFDTkMsUUFBUTt3QkFDVjtvQkFDRjtnQkFDRjtnQkFDQUwsU0FBUztvQkFDUEssUUFBUTt3QkFDTkYsUUFBUTtvQkFDVjtnQkFDRjtnQkFDQUosTUFBTUg7WUFDUjtZQUNBLE9BQU9MO1FBQ1QsRUFBRSxPQUFPUCxPQUFPO1lBQ2RQLCtDQUFNQSxDQUFDTyxLQUFLLENBQUMsOEJBQThCO2dCQUFFWTtnQkFBT1o7WUFBTTtZQUMxRCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxNQUFNeUUsT0FBTzlELEtBQWEsRUFBRUMsUUFBZ0IsRUFBRSxFQUFrQjtRQUM5RCxJQUFJO1lBQ0YsTUFBTUwsT0FBTyxNQUFNZix1Q0FBRUEsQ0FBQ0ssR0FBRyxDQUFDVyxRQUFRLENBQUM7Z0JBQ2pDVCxPQUFPO29CQUNMSCxNQUFNO3dCQUNKaUIsVUFBVUY7d0JBQ1ZHLE1BQU07b0JBQ1I7Z0JBQ0Y7Z0JBQ0FDLE1BQU1IO2dCQUNOSSxTQUFTO29CQUNQcEIsTUFBTTtnQkFDUjtZQUNGO1lBQ0EsT0FBT1c7UUFDVCxFQUFFLE9BQU9QLE9BQU87WUFDZFAsK0NBQU1BLENBQUNPLEtBQUssQ0FBQyx3QkFBd0I7Z0JBQUVXO2dCQUFPQztnQkFBT1o7WUFBTTtZQUMzRCxNQUFNQTtRQUNSO0lBQ0Y7OzthQTlSVTBFLFlBQVk7O0FBK1J4QjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNQyxnQkFBZ0IsSUFBSWpGLG9CQUFtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdGVteS1uZXh0anMvLi9zcmMvcmVwb3NpdG9yaWVzL3RhZy5yZXBvc2l0b3J5LnRzP2JkZjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGFnIH0gZnJvbSAnLi4vdHlwZXMnXG5pbXBvcnQgeyBCYXNlUmVwb3NpdG9yeSB9IGZyb20gJy4vYmFzZS5yZXBvc2l0b3J5J1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi9saWIvZGInXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi9saWIvbG9nZ2VyJ1xuXG5leHBvcnQgY2xhc3MgVGFnUmVwb3NpdG9yeUltcGwgZXh0ZW5kcyBCYXNlUmVwb3NpdG9yeTxUYWc+IHtcbiAgcHJvdGVjdGVkIHRhYmxlTmFtZSA9ICd0YWcnXG5cbiAgYXN5bmMgZmluZEJ5TmFtZShuYW1lOiBzdHJpbmcpOiBQcm9taXNlPGFueSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdGFnID0gYXdhaXQgZGIudGFnLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBuYW1lIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gdGFnXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyB0YWcgYnkgbmFtZScsIHsgbmFtZSwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmluZE9yQ3JlYXRlKG5hbWU6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhZyA9IGF3YWl0IGRiLnRhZy51cHNlcnQoe1xuICAgICAgICB3aGVyZTogeyBuYW1lIH0sXG4gICAgICAgIHVwZGF0ZToge30sXG4gICAgICAgIGNyZWF0ZTogeyBuYW1lIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gdGFnXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyBvciBjcmVhdGluZyB0YWcnLCB7IG5hbWUsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZpbmRNYW55QnlOYW1lcyhuYW1lczogc3RyaW5nW10pOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhZ3MgPSBhd2FpdCBkYi50YWcuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgIGluOiBuYW1lc1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB0YWdzXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyB0YWdzIGJ5IG5hbWVzJywgeyBuYW1lcywgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2VhcmNoVGFncyhxdWVyeTogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTApOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhZ3MgPSBhd2FpdCBkYi50YWcuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgIGNvbnRhaW5zOiBxdWVyeSxcbiAgICAgICAgICAgIG1vZGU6ICdpbnNlbnNpdGl2ZSdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgbmFtZTogJ2FzYydcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB0YWdzXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igc2VhcmNoaW5nIHRhZ3MnLCB7IHF1ZXJ5LCBsaW1pdCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UG9wdWxhclRhZ3MobGltaXQ6IG51bWJlciA9IDIwKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0YWdzID0gYXdhaXQgZGIudGFnLmZpbmRNYW55KHtcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHZpZGVvczogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgIHZpZGVvczoge1xuICAgICAgICAgICAgX2NvdW50OiAnZGVzYydcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHRhZ3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHBvcHVsYXIgdGFncycsIHsgbGltaXQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFRhZ3NXaXRoVmlkZW9Db3VudCgpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhZ3NXaXRoQ291bnQgPSBhd2FpdCBkYi50YWcuZmluZE1hbnkoe1xuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgdmlkZW9zOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgbmFtZTogJ2FzYydcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHRhZ3NXaXRoQ291bnQubWFwKHRhZyA9PiAoe1xuICAgICAgICAuLi50YWcsXG4gICAgICAgIHZpZGVvQ291bnQ6IHRhZy5fY291bnQudmlkZW9zXG4gICAgICB9KSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHRhZ3Mgd2l0aCB2aWRlbyBjb3VudCcsIHsgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VGFnc0J5VmlkZW9JZCh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHZpZGVvVGFncyA9IGF3YWl0IGRiLnZpZGVvVGFnLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdmlkZW9JZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdGFnOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiB2aWRlb1RhZ3MubWFwKHZ0ID0+IHZ0LnRhZylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHRhZ3MgYnkgdmlkZW8gaWQnLCB7IHZpZGVvSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZU11bHRpcGxlKG5hbWVzOiBzdHJpbmdbXSk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRmlsdGVyIG91dCBleGlzdGluZyB0YWdzXG4gICAgICBjb25zdCBleGlzdGluZ1RhZ3MgPSBhd2FpdCB0aGlzLmZpbmRNYW55QnlOYW1lcyhuYW1lcylcbiAgICAgIGNvbnN0IGV4aXN0aW5nTmFtZXMgPSBleGlzdGluZ1RhZ3MubWFwKHRhZyA9PiB0YWcubmFtZSlcbiAgICAgIGNvbnN0IG5ld05hbWVzID0gbmFtZXMuZmlsdGVyKG5hbWUgPT4gIWV4aXN0aW5nTmFtZXMuaW5jbHVkZXMobmFtZSkpXG5cbiAgICAgIGlmIChuZXdOYW1lcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nVGFnc1xuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgbmV3IHRhZ3NcbiAgICAgIGNvbnN0IG5ld1RhZ3MgPSBhd2FpdCBkYi50YWcuY3JlYXRlTWFueSh7XG4gICAgICAgIGRhdGE6IG5ld05hbWVzLm1hcChuYW1lID0+ICh7IG5hbWUgfSkpLFxuICAgICAgICBza2lwRHVwbGljYXRlczogdHJ1ZVxuICAgICAgfSlcblxuICAgICAgLy8gUmV0dXJuIGFsbCB0YWdzIChleGlzdGluZyArIG5ldylcbiAgICAgIHJldHVybiB0aGlzLmZpbmRNYW55QnlOYW1lcyhuYW1lcylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjcmVhdGluZyBtdWx0aXBsZSB0YWdzJywgeyBuYW1lcywgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VGFnVXNhZ2VTdGF0cyh0YWdJZDogc3RyaW5nKTogUHJvbWlzZTx7XG4gICAgdG90YWxWaWRlb3M6IG51bWJlclxuICAgIHRvdGFsUmF0aW5nczogbnVtYmVyXG4gICAgYXZlcmFnZVJhdGluZzogbnVtYmVyXG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW3ZpZGVvQ291bnQsIHJhdGluZ1N0YXRzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgZGIudmlkZW9UYWcuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7IHRhZ0lkIH1cbiAgICAgICAgfSksXG4gICAgICAgIGRiLnJhdGluZy5hZ2dyZWdhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IHRhZ0lkIH0sXG4gICAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgICBsZXZlbDogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgX2F2Zzoge1xuICAgICAgICAgICAgbGV2ZWw6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICBdKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RhbFZpZGVvczogdmlkZW9Db3VudCxcbiAgICAgICAgdG90YWxSYXRpbmdzOiByYXRpbmdTdGF0cy5fY291bnQubGV2ZWwsXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IHJhdGluZ1N0YXRzLl9hdmcubGV2ZWwgfHwgMFxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdGFnIHVzYWdlIHN0YXRzJywgeyB0YWdJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VHJlbmRpbmdUYWdzKGRheXM6IG51bWJlciA9IDcsIGxpbWl0OiBudW1iZXIgPSAxMCk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0ZVRocmVzaG9sZCA9IG5ldyBEYXRlKClcbiAgICAgIGRhdGVUaHJlc2hvbGQuc2V0RGF0ZShkYXRlVGhyZXNob2xkLmdldERhdGUoKSAtIGRheXMpXG5cbiAgICAgIGNvbnN0IHRyZW5kaW5nVGFncyA9IGF3YWl0IGRiLnRhZy5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB2aWRlb3M6IHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgIHZpZGVvOiB7XG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICBndGU6IGRhdGVUaHJlc2hvbGRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHRhZ3NXaXRoQ291bnRzID0gdHJlbmRpbmdUYWdzXG4gICAgICAgIC5tYXAodGFnID0+ICh7XG4gICAgICAgICAgLi4udGFnLFxuICAgICAgICAgIHJlY2VudFZpZGVvczogdGFnLnZpZGVvcy5sZW5ndGhcbiAgICAgICAgfSkpXG4gICAgICAgIC5maWx0ZXIodGFnID0+IHRhZy5yZWNlbnRWaWRlb3MgPiAwKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5yZWNlbnRWaWRlb3MgLSBhLnJlY2VudFZpZGVvcylcbiAgICAgICAgLnNsaWNlKDAsIGxpbWl0KVxuXG4gICAgICByZXR1cm4gdGFnc1dpdGhDb3VudHNcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHRyZW5kaW5nIHRhZ3MnLCB7IGRheXMsIGxpbWl0LCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBmaW5kQWxsV2l0aENvdW50cygpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhZ3MgPSBhd2FpdCBkYi50YWcuZmluZE1hbnkoe1xuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgdmlkZW9zOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgbmFtZTogJ2FzYydcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB0YWdzXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyBhbGwgdGFncyB3aXRoIGNvdW50cycsIHsgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmluZFBvcHVsYXIobGltaXQ6IG51bWJlciA9IDIwKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0YWdzID0gYXdhaXQgZGIudGFnLmZpbmRNYW55KHtcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHZpZGVvczogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgIHZpZGVvczoge1xuICAgICAgICAgICAgX2NvdW50OiAnZGVzYydcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHRhZ3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBmaW5kaW5nIHBvcHVsYXIgdGFncycsIHsgbGltaXQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNlYXJjaChxdWVyeTogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTApOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRhZ3MgPSBhd2FpdCBkYi50YWcuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgIGNvbnRhaW5zOiBxdWVyeSxcbiAgICAgICAgICAgIG1vZGU6ICdpbnNlbnNpdGl2ZSdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgbmFtZTogJ2FzYydcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB0YWdzXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igc2VhcmNoaW5nIHRhZ3MnLCB7IHF1ZXJ5LCBsaW1pdCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCB0YWdSZXBvc2l0b3J5ID0gbmV3IFRhZ1JlcG9zaXRvcnlJbXBsKCkiXSwibmFtZXMiOlsiQmFzZVJlcG9zaXRvcnkiLCJkYiIsImxvZ2dlciIsIlRhZ1JlcG9zaXRvcnlJbXBsIiwiZmluZEJ5TmFtZSIsIm5hbWUiLCJ0YWciLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJlcnJvciIsImZpbmRPckNyZWF0ZSIsInVwc2VydCIsInVwZGF0ZSIsImNyZWF0ZSIsImZpbmRNYW55QnlOYW1lcyIsIm5hbWVzIiwidGFncyIsImZpbmRNYW55IiwiaW4iLCJzZWFyY2hUYWdzIiwicXVlcnkiLCJsaW1pdCIsImNvbnRhaW5zIiwibW9kZSIsInRha2UiLCJvcmRlckJ5IiwiZ2V0UG9wdWxhclRhZ3MiLCJpbmNsdWRlIiwiX2NvdW50Iiwic2VsZWN0IiwidmlkZW9zIiwiZ2V0VGFnc1dpdGhWaWRlb0NvdW50IiwidGFnc1dpdGhDb3VudCIsIm1hcCIsInZpZGVvQ291bnQiLCJnZXRUYWdzQnlWaWRlb0lkIiwidmlkZW9JZCIsInZpZGVvVGFncyIsInZpZGVvVGFnIiwidnQiLCJjcmVhdGVNdWx0aXBsZSIsImV4aXN0aW5nVGFncyIsImV4aXN0aW5nTmFtZXMiLCJuZXdOYW1lcyIsImZpbHRlciIsImluY2x1ZGVzIiwibGVuZ3RoIiwibmV3VGFncyIsImNyZWF0ZU1hbnkiLCJkYXRhIiwic2tpcER1cGxpY2F0ZXMiLCJnZXRUYWdVc2FnZVN0YXRzIiwidGFnSWQiLCJyYXRpbmdTdGF0cyIsIlByb21pc2UiLCJhbGwiLCJjb3VudCIsInJhdGluZyIsImFnZ3JlZ2F0ZSIsImxldmVsIiwiX2F2ZyIsInRvdGFsVmlkZW9zIiwidG90YWxSYXRpbmdzIiwiYXZlcmFnZVJhdGluZyIsImdldFRyZW5kaW5nVGFncyIsImRheXMiLCJkYXRlVGhyZXNob2xkIiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwidHJlbmRpbmdUYWdzIiwidmlkZW8iLCJjcmVhdGVkQXQiLCJndGUiLCJ0YWdzV2l0aENvdW50cyIsInJlY2VudFZpZGVvcyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwiZmluZEFsbFdpdGhDb3VudHMiLCJmaW5kUG9wdWxhciIsInNlYXJjaCIsInRhYmxlTmFtZSIsInRhZ1JlcG9zaXRvcnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/repositories/tag.repository.ts\n");

/***/ }),

/***/ "(api)/./src/repositories/user.repository.ts":
/*!*********************************************!*\
  !*** ./src/repositories/user.repository.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UserRepositoryImpl: () => (/* binding */ UserRepositoryImpl),\n/* harmony export */   userRepository: () => (/* binding */ userRepository)\n/* harmony export */ });\n/* harmony import */ var _base_repository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.repository */ \"(api)/./src/repositories/base.repository.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n\n\n\nclass UserRepositoryImpl extends _base_repository__WEBPACK_IMPORTED_MODULE_0__.BaseRepository {\n    async findByEmail(email) {\n        try {\n            const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findUnique({\n                where: {\n                    email\n                }\n            });\n            return user;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding user by email\", {\n                email,\n                error\n            });\n            throw error;\n        }\n    }\n    async findByEmailWithPassword(email) {\n        try {\n            const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findUnique({\n                where: {\n                    email\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    emailVerified: true,\n                    image: true,\n                    username: true,\n                    firstName: true,\n                    lastName: true,\n                    password: true,\n                    avatar: true,\n                    city: true,\n                    birthDay: true,\n                    gender: true,\n                    createdAt: true,\n                    updatedAt: true\n                }\n            });\n            return user;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding user by email with password\", {\n                email,\n                error\n            });\n            throw error;\n        }\n    }\n    async findByUsername(username) {\n        try {\n            const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findUnique({\n                where: {\n                    username\n                }\n            });\n            return user;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding user by username\", {\n                username,\n                error\n            });\n            throw error;\n        }\n    }\n    async findByEmailOrUsername(email, username) {\n        try {\n            const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findFirst({\n                where: {\n                    OR: [\n                        {\n                            email\n                        },\n                        {\n                            username\n                        }\n                    ]\n                }\n            });\n            return user;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding user by email or username\", {\n                email,\n                username,\n                error\n            });\n            throw error;\n        }\n    }\n    async findFollowers(userId) {\n        try {\n            const followers = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findMany({\n                where: {\n                    following: {\n                        some: {\n                            followingId: userId\n                        }\n                    }\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    emailVerified: true,\n                    image: true,\n                    username: true,\n                    firstName: true,\n                    lastName: true,\n                    password: true,\n                    avatar: true,\n                    city: true,\n                    birthDay: true,\n                    gender: true,\n                    createdAt: true,\n                    updatedAt: true\n                }\n            });\n            return followers;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding followers\", {\n                userId,\n                error\n            });\n            throw error;\n        }\n    }\n    async findFollowing(userId) {\n        try {\n            const following = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findMany({\n                where: {\n                    followers: {\n                        some: {\n                            followerId: userId\n                        }\n                    }\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    emailVerified: true,\n                    image: true,\n                    username: true,\n                    firstName: true,\n                    lastName: true,\n                    password: true,\n                    avatar: true,\n                    city: true,\n                    birthDay: true,\n                    gender: true,\n                    createdAt: true,\n                    updatedAt: true\n                }\n            });\n            return following;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding following\", {\n                userId,\n                error\n            });\n            throw error;\n        }\n    }\n    async isFollowing(followerId, followingId) {\n        try {\n            const follow = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.follow.findUnique({\n                where: {\n                    followerId_followingId: {\n                        followerId,\n                        followingId\n                    }\n                }\n            });\n            return !!follow;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error checking if user is following\", {\n                followerId,\n                followingId,\n                error\n            });\n            throw error;\n        }\n    }\n    async follow(followerId, followingId) {\n        try {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.follow.create({\n                data: {\n                    followerId,\n                    followingId\n                }\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"User followed\", {\n                followerId,\n                followingId\n            });\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error following user\", {\n                followerId,\n                followingId,\n                error\n            });\n            throw error;\n        }\n    }\n    async unfollow(followerId, followingId) {\n        try {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.follow.delete({\n                where: {\n                    followerId_followingId: {\n                        followerId,\n                        followingId\n                    }\n                }\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"User unfollowed\", {\n                followerId,\n                followingId\n            });\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error unfollowing user\", {\n                followerId,\n                followingId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getFollowCounts(userId) {\n        try {\n            const [followers, following] = await Promise.all([\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.follow.count({\n                    where: {\n                        followingId: userId\n                    }\n                }),\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.follow.count({\n                    where: {\n                        followerId: userId\n                    }\n                })\n            ]);\n            return {\n                followers,\n                following\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting follow counts\", {\n                userId,\n                error\n            });\n            throw error;\n        }\n    }\n    async findWithStats(id) {\n        try {\n            const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findUnique({\n                where: {\n                    id\n                },\n                include: {\n                    _count: {\n                        select: {\n                            followers: true,\n                            following: true,\n                            videos: true\n                        }\n                    }\n                }\n            });\n            return user;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding user with stats\", {\n                id,\n                error\n            });\n            throw error;\n        }\n    }\n    async searchUsers(query, limit = 10) {\n        try {\n            const users = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findMany({\n                where: {\n                    OR: [\n                        {\n                            username: {\n                                contains: query,\n                                mode: \"insensitive\"\n                            }\n                        },\n                        {\n                            firstName: {\n                                contains: query,\n                                mode: \"insensitive\"\n                            }\n                        },\n                        {\n                            lastName: {\n                                contains: query,\n                                mode: \"insensitive\"\n                            }\n                        }\n                    ]\n                },\n                take: limit,\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    emailVerified: true,\n                    image: true,\n                    username: true,\n                    firstName: true,\n                    lastName: true,\n                    password: true,\n                    avatar: true,\n                    city: true,\n                    birthDay: true,\n                    gender: true,\n                    createdAt: true,\n                    updatedAt: true\n                }\n            });\n            return users;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error searching users\", {\n                query,\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    constructor(...args){\n        super(...args);\n        this.tableName = \"user\";\n    }\n}\n// Export singleton instance\nconst userRepository = new UserRepositoryImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcmVwb3NpdG9yaWVzL3VzZXIucmVwb3NpdG9yeS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNrRDtBQUNwQjtBQUNRO0FBRS9CLE1BQU1HLDJCQUEyQkgsNERBQWNBO0lBR3BELE1BQU1JLFlBQVlDLEtBQWEsRUFBd0I7UUFDckQsSUFBSTtZQUNGLE1BQU1DLE9BQU8sTUFBTUwsdUNBQUVBLENBQUNLLElBQUksQ0FBQ0MsVUFBVSxDQUFDO2dCQUNwQ0MsT0FBTztvQkFBRUg7Z0JBQU07WUFDakI7WUFDQSxPQUFPQztRQUNULEVBQUUsT0FBT0csT0FBTztZQUNkUCwrQ0FBTUEsQ0FBQ08sS0FBSyxDQUFDLCtCQUErQjtnQkFBRUo7Z0JBQU9JO1lBQU07WUFDM0QsTUFBTUE7UUFDUjtJQUNGO0lBRUEsTUFBTUMsd0JBQXdCTCxLQUFhLEVBQXVCO1FBQ2hFLElBQUk7WUFDRixNQUFNQyxPQUFPLE1BQU1MLHVDQUFFQSxDQUFDSyxJQUFJLENBQUNDLFVBQVUsQ0FBQztnQkFDcENDLE9BQU87b0JBQUVIO2dCQUFNO2dCQUNmTSxRQUFRO29CQUNOQyxJQUFJO29CQUNKQyxNQUFNO29CQUNOUixPQUFPO29CQUNQUyxlQUFlO29CQUNmQyxPQUFPO29CQUNQQyxVQUFVO29CQUNWQyxXQUFXO29CQUNYQyxVQUFVO29CQUNWQyxVQUFVO29CQUNWQyxRQUFRO29CQUNSQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxRQUFRO29CQUNSQyxXQUFXO29CQUNYQyxXQUFXO2dCQUNiO1lBQ0Y7WUFDQSxPQUFPbkI7UUFDVCxFQUFFLE9BQU9HLE9BQU87WUFDZFAsK0NBQU1BLENBQUNPLEtBQUssQ0FBQyw2Q0FBNkM7Z0JBQUVKO2dCQUFPSTtZQUFNO1lBQ3pFLE1BQU1BO1FBQ1I7SUFDRjtJQUVBLE1BQU1pQixlQUFlVixRQUFnQixFQUF3QjtRQUMzRCxJQUFJO1lBQ0YsTUFBTVYsT0FBTyxNQUFNTCx1Q0FBRUEsQ0FBQ0ssSUFBSSxDQUFDQyxVQUFVLENBQUM7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VztvQkFDWEMsV0FBVztnQkFDYjtZQUNGO1lBQ0EsT0FBT2lDO1FBQ1QsRUFBRSxPQUFPakQsT0FBTztZQUNkUCwrQ0FBTUEsQ0FBQ08sS0FBSyxDQUFDLHlCQUF5QjtnQkFBRStDO2dCQUFPQztnQkFBT2hEO1lBQU07WUFDNUQsTUFBTUE7UUFDUjtJQUNGOzs7YUF2UlVxRCxZQUFZOztBQXdSeEI7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUMsaUJBQWlCLElBQUk1RCxxQkFBb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yYXRlbXktbmV4dGpzLy4vc3JjL3JlcG9zaXRvcmllcy91c2VyLnJlcG9zaXRvcnkudHM/YmVlOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVc2VyLCBVc2VyUmVwb3NpdG9yeSB9IGZyb20gJy4uL3R5cGVzJ1xuaW1wb3J0IHsgQmFzZVJlcG9zaXRvcnkgfSBmcm9tICcuL2Jhc2UucmVwb3NpdG9yeSdcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vbGliL2RiJ1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vbGliL2xvZ2dlcidcblxuZXhwb3J0IGNsYXNzIFVzZXJSZXBvc2l0b3J5SW1wbCBleHRlbmRzIEJhc2VSZXBvc2l0b3J5PFVzZXI+IGltcGxlbWVudHMgVXNlclJlcG9zaXRvcnkge1xuICBwcm90ZWN0ZWQgdGFibGVOYW1lID0gJ3VzZXInXG5cbiAgYXN5bmMgZmluZEJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGVtYWlsIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gdXNlclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgdXNlciBieSBlbWFpbCcsIHsgZW1haWwsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZpbmRCeUVtYWlsV2l0aFBhc3N3b3JkKGVtYWlsOiBzdHJpbmcpOiBQcm9taXNlPGFueSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGVtYWlsIH0sXG4gICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICBpbWFnZTogdHJ1ZSxcbiAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgcGFzc3dvcmQ6IHRydWUsXG4gICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgIGNpdHk6IHRydWUsXG4gICAgICAgICAgYmlydGhEYXk6IHRydWUsXG4gICAgICAgICAgZ2VuZGVyOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogdHJ1ZSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB1c2VyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyB1c2VyIGJ5IGVtYWlsIHdpdGggcGFzc3dvcmQnLCB7IGVtYWlsLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBmaW5kQnlVc2VybmFtZSh1c2VybmFtZTogc3RyaW5nKTogUHJvbWlzZTxVc2VyIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgZGIudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcm5hbWUgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB1c2VyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyB1c2VyIGJ5IHVzZXJuYW1lJywgeyB1c2VybmFtZSwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmluZEJ5RW1haWxPclVzZXJuYW1lKGVtYWlsOiBzdHJpbmcsIHVzZXJuYW1lOiBzdHJpbmcpOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBkYi51c2VyLmZpbmRGaXJzdCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgIHsgZW1haWwgfSxcbiAgICAgICAgICAgIHsgdXNlcm5hbWUgfVxuICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiB1c2VyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyB1c2VyIGJ5IGVtYWlsIG9yIHVzZXJuYW1lJywgeyBlbWFpbCwgdXNlcm5hbWUsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZpbmRGb2xsb3dlcnModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXJbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmb2xsb3dlcnMgPSBhd2FpdCBkYi51c2VyLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBmb2xsb3dpbmc6IHtcbiAgICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgICAgZm9sbG93aW5nSWQ6IHVzZXJJZFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIGltYWdlOiB0cnVlLFxuICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICBwYXNzd29yZDogdHJ1ZSxcbiAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgY2l0eTogdHJ1ZSxcbiAgICAgICAgICBiaXJ0aERheTogdHJ1ZSxcbiAgICAgICAgICBnZW5kZXI6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgICAgICAgIHVwZGF0ZWRBdDogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIGZvbGxvd2Vyc1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgZm9sbG93ZXJzJywgeyB1c2VySWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZpbmRGb2xsb3dpbmcodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXJbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmb2xsb3dpbmcgPSBhd2FpdCBkYi51c2VyLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBmb2xsb3dlcnM6IHtcbiAgICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgICAgZm9sbG93ZXJJZDogdXNlcklkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgaW1hZ2U6IHRydWUsXG4gICAgICAgICAgdXNlcm5hbWU6IHRydWUsXG4gICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgIHBhc3N3b3JkOiB0cnVlLFxuICAgICAgICAgIGF2YXRhcjogdHJ1ZSxcbiAgICAgICAgICBjaXR5OiB0cnVlLFxuICAgICAgICAgIGJpcnRoRGF5OiB0cnVlLFxuICAgICAgICAgIGdlbmRlcjogdHJ1ZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXG4gICAgICAgICAgdXBkYXRlZEF0OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gZm9sbG93aW5nXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyBmb2xsb3dpbmcnLCB7IHVzZXJJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaXNGb2xsb3dpbmcoZm9sbG93ZXJJZDogc3RyaW5nLCBmb2xsb3dpbmdJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZvbGxvdyA9IGF3YWl0IGRiLmZvbGxvdy5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBmb2xsb3dlcklkX2ZvbGxvd2luZ0lkOiB7XG4gICAgICAgICAgICBmb2xsb3dlcklkLFxuICAgICAgICAgICAgZm9sbG93aW5nSWRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gISFmb2xsb3dcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjaGVja2luZyBpZiB1c2VyIGlzIGZvbGxvd2luZycsIHsgZm9sbG93ZXJJZCwgZm9sbG93aW5nSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZvbGxvdyhmb2xsb3dlcklkOiBzdHJpbmcsIGZvbGxvd2luZ0lkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZGIuZm9sbG93LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBmb2xsb3dlcklkLFxuICAgICAgICAgIGZvbGxvd2luZ0lkXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBsb2dnZXIuaW5mbygnVXNlciBmb2xsb3dlZCcsIHsgZm9sbG93ZXJJZCwgZm9sbG93aW5nSWQgfSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBmb2xsb3dpbmcgdXNlcicsIHsgZm9sbG93ZXJJZCwgZm9sbG93aW5nSWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVuZm9sbG93KGZvbGxvd2VySWQ6IHN0cmluZywgZm9sbG93aW5nSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkYi5mb2xsb3cuZGVsZXRlKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBmb2xsb3dlcklkX2ZvbGxvd2luZ0lkOiB7XG4gICAgICAgICAgICBmb2xsb3dlcklkLFxuICAgICAgICAgICAgZm9sbG93aW5nSWRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBsb2dnZXIuaW5mbygnVXNlciB1bmZvbGxvd2VkJywgeyBmb2xsb3dlcklkLCBmb2xsb3dpbmdJZCB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHVuZm9sbG93aW5nIHVzZXInLCB7IGZvbGxvd2VySWQsIGZvbGxvd2luZ0lkLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRGb2xsb3dDb3VudHModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHsgZm9sbG93ZXJzOiBudW1iZXI7IGZvbGxvd2luZzogbnVtYmVyIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW2ZvbGxvd2VycywgZm9sbG93aW5nXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgZGIuZm9sbG93LmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyBmb2xsb3dpbmdJZDogdXNlcklkIH1cbiAgICAgICAgfSksXG4gICAgICAgIGRiLmZvbGxvdy5jb3VudCh7XG4gICAgICAgICAgd2hlcmU6IHsgZm9sbG93ZXJJZDogdXNlcklkIH1cbiAgICAgICAgfSlcbiAgICAgIF0pXG5cbiAgICAgIHJldHVybiB7IGZvbGxvd2VycywgZm9sbG93aW5nIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIGZvbGxvdyBjb3VudHMnLCB7IHVzZXJJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmluZFdpdGhTdGF0cyhpZDogc3RyaW5nKTogUHJvbWlzZTwoVXNlciAmIHsgX2NvdW50OiB7IGZvbGxvd2VyczogbnVtYmVyOyBmb2xsb3dpbmc6IG51bWJlcjsgdmlkZW9zOiBudW1iZXIgfSB9KSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBmb2xsb3dlcnM6IHRydWUsXG4gICAgICAgICAgICAgIGZvbGxvd2luZzogdHJ1ZSxcbiAgICAgICAgICAgICAgdmlkZW9zOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHVzZXJcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBmaW5kaW5nIHVzZXIgd2l0aCBzdGF0cycsIHsgaWQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNlYXJjaFVzZXJzKHF1ZXJ5OiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSAxMCk6IFByb21pc2U8VXNlcltdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgZGIudXNlci5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdXNlcm5hbWU6IHtcbiAgICAgICAgICAgICAgICBjb250YWluczogcXVlcnksXG4gICAgICAgICAgICAgICAgbW9kZTogJ2luc2Vuc2l0aXZlJ1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBmaXJzdE5hbWU6IHtcbiAgICAgICAgICAgICAgICBjb250YWluczogcXVlcnksXG4gICAgICAgICAgICAgICAgbW9kZTogJ2luc2Vuc2l0aXZlJ1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsYXN0TmFtZToge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5zOiBxdWVyeSxcbiAgICAgICAgICAgICAgICBtb2RlOiAnaW5zZW5zaXRpdmUnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgaW1hZ2U6IHRydWUsXG4gICAgICAgICAgdXNlcm5hbWU6IHRydWUsXG4gICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgIHBhc3N3b3JkOiB0cnVlLFxuICAgICAgICAgIGF2YXRhcjogdHJ1ZSxcbiAgICAgICAgICBjaXR5OiB0cnVlLFxuICAgICAgICAgIGJpcnRoRGF5OiB0cnVlLFxuICAgICAgICAgIGdlbmRlcjogdHJ1ZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXG4gICAgICAgICAgdXBkYXRlZEF0OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gdXNlcnNcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBzZWFyY2hpbmcgdXNlcnMnLCB7IHF1ZXJ5LCBsaW1pdCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCB1c2VyUmVwb3NpdG9yeSA9IG5ldyBVc2VyUmVwb3NpdG9yeUltcGwoKSJdLCJuYW1lcyI6WyJCYXNlUmVwb3NpdG9yeSIsImRiIiwibG9nZ2VyIiwiVXNlclJlcG9zaXRvcnlJbXBsIiwiZmluZEJ5RW1haWwiLCJlbWFpbCIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJlcnJvciIsImZpbmRCeUVtYWlsV2l0aFBhc3N3b3JkIiwic2VsZWN0IiwiaWQiLCJuYW1lIiwiZW1haWxWZXJpZmllZCIsImltYWdlIiwidXNlcm5hbWUiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInBhc3N3b3JkIiwiYXZhdGFyIiwiY2l0eSIsImJpcnRoRGF5IiwiZ2VuZGVyIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwiZmluZEJ5VXNlcm5hbWUiLCJmaW5kQnlFbWFpbE9yVXNlcm5hbWUiLCJmaW5kRmlyc3QiLCJPUiIsImZpbmRGb2xsb3dlcnMiLCJ1c2VySWQiLCJmb2xsb3dlcnMiLCJmaW5kTWFueSIsImZvbGxvd2luZyIsInNvbWUiLCJmb2xsb3dpbmdJZCIsImZpbmRGb2xsb3dpbmciLCJmb2xsb3dlcklkIiwiaXNGb2xsb3dpbmciLCJmb2xsb3ciLCJmb2xsb3dlcklkX2ZvbGxvd2luZ0lkIiwiY3JlYXRlIiwiZGF0YSIsImluZm8iLCJ1bmZvbGxvdyIsImRlbGV0ZSIsImdldEZvbGxvd0NvdW50cyIsIlByb21pc2UiLCJhbGwiLCJjb3VudCIsImZpbmRXaXRoU3RhdHMiLCJpbmNsdWRlIiwiX2NvdW50IiwidmlkZW9zIiwic2VhcmNoVXNlcnMiLCJxdWVyeSIsImxpbWl0IiwidXNlcnMiLCJjb250YWlucyIsIm1vZGUiLCJ0YWtlIiwidGFibGVOYW1lIiwidXNlclJlcG9zaXRvcnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/repositories/user.repository.ts\n");

/***/ }),

/***/ "(api)/./src/repositories/video.repository.ts":
/*!**********************************************!*\
  !*** ./src/repositories/video.repository.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VideoRepositoryImpl: () => (/* binding */ VideoRepositoryImpl),\n/* harmony export */   videoRepository: () => (/* binding */ videoRepository)\n/* harmony export */ });\n/* harmony import */ var _base_repository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.repository */ \"(api)/./src/repositories/base.repository.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/db */ \"(api)/./src/lib/db.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/constants */ \"(api)/./src/lib/constants.ts\");\n\n\n\n\nclass VideoRepositoryImpl extends _base_repository__WEBPACK_IMPORTED_MODULE_0__.BaseRepository {\n    async findByUserId(userId) {\n        try {\n            const videos = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.findMany({\n                where: {\n                    userId\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tags: {\n                        include: {\n                            tag: true\n                        }\n                    },\n                    ratings: {\n                        include: {\n                            user: {\n                                select: {\n                                    id: true,\n                                    username: true,\n                                    firstName: true,\n                                    lastName: true,\n                                    avatar: true\n                                }\n                            },\n                            tag: true\n                        }\n                    },\n                    _count: {\n                        select: {\n                            ratings: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return videos;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding videos by user id\", {\n                userId,\n                error\n            });\n            throw error;\n        }\n    }\n    async findByTags(tags) {\n        try {\n            const videos = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.findMany({\n                where: {\n                    tags: {\n                        some: {\n                            tag: {\n                                name: {\n                                    in: tags\n                                }\n                            }\n                        }\n                    }\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tags: {\n                        include: {\n                            tag: true\n                        }\n                    },\n                    ratings: {\n                        include: {\n                            user: {\n                                select: {\n                                    id: true,\n                                    username: true,\n                                    firstName: true,\n                                    lastName: true,\n                                    avatar: true\n                                }\n                            },\n                            tag: true\n                        }\n                    },\n                    _count: {\n                        select: {\n                            ratings: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return videos;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding videos by tags\", {\n                tags,\n                error\n            });\n            throw error;\n        }\n    }\n    async search(query, includeNsfw = true) {\n        try {\n            const videos = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.findMany({\n                where: {\n                    AND: [\n                        {\n                            OR: [\n                                {\n                                    title: {\n                                        contains: query,\n                                        mode: \"insensitive\"\n                                    }\n                                },\n                                {\n                                    description: {\n                                        contains: query,\n                                        mode: \"insensitive\"\n                                    }\n                                },\n                                {\n                                    tags: {\n                                        some: {\n                                            tag: {\n                                                name: {\n                                                    contains: query,\n                                                    mode: \"insensitive\"\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            ]\n                        },\n                        ...includeNsfw ? [] : [\n                            {\n                                isNsfw: false\n                            }\n                        ]\n                    ]\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tags: {\n                        include: {\n                            tag: true\n                        }\n                    },\n                    ratings: {\n                        include: {\n                            user: {\n                                select: {\n                                    id: true,\n                                    username: true,\n                                    firstName: true,\n                                    lastName: true,\n                                    avatar: true\n                                }\n                            },\n                            tag: true\n                        }\n                    },\n                    _count: {\n                        select: {\n                            ratings: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return videos;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error searching videos\", {\n                query,\n                error\n            });\n            throw error;\n        }\n    }\n    async findWithRatings(id) {\n        try {\n            const video = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.findUnique({\n                where: {\n                    id\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tags: {\n                        include: {\n                            tag: true\n                        }\n                    },\n                    ratings: {\n                        include: {\n                            user: {\n                                select: {\n                                    id: true,\n                                    username: true,\n                                    firstName: true,\n                                    lastName: true,\n                                    avatar: true\n                                }\n                            },\n                            tag: true\n                        }\n                    },\n                    _count: {\n                        select: {\n                            ratings: true\n                        }\n                    }\n                }\n            });\n            return video;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding video with ratings\", {\n                id,\n                error\n            });\n            throw error;\n        }\n    }\n    async findWithFilters(filters) {\n        try {\n            const { search, tags, tagRatings, includeNsfw = true, userId, sortBy = \"createdAt\", sortOrder = \"desc\", page = 1, limit = _lib_constants__WEBPACK_IMPORTED_MODULE_3__.PAGINATION.DEFAULT_PAGE_SIZE } = filters;\n            const where = {};\n            // Add search filter\n            if (search) {\n                where.OR = [\n                    {\n                        title: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        description: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    }\n                ];\n            }\n            // Add tags filter\n            if (tags && tags.length > 0) {\n                where.tags = {\n                    some: {\n                        tag: {\n                            name: {\n                                in: tags\n                            }\n                        }\n                    }\n                };\n            }\n            // Add user filter\n            if (userId) {\n                where.userId = userId;\n            }\n            // Add NSFW filter\n            if (!includeNsfw) {\n                where.isNsfw = false;\n            }\n            // Add tagRatings filter - we'll filter by having the specified tags first\n            // then post-process to check rating ranges\n            if (tagRatings && tagRatings.length > 0) {\n                const tagNames = tagRatings.map((tr)=>tr.tagName);\n                // Ensure videos have all the specified tags\n                where.tags = {\n                    some: {\n                        tag: {\n                            name: {\n                                in: tagNames\n                            }\n                        }\n                    }\n                };\n            }\n            const skip = (page - 1) * limit;\n            // Build orderBy\n            const orderBy = {};\n            if (sortBy === \"ratings\") {\n                orderBy._count = {\n                    ratings: sortOrder\n                };\n            } else {\n                orderBy[sortBy] = sortOrder;\n            }\n            let [videos, total] = await Promise.all([\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.findMany({\n                    where,\n                    include: {\n                        user: {\n                            select: {\n                                id: true,\n                                username: true,\n                                firstName: true,\n                                lastName: true,\n                                avatar: true\n                            }\n                        },\n                        tags: {\n                            include: {\n                                tag: true\n                            }\n                        },\n                        ratings: {\n                            include: {\n                                user: {\n                                    select: {\n                                        id: true,\n                                        username: true,\n                                        firstName: true,\n                                        lastName: true,\n                                        avatar: true\n                                    }\n                                },\n                                tag: true\n                            }\n                        },\n                        _count: {\n                            select: {\n                                ratings: true\n                            }\n                        }\n                    },\n                    orderBy,\n                    skip,\n                    take: limit * 2\n                }),\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.count({\n                    where\n                })\n            ]);\n            // Apply tagRatings filter in post-processing\n            if (tagRatings && tagRatings.length > 0) {\n                videos = videos.filter((video)=>{\n                    // Check if video has all required tags with ratings in the specified ranges\n                    return tagRatings.every(({ tagName, minRating, maxRating })=>{\n                        // Find the tag in the video\n                        const videoTag = video.tags.find((vt)=>vt.tag.name === tagName);\n                        if (!videoTag) return false;\n                        // Calculate average rating for this tag on this video\n                        const tagRatings = video.ratings.filter((r)=>r.tag.name === tagName);\n                        if (tagRatings.length === 0) return false;\n                        const averageRating = tagRatings.reduce((sum, r)=>sum + r.level, 0) / tagRatings.length;\n                        // Check if average rating is within the specified range\n                        return averageRating >= minRating && averageRating <= maxRating;\n                    });\n                });\n                // Update total count after filtering\n                total = videos.length;\n                // Apply pagination after filtering\n                videos = videos.slice(0, limit);\n            }\n            const totalPages = Math.ceil(total / limit);\n            return {\n                videos,\n                total,\n                totalPages\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error finding videos with filters\", {\n                filters,\n                error\n            });\n            throw error;\n        }\n    }\n    async createWithTags(videoData, tagNames) {\n        try {\n            const video = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.create({\n                data: {\n                    ...videoData,\n                    tags: {\n                        create: tagNames.map((tagName)=>({\n                                tag: {\n                                    connectOrCreate: {\n                                        where: {\n                                            name: tagName\n                                        },\n                                        create: {\n                                            name: tagName\n                                        }\n                                    }\n                                }\n                            }))\n                    }\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tags: {\n                        include: {\n                            tag: true\n                        }\n                    },\n                    _count: {\n                        select: {\n                            ratings: true\n                        }\n                    }\n                }\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Created video with tags\", {\n                videoId: video.id,\n                tagNames\n            });\n            return video;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error creating video with tags\", {\n                videoData,\n                tagNames,\n                error\n            });\n            throw error;\n        }\n    }\n    async getVideoStats(videoId) {\n        try {\n            const [totalRatings, ratingsByTag] = await Promise.all([\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.count({\n                    where: {\n                        videoId\n                    }\n                }),\n                _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.rating.groupBy({\n                    by: [\n                        \"tagId\"\n                    ],\n                    where: {\n                        videoId\n                    },\n                    _avg: {\n                        level: true\n                    },\n                    _count: {\n                        level: true\n                    }\n                })\n            ]);\n            // Get tag names\n            const tagIds = ratingsByTag.map((r)=>r.tagId);\n            const tags = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.tag.findMany({\n                where: {\n                    id: {\n                        in: tagIds\n                    }\n                }\n            });\n            const tagMap = tags.reduce((acc, tag)=>{\n                acc[tag.id] = tag.name;\n                return acc;\n            }, {});\n            const averageRatingByTag = ratingsByTag.map((rating)=>({\n                    tagName: tagMap[rating.tagId] || \"Unknown\",\n                    averageRating: rating._avg.level || 0,\n                    count: rating._count.level\n                }));\n            return {\n                totalRatings,\n                averageRatingByTag\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting video stats\", {\n                videoId,\n                error\n            });\n            throw error;\n        }\n    }\n    async getTrendingVideos(limit = 10) {\n        try {\n            // Get videos with most ratings in the last 7 days\n            const sevenDaysAgo = new Date();\n            sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\n            const videos = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.video.findMany({\n                where: {\n                    createdAt: {\n                        gte: sevenDaysAgo\n                    }\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            username: true,\n                            firstName: true,\n                            lastName: true,\n                            avatar: true\n                        }\n                    },\n                    tags: {\n                        include: {\n                            tag: true\n                        }\n                    },\n                    _count: {\n                        select: {\n                            ratings: true\n                        }\n                    }\n                },\n                orderBy: {\n                    ratings: {\n                        _count: \"desc\"\n                    }\n                },\n                take: limit\n            });\n            return videos;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error getting trending videos\", {\n                limit,\n                error\n            });\n            throw error;\n        }\n    }\n    async addTagToVideo(videoId, tagId) {\n        try {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.videoTag.create({\n                data: {\n                    videoId,\n                    tagId\n                }\n            });\n        } catch (error) {\n            // Handle duplicate key error (tag already exists on video)\n            if (error instanceof Error && error.message.includes(\"Unique constraint\")) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Tag already exists on video\", {\n                    videoId,\n                    tagId\n                });\n                return;\n            }\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error adding tag to video\", {\n                videoId,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    async removeTagFromVideo(videoId, tagId) {\n        try {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.videoTag.deleteMany({\n                where: {\n                    videoId,\n                    tagId\n                }\n            });\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Error removing tag from video\", {\n                videoId,\n                tagId,\n                error\n            });\n            throw error;\n        }\n    }\n    constructor(...args){\n        super(...args);\n        this.tableName = \"video\";\n    }\n}\n// Export singleton instance\nconst videoRepository = new VideoRepositoryImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcmVwb3NpdG9yaWVzL3ZpZGVvLnJlcG9zaXRvcnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ2tEO0FBQ3BCO0FBQ1E7QUFDTztBQUV0QyxNQUFNSSw0QkFBNEJKLDREQUFjQTtJQUdyRCxNQUFNSyxhQUFhQyxNQUFjLEVBQWtCO1FBQ2pELElBQUk7WUFDRixNQUFNQyxTQUFTLE1BQU1OLHVDQUFFQSxDQUFDTyxLQUFLLENBQUNDLFFBQVEsQ0FBQztnQkFDckNDLE9BQU87b0JBQUVKO2dCQUFPO2dCQUNoQkssU0FBUztvQkFDUEMsTUFBTTt3QkFDSkMsUUFBUTs0QkFDTkMsSUFBSTs0QkFDSkMsVUFBVTs0QkFDVkMsV0FBVzs0QkFDWEMsVUFBVTs0QkFDVkMsUUFBUTt3QkFDVjtvQkFDRjtvQkFDQUMsTUFBTTt3QkFDSlIsU0FBUzs0QkFDUFMsS0FBSzt3QkFDUDtvQkFDRjtvQkFDQUMsU0FBUzt3QkFDUFYsU0FBUzs0QkFDUEMsTUFBTTtnQ0FDSkMsUUFBUTtvQ0FDTkMsSUFBSTtvQ0FDSkMsVUFBVTtvQ0FDVkMsV0FBVztvQ0FDWEMsVUFBVTtvQ0FDVkMsUUFBUTtnQ0FDVjs0QkFDRjs0QkFDQUUsS0FBSzt3QkFDUDtvQkFDRjtvQkFDQUUsUUFBUTt3QkFDTlQsUUFBUTs0QkFDTlEsU0FBUzt3QkFDWDtvQkFDRjtnQkFDRjtnQkFDQUUsU0FBUztvQkFDUEMsV0FBVztnQkFDYjtZQUNGO1lBQ0EsT0FBT2pCO1FBQ1QsRUFBRSxPQUFPa0IsT0FBTztZQUNkdkIsK0NBQU1BLENBQUN1QixLQUFLLENBQUMsbUNBQW1DO2dCQUFFbkI7Z0JBQVFtQjtZQUFNO1lBQ2hFLE1BQU1BO1FBQ1I7SUFDRjtJQUVBLE1BQU1DLFdBQVdQLElBQWMsRUFBa0I7UUFDL0MsSUFBSTtZQUNGLE1BQU1aLFNBQVMsTUFBTU4sdUNBQUVBLENBQUNPLEtBQUssQ0FBQ0MsUUFBUSxDQUFDO2dCQUNyQ0MsT0FBTztvQkFDTFMsTUFBTTt3QkFDSlEsTUFBTTs0QkFD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QUFFLE9BQU9uRSxPQUFPO1lBQ2QsMkRBQTJEO1lBQzNELElBQUlBLGlCQUFpQjhFLFNBQVM5RSxNQUFNK0UsT0FBTyxDQUFDQyxRQUFRLENBQUMsc0JBQXNCO2dCQUN6RXZHLCtDQUFNQSxDQUFDZ0YsSUFBSSxDQUFDLCtCQUErQjtvQkFBRUM7b0JBQVNTO2dCQUFNO2dCQUM1RDtZQUNGO1lBQ0ExRiwrQ0FBTUEsQ0FBQ3VCLEtBQUssQ0FBQyw2QkFBNkI7Z0JBQUUwRDtnQkFBU1M7Z0JBQU9uRTtZQUFNO1lBQ2xFLE1BQU1BO1FBQ1I7SUFDRjtJQUVBLE1BQU1pRixtQkFBbUJ2QixPQUFlLEVBQUVTLEtBQWEsRUFBaUI7UUFDdEUsSUFBSTtZQUNGLE1BQU0zRix1Q0FBRUEsQ0FBQ2dFLFFBQVEsQ0FBQzBDLFVBQVUsQ0FBQztnQkFDM0JqRyxPQUFPO29CQUNMeUU7b0JBQ0FTO2dCQUNGO1lBQ0Y7UUFDRixFQUFFLE9BQU9uRSxPQUFPO1lBQ2R2QiwrQ0FBTUEsQ0FBQ3VCLEtBQUssQ0FBQyxpQ0FBaUM7Z0JBQUUwRDtnQkFBU1M7Z0JBQU9uRTtZQUFNO1lBQ3RFLE1BQU1BO1FBQ1I7SUFDRjs7O2FBcGxCVW1GLFlBQVk7O0FBcWxCeEI7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUMsa0JBQWtCLElBQUl6RyxzQkFBcUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yYXRlbXktbmV4dGpzLy4vc3JjL3JlcG9zaXRvcmllcy92aWRlby5yZXBvc2l0b3J5LnRzPzQ0MDIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVmlkZW8sIFZpZGVvUmVwb3NpdG9yeSwgVmlkZW9GaWx0ZXJzIH0gZnJvbSAnLi4vdHlwZXMnXG5pbXBvcnQgeyBCYXNlUmVwb3NpdG9yeSB9IGZyb20gJy4vYmFzZS5yZXBvc2l0b3J5J1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi9saWIvZGInXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi9saWIvbG9nZ2VyJ1xuaW1wb3J0IHsgUEFHSU5BVElPTiB9IGZyb20gJy4uL2xpYi9jb25zdGFudHMnXG5cbmV4cG9ydCBjbGFzcyBWaWRlb1JlcG9zaXRvcnlJbXBsIGV4dGVuZHMgQmFzZVJlcG9zaXRvcnk8VmlkZW8+IGltcGxlbWVudHMgVmlkZW9SZXBvc2l0b3J5IHtcbiAgcHJvdGVjdGVkIHRhYmxlTmFtZSA9ICd2aWRlbydcblxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHZpZGVvcyA9IGF3YWl0IGRiLnZpZGVvLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0YWdzOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmF0aW5nczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHJhdGluZ3M6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHZpZGVvc1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgdmlkZW9zIGJ5IHVzZXIgaWQnLCB7IHVzZXJJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmluZEJ5VGFncyh0YWdzOiBzdHJpbmdbXSk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdmlkZW9zID0gYXdhaXQgZGIudmlkZW8uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIHRhZ3M6IHtcbiAgICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgICAgdGFnOiB7XG4gICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgaW46IHRhZ3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0YWdzOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmF0aW5nczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHJhdGluZ3M6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHZpZGVvc1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgdmlkZW9zIGJ5IHRhZ3MnLCB7IHRhZ3MsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNlYXJjaChxdWVyeTogc3RyaW5nLCBpbmNsdWRlTnNmdzogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHZpZGVvcyA9IGF3YWl0IGRiLnZpZGVvLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBBTkQ6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICB0aXRsZToge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluczogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgIG1vZGU6ICdpbnNlbnNpdGl2ZSdcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5zOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgbW9kZTogJ2luc2Vuc2l0aXZlJ1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgdGFnczoge1xuICAgICAgICAgICAgICAgICAgICBzb21lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGFnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5zOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogJ2luc2Vuc2l0aXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC4uLihpbmNsdWRlTnNmdyA/IFtdIDogW3sgaXNOc2Z3OiBmYWxzZSB9XSlcbiAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0YWdzOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmF0aW5nczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBhdmF0YXI6IHRydWUsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHJhdGluZ3M6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHZpZGVvc1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHNlYXJjaGluZyB2aWRlb3MnLCB7IHF1ZXJ5LCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBmaW5kV2l0aFJhdGluZ3MoaWQ6IHN0cmluZyk6IFByb21pc2U8YW55IHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2aWRlbyA9IGF3YWl0IGRiLnZpZGVvLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHJhdGluZ3M6IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdGFnOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICByYXRpbmdzOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHZpZGVvXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZmluZGluZyB2aWRlbyB3aXRoIHJhdGluZ3MnLCB7IGlkLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBmaW5kV2l0aEZpbHRlcnMoZmlsdGVyczogVmlkZW9GaWx0ZXJzKTogUHJvbWlzZTx7XG4gICAgdmlkZW9zOiBhbnlbXVxuICAgIHRvdGFsOiBudW1iZXJcbiAgICB0b3RhbFBhZ2VzOiBudW1iZXJcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHNlYXJjaCxcbiAgICAgICAgdGFncyxcbiAgICAgICAgdGFnUmF0aW5ncyxcbiAgICAgICAgaW5jbHVkZU5zZncgPSB0cnVlLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHNvcnRCeSA9ICdjcmVhdGVkQXQnLFxuICAgICAgICBzb3J0T3JkZXIgPSAnZGVzYycsXG4gICAgICAgIHBhZ2UgPSAxLFxuICAgICAgICBsaW1pdCA9IFBBR0lOQVRJT04uREVGQVVMVF9QQUdFX1NJWkVcbiAgICAgIH0gPSBmaWx0ZXJzXG5cbiAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7fVxuXG4gICAgICAvLyBBZGQgc2VhcmNoIGZpbHRlclxuICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICB3aGVyZS5PUiA9IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aXRsZToge1xuICAgICAgICAgICAgICBjb250YWluczogc2VhcmNoLFxuICAgICAgICAgICAgICBtb2RlOiAnaW5zZW5zaXRpdmUnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjoge1xuICAgICAgICAgICAgICBjb250YWluczogc2VhcmNoLFxuICAgICAgICAgICAgICBtb2RlOiAnaW5zZW5zaXRpdmUnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCB0YWdzIGZpbHRlclxuICAgICAgaWYgKHRhZ3MgJiYgdGFncy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHdoZXJlLnRhZ3MgPSB7XG4gICAgICAgICAgc29tZToge1xuICAgICAgICAgICAgdGFnOiB7XG4gICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICBpbjogdGFnc1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCB1c2VyIGZpbHRlclxuICAgICAgaWYgKHVzZXJJZCkge1xuICAgICAgICB3aGVyZS51c2VySWQgPSB1c2VySWRcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIE5TRlcgZmlsdGVyXG4gICAgICBpZiAoIWluY2x1ZGVOc2Z3KSB7XG4gICAgICAgIHdoZXJlLmlzTnNmdyA9IGZhbHNlXG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCB0YWdSYXRpbmdzIGZpbHRlciAtIHdlJ2xsIGZpbHRlciBieSBoYXZpbmcgdGhlIHNwZWNpZmllZCB0YWdzIGZpcnN0XG4gICAgICAvLyB0aGVuIHBvc3QtcHJvY2VzcyB0byBjaGVjayByYXRpbmcgcmFuZ2VzXG4gICAgICBpZiAodGFnUmF0aW5ncyAmJiB0YWdSYXRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgdGFnTmFtZXMgPSB0YWdSYXRpbmdzLm1hcCh0ciA9PiB0ci50YWdOYW1lKVxuICAgICAgICAvLyBFbnN1cmUgdmlkZW9zIGhhdmUgYWxsIHRoZSBzcGVjaWZpZWQgdGFnc1xuICAgICAgICB3aGVyZS50YWdzID0ge1xuICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgIHRhZzoge1xuICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgaW46IHRhZ05hbWVzXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBsaW1pdFxuXG4gICAgICAvLyBCdWlsZCBvcmRlckJ5XG4gICAgICBjb25zdCBvcmRlckJ5OiBhbnkgPSB7fVxuICAgICAgaWYgKHNvcnRCeSA9PT0gJ3JhdGluZ3MnKSB7XG4gICAgICAgIG9yZGVyQnkuX2NvdW50ID0ge1xuICAgICAgICAgIHJhdGluZ3M6IHNvcnRPcmRlclxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvcmRlckJ5W3NvcnRCeV0gPSBzb3J0T3JkZXJcbiAgICAgIH1cblxuICAgICAgbGV0IFt2aWRlb3MsIHRvdGFsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgZGIudmlkZW8uZmluZE1hbnkoe1xuICAgICAgICAgIHdoZXJlLFxuICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgIGF2YXRhcjogdHJ1ZSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRhZ3M6IHtcbiAgICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIHRhZzogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmF0aW5nczoge1xuICAgICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGFnOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgcmF0aW5nczogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcmRlckJ5LFxuICAgICAgICAgIHNraXAsXG4gICAgICAgICAgdGFrZTogbGltaXQgKiAyLCAvLyBGZXRjaCBtb3JlIHRvIGFjY291bnQgZm9yIGZpbHRlcmluZ1xuICAgICAgICB9KSxcbiAgICAgICAgZGIudmlkZW8uY291bnQoeyB3aGVyZSB9KVxuICAgICAgXSlcblxuICAgICAgLy8gQXBwbHkgdGFnUmF0aW5ncyBmaWx0ZXIgaW4gcG9zdC1wcm9jZXNzaW5nXG4gICAgICBpZiAodGFnUmF0aW5ncyAmJiB0YWdSYXRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmlkZW9zID0gdmlkZW9zLmZpbHRlcih2aWRlbyA9PiB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdmlkZW8gaGFzIGFsbCByZXF1aXJlZCB0YWdzIHdpdGggcmF0aW5ncyBpbiB0aGUgc3BlY2lmaWVkIHJhbmdlc1xuICAgICAgICAgIHJldHVybiB0YWdSYXRpbmdzLmV2ZXJ5KCh7IHRhZ05hbWUsIG1pblJhdGluZywgbWF4UmF0aW5nIH0pID0+IHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIHRhZyBpbiB0aGUgdmlkZW9cbiAgICAgICAgICAgIGNvbnN0IHZpZGVvVGFnID0gdmlkZW8udGFncy5maW5kKHZ0ID0+IHZ0LnRhZy5uYW1lID09PSB0YWdOYW1lKVxuICAgICAgICAgICAgaWYgKCF2aWRlb1RhZykgcmV0dXJuIGZhbHNlXG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBhdmVyYWdlIHJhdGluZyBmb3IgdGhpcyB0YWcgb24gdGhpcyB2aWRlb1xuICAgICAgICAgICAgY29uc3QgdGFnUmF0aW5ncyA9IHZpZGVvLnJhdGluZ3MuZmlsdGVyKHIgPT4gci50YWcubmFtZSA9PT0gdGFnTmFtZSlcbiAgICAgICAgICAgIGlmICh0YWdSYXRpbmdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlXG5cbiAgICAgICAgICAgIGNvbnN0IGF2ZXJhZ2VSYXRpbmcgPSB0YWdSYXRpbmdzLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLmxldmVsLCAwKSAvIHRhZ1JhdGluZ3MubGVuZ3RoXG5cbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGF2ZXJhZ2UgcmF0aW5nIGlzIHdpdGhpbiB0aGUgc3BlY2lmaWVkIHJhbmdlXG4gICAgICAgICAgICByZXR1cm4gYXZlcmFnZVJhdGluZyA+PSBtaW5SYXRpbmcgJiYgYXZlcmFnZVJhdGluZyA8PSBtYXhSYXRpbmdcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIFVwZGF0ZSB0b3RhbCBjb3VudCBhZnRlciBmaWx0ZXJpbmdcbiAgICAgICAgdG90YWwgPSB2aWRlb3MubGVuZ3RoXG4gICAgICAgIFxuICAgICAgICAvLyBBcHBseSBwYWdpbmF0aW9uIGFmdGVyIGZpbHRlcmluZ1xuICAgICAgICB2aWRlb3MgPSB2aWRlb3Muc2xpY2UoMCwgbGltaXQpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWwgLyBsaW1pdClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmlkZW9zLFxuICAgICAgICB0b3RhbCxcbiAgICAgICAgdG90YWxQYWdlc1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgdmlkZW9zIHdpdGggZmlsdGVycycsIHsgZmlsdGVycywgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY3JlYXRlV2l0aFRhZ3MoXG4gICAgdmlkZW9EYXRhOiBPbWl0PFZpZGVvLCAnaWQnIHwgJ2NyZWF0ZWRBdCcgfCAndXBkYXRlZEF0JyB8ICd1c2VyJyB8ICd0YWdzJyB8ICdyYXRpbmdzJz4sXG4gICAgdGFnTmFtZXM6IHN0cmluZ1tdXG4gICk6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHZpZGVvID0gYXdhaXQgZGIudmlkZW8uY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIC4uLnZpZGVvRGF0YSxcbiAgICAgICAgICB0YWdzOiB7XG4gICAgICAgICAgICBjcmVhdGU6IHRhZ05hbWVzLm1hcCh0YWdOYW1lID0+ICh7XG4gICAgICAgICAgICAgIHRhZzoge1xuICAgICAgICAgICAgICAgIGNvbm5lY3RPckNyZWF0ZToge1xuICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgbmFtZTogdGFnTmFtZSB9LFxuICAgICAgICAgICAgICAgICAgY3JlYXRlOiB7IG5hbWU6IHRhZ05hbWUgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHJhdGluZ3M6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGxvZ2dlci5pbmZvKCdDcmVhdGVkIHZpZGVvIHdpdGggdGFncycsIHsgdmlkZW9JZDogdmlkZW8uaWQsIHRhZ05hbWVzIH0pXG4gICAgICByZXR1cm4gdmlkZW9cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjcmVhdGluZyB2aWRlbyB3aXRoIHRhZ3MnLCB7IHZpZGVvRGF0YSwgdGFnTmFtZXMsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFZpZGVvU3RhdHModmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTx7XG4gICAgdG90YWxSYXRpbmdzOiBudW1iZXJcbiAgICBhdmVyYWdlUmF0aW5nQnlUYWc6IEFycmF5PHsgdGFnTmFtZTogc3RyaW5nOyBhdmVyYWdlUmF0aW5nOiBudW1iZXI7IGNvdW50OiBudW1iZXIgfT5cbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBbdG90YWxSYXRpbmdzLCByYXRpbmdzQnlUYWddID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBkYi5yYXRpbmcuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7IHZpZGVvSWQgfVxuICAgICAgICB9KSxcbiAgICAgICAgZGIucmF0aW5nLmdyb3VwQnkoe1xuICAgICAgICAgIGJ5OiBbJ3RhZ0lkJ10sXG4gICAgICAgICAgd2hlcmU6IHsgdmlkZW9JZCB9LFxuICAgICAgICAgIF9hdmc6IHtcbiAgICAgICAgICAgIGxldmVsOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgIGxldmVsOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgXSlcblxuICAgICAgLy8gR2V0IHRhZyBuYW1lc1xuICAgICAgY29uc3QgdGFnSWRzID0gcmF0aW5nc0J5VGFnLm1hcChyID0+IHIudGFnSWQpXG4gICAgICBjb25zdCB0YWdzID0gYXdhaXQgZGIudGFnLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgaW46IHRhZ0lkc1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgY29uc3QgdGFnTWFwID0gdGFncy5yZWR1Y2UoKGFjYywgdGFnKSA9PiB7XG4gICAgICAgIGFjY1t0YWcuaWRdID0gdGFnLm5hbWVcbiAgICAgICAgcmV0dXJuIGFjY1xuICAgICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPilcblxuICAgICAgY29uc3QgYXZlcmFnZVJhdGluZ0J5VGFnID0gcmF0aW5nc0J5VGFnLm1hcChyYXRpbmcgPT4gKHtcbiAgICAgICAgdGFnTmFtZTogdGFnTWFwW3JhdGluZy50YWdJZF0gfHwgJ1Vua25vd24nLFxuICAgICAgICBhdmVyYWdlUmF0aW5nOiByYXRpbmcuX2F2Zy5sZXZlbCB8fCAwLFxuICAgICAgICBjb3VudDogcmF0aW5nLl9jb3VudC5sZXZlbFxuICAgICAgfSkpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsUmF0aW5ncyxcbiAgICAgICAgYXZlcmFnZVJhdGluZ0J5VGFnXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyB2aWRlbyBzdGF0cycsIHsgdmlkZW9JZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VHJlbmRpbmdWaWRlb3MobGltaXQ6IG51bWJlciA9IDEwKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdmlkZW9zIHdpdGggbW9zdCByYXRpbmdzIGluIHRoZSBsYXN0IDcgZGF5c1xuICAgICAgY29uc3Qgc2V2ZW5EYXlzQWdvID0gbmV3IERhdGUoKVxuICAgICAgc2V2ZW5EYXlzQWdvLnNldERhdGUoc2V2ZW5EYXlzQWdvLmdldERhdGUoKSAtIDcpXG5cbiAgICAgIGNvbnN0IHZpZGVvcyA9IGF3YWl0IGRiLnZpZGVvLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgIGd0ZTogc2V2ZW5EYXlzQWdvXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICB0YWc6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIF9jb3VudDoge1xuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIHJhdGluZ3M6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHtcbiAgICAgICAgICByYXRpbmdzOiB7XG4gICAgICAgICAgICBfY291bnQ6ICdkZXNjJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGFrZTogbGltaXRcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiB2aWRlb3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHRyZW5kaW5nIHZpZGVvcycsIHsgbGltaXQsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGFkZFRhZ1RvVmlkZW8odmlkZW9JZDogc3RyaW5nLCB0YWdJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGRiLnZpZGVvVGFnLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB2aWRlb0lkLFxuICAgICAgICAgIHRhZ0lkXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEhhbmRsZSBkdXBsaWNhdGUga2V5IGVycm9yICh0YWcgYWxyZWFkeSBleGlzdHMgb24gdmlkZW8pXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdVbmlxdWUgY29uc3RyYWludCcpKSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdUYWcgYWxyZWFkeSBleGlzdHMgb24gdmlkZW8nLCB7IHZpZGVvSWQsIHRhZ0lkIH0pXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBhZGRpbmcgdGFnIHRvIHZpZGVvJywgeyB2aWRlb0lkLCB0YWdJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVtb3ZlVGFnRnJvbVZpZGVvKHZpZGVvSWQ6IHN0cmluZywgdGFnSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkYi52aWRlb1RhZy5kZWxldGVNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICB2aWRlb0lkLFxuICAgICAgICAgIHRhZ0lkXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgcmVtb3ZpbmcgdGFnIGZyb20gdmlkZW8nLCB7IHZpZGVvSWQsIHRhZ0lkLCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHZpZGVvUmVwb3NpdG9yeSA9IG5ldyBWaWRlb1JlcG9zaXRvcnlJbXBsKCkiXSwibmFtZXMiOlsiQmFzZVJlcG9zaXRvcnkiLCJkYiIsImxvZ2dlciIsIlBBR0lOQVRJT04iLCJWaWRlb1JlcG9zaXRvcnlJbXBsIiwiZmluZEJ5VXNlcklkIiwidXNlcklkIiwidmlkZW9zIiwidmlkZW8iLCJmaW5kTWFueSIsIndoZXJlIiwiaW5jbHVkZSIsInVzZXIiLCJzZWxlY3QiLCJpZCIsInVzZXJuYW1lIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJhdmF0YXIiLCJ0YWdzIiwidGFnIiwicmF0aW5ncyIsIl9jb3VudCIsIm9yZGVyQnkiLCJjcmVhdGVkQXQiLCJlcnJvciIsImZpbmRCeVRhZ3MiLCJzb21lIiwibmFtZSIsImluIiwic2VhcmNoIiwicXVlcnkiLCJpbmNsdWRlTnNmdyIsIkFORCIsIk9SIiwidGl0bGUiLCJjb250YWlucyIsIm1vZGUiLCJkZXNjcmlwdGlvbiIsImlzTnNmdyIsImZpbmRXaXRoUmF0aW5ncyIsImZpbmRVbmlxdWUiLCJmaW5kV2l0aEZpbHRlcnMiLCJmaWx0ZXJzIiwidGFnUmF0aW5ncyIsInNvcnRCeSIsInNvcnRPcmRlciIsInBhZ2UiLCJsaW1pdCIsIkRFRkFVTFRfUEFHRV9TSVpFIiwibGVuZ3RoIiwidGFnTmFtZXMiLCJtYXAiLCJ0ciIsInRhZ05hbWUiLCJza2lwIiwidG90YWwiLCJQcm9taXNlIiwiYWxsIiwidGFrZSIsImNvdW50IiwiZmlsdGVyIiwiZXZlcnkiLCJtaW5SYXRpbmciLCJtYXhSYXRpbmciLCJ2aWRlb1RhZyIsImZpbmQiLCJ2dCIsInIiLCJhdmVyYWdlUmF0aW5nIiwicmVkdWNlIiwic3VtIiwibGV2ZWwiLCJzbGljZSIsInRvdGFsUGFnZXMiLCJNYXRoIiwiY2VpbCIsImNyZWF0ZVdpdGhUYWdzIiwidmlkZW9EYXRhIiwiY3JlYXRlIiwiZGF0YSIsImNvbm5lY3RPckNyZWF0ZSIsImluZm8iLCJ2aWRlb0lkIiwiZ2V0VmlkZW9TdGF0cyIsInRvdGFsUmF0aW5ncyIsInJhdGluZ3NCeVRhZyIsInJhdGluZyIsImdyb3VwQnkiLCJieSIsIl9hdmciLCJ0YWdJZHMiLCJ0YWdJZCIsInRhZ01hcCIsImFjYyIsImF2ZXJhZ2VSYXRpbmdCeVRhZyIsImdldFRyZW5kaW5nVmlkZW9zIiwic2V2ZW5EYXlzQWdvIiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwiZ3RlIiwiYWRkVGFnVG9WaWRlbyIsIkVycm9yIiwibWVzc2FnZSIsImluY2x1ZGVzIiwicmVtb3ZlVGFnRnJvbVZpZGVvIiwiZGVsZXRlTWFueSIsInRhYmxlTmFtZSIsInZpZGVvUmVwb3NpdG9yeSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/repositories/video.repository.ts\n");

/***/ }),

/***/ "(api)/./src/services/nsfw.service.ts":
/*!**************************************!*\
  !*** ./src/services/nsfw.service.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NSFWService: () => (/* binding */ NSFWService),\n/* harmony export */   nsfwService: () => (/* binding */ nsfwService)\n/* harmony export */ });\n/* harmony import */ var _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/repositories/video.repository */ \"(api)/./src/repositories/video.repository.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/logger */ \"(api)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/errors */ \"(api)/./src/lib/errors.ts\");\n\n\n\nclass NSFWService {\n    /**\n   * Automatically detect if a video is NSFW based on title and description\n   * Uses keyword matching for basic detection\n   */ async detectNSFW(title, description) {\n        const nsfwKeywords = [\n            // Explicit terms\n            \"porn\",\n            \"sex\",\n            \"nude\",\n            \"naked\",\n            \"adult\",\n            \"xxx\",\n            \"nsfw\",\n            \"explicit\",\n            \"erotic\",\n            \"fetish\",\n            \"masturbat\",\n            \"orgasm\",\n            // Body parts (common in NSFW content)\n            \"boobs\",\n            \"tits\",\n            \"ass\",\n            \"pussy\",\n            \"dick\",\n            \"cock\",\n            \"penis\",\n            \"vagina\",\n            \"breast\",\n            \"nipple\",\n            // Action words\n            \"fuck\",\n            \"fucking\",\n            \"bang\",\n            \"screw\",\n            \"cum\",\n            \"cumming\",\n            // Slang and abbreviations  \n            \"milf\",\n            \"dilf\",\n            \"bbc\",\n            \"bwc\",\n            \"bj\",\n            \"blowjob\",\n            // Common NSFW site indicators\n            \"onlyfans\",\n            \"pornhub\",\n            \"xvideos\",\n            \"xhamster\",\n            // Age-related (concerning)\n            \"teen\",\n            \"18+\",\n            \"19+\",\n            \"young\",\n            \"schoolgirl\",\n            // Context clues\n            \"tight\",\n            \"wet\",\n            \"hard\",\n            \"horny\",\n            \"kinky\",\n            \"dirty\"\n        ];\n        const textToCheck = `${title} ${description || \"\"}`.toLowerCase();\n        const isNSFW = nsfwKeywords.some((keyword)=>textToCheck.includes(keyword.toLowerCase()));\n        if (isNSFW) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(\"NSFW content detected\", {\n                title: title.substring(0, 50) + \"...\",\n                detectionMethod: \"keyword_matching\",\n                keywords: nsfwKeywords.filter((k)=>textToCheck.includes(k))\n            });\n        }\n        return isNSFW;\n    }\n    /**\n   * Mark a video as NSFW or safe (manual override)\n   */ async markVideo(videoId, isNSFW, userId) {\n        try {\n            // Validate input\n            if (!videoId?.trim()) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(\"Video ID is required\");\n            }\n            if (!userId?.trim()) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_2__.ValidationError(\"User ID is required\");\n            }\n            // Check if video exists\n            const video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(videoId);\n            if (!video) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_2__.NotFoundError(\"Video not found\");\n            }\n            // Update the video's NSFW status\n            await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.update(videoId, {\n                isNsfw: isNSFW\n            });\n            // Log the action\n            (0,_lib_logger__WEBPACK_IMPORTED_MODULE_1__.logUserAction)(isNSFW ? \"mark_video_nsfw\" : \"mark_video_safe\", userId, {\n                videoId,\n                videoTitle: video.title,\n                previousStatus: video.isNsfw,\n                newStatus: isNSFW\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(\"Video NSFW status updated\", {\n                videoId,\n                isNSFW,\n                userId,\n                action: isNSFW ? \"marked_nsfw\" : \"marked_safe\"\n            });\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"Failed to update video NSFW status\", {\n                videoId,\n                isNSFW,\n                userId,\n                error: error instanceof Error ? error.message : String(error)\n            });\n            throw error;\n        }\n    }\n    /**\n   * Bulk scan and update NSFW status for all videos\n   * Useful for initial setup or periodic re-scanning\n   */ async bulkScanVideos(userId) {\n        try {\n            const videos = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findAll();\n            let scanned = 0;\n            let updated = 0;\n            for (const video of videos){\n                scanned++;\n                const detectedNSFW = await this.detectNSFW(video.title, video.description || undefined);\n                // Only update if detection differs from current status\n                if (detectedNSFW !== video.isNsfw) {\n                    await this.markVideo(video.id, detectedNSFW, userId);\n                    updated++;\n                }\n            }\n            (0,_lib_logger__WEBPACK_IMPORTED_MODULE_1__.logUserAction)(\"bulk_nsfw_scan\", userId, {\n                videosScanned: scanned,\n                videosUpdated: updated\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(\"Bulk NSFW scan completed\", {\n                scanned,\n                updated,\n                userId\n            });\n            return {\n                scanned,\n                updated\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"Bulk NSFW scan failed\", {\n                userId,\n                error: error instanceof Error ? error.message : String(error)\n            });\n            throw error;\n        }\n    }\n    /**\n   * Get NSFW statistics\n   */ async getNSFWStats() {\n        try {\n            const allVideos = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findAll();\n            const total = allVideos.length;\n            const nsfwCount = allVideos.filter((v)=>v.isNsfw).length;\n            const safeCount = total - nsfwCount;\n            const percentage = total > 0 ? nsfwCount / total * 100 : 0;\n            return {\n                total,\n                nsfwCount,\n                safeCount,\n                percentage: Math.round(percentage * 100) / 100 // Round to 2 decimal places\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"Failed to get NSFW stats\", {\n                error: error instanceof Error ? error.message : String(error)\n            });\n            throw error;\n        }\n    }\n}\n// Create singleton instance\nconst nsfwService = new NSFWService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPO1lBQ2RqQywrQ0FBTUEsQ0FBQ2lDLEtBQUssQ0FBQyw0QkFBNEI7Z0JBQ3ZDQSxPQUFPQSxpQkFBaUJDLFFBQVFELE1BQU1FLE9BQU8sR0FBR0MsT0FBT0g7WUFDekQ7WUFDQSxNQUFNQTtRQUNSO0lBQ0Y7QUFDRjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNd0IsY0FBYyxJQUFJckQsY0FBYSIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdGVteS1uZXh0anMvLi9zcmMvc2VydmljZXMvbnNmdy5zZXJ2aWNlLnRzPzJmYjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdmlkZW9SZXBvc2l0b3J5IH0gZnJvbSAnQC9yZXBvc2l0b3JpZXMvdmlkZW8ucmVwb3NpdG9yeSdcbmltcG9ydCB7IGxvZ2dlciwgbG9nVXNlckFjdGlvbiB9IGZyb20gJ0AvbGliL2xvZ2dlcidcbmltcG9ydCB7IFZhbGlkYXRpb25FcnJvciwgTm90Rm91bmRFcnJvciB9IGZyb20gJ0AvbGliL2Vycm9ycydcblxuZXhwb3J0IGNsYXNzIE5TRldTZXJ2aWNlIHtcbiAgXG4gIC8qKlxuICAgKiBBdXRvbWF0aWNhbGx5IGRldGVjdCBpZiBhIHZpZGVvIGlzIE5TRlcgYmFzZWQgb24gdGl0bGUgYW5kIGRlc2NyaXB0aW9uXG4gICAqIFVzZXMga2V5d29yZCBtYXRjaGluZyBmb3IgYmFzaWMgZGV0ZWN0aW9uXG4gICAqL1xuICBhc3luYyBkZXRlY3ROU0ZXKHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgbnNmd0tleXdvcmRzID0gW1xuICAgICAgLy8gRXhwbGljaXQgdGVybXNcbiAgICAgICdwb3JuJywgJ3NleCcsICdudWRlJywgJ25ha2VkJywgJ2FkdWx0JywgJ3h4eCcsICduc2Z3JyxcbiAgICAgICdleHBsaWNpdCcsICdlcm90aWMnLCAnZmV0aXNoJywgJ21hc3R1cmJhdCcsICdvcmdhc20nLFxuICAgICAgLy8gQm9keSBwYXJ0cyAoY29tbW9uIGluIE5TRlcgY29udGVudClcbiAgICAgICdib29icycsICd0aXRzJywgJ2FzcycsICdwdXNzeScsICdkaWNrJywgJ2NvY2snLCAncGVuaXMnLFxuICAgICAgJ3ZhZ2luYScsICdicmVhc3QnLCAnbmlwcGxlJyxcbiAgICAgIC8vIEFjdGlvbiB3b3Jkc1xuICAgICAgJ2Z1Y2snLCAnZnVja2luZycsICdiYW5nJywgJ3NjcmV3JywgJ2N1bScsICdjdW1taW5nJyxcbiAgICAgIC8vIFNsYW5nIGFuZCBhYmJyZXZpYXRpb25zICBcbiAgICAgICdtaWxmJywgJ2RpbGYnLCAnYmJjJywgJ2J3YycsICdiaicsICdibG93am9iJyxcbiAgICAgIC8vIENvbW1vbiBOU0ZXIHNpdGUgaW5kaWNhdG9yc1xuICAgICAgJ29ubHlmYW5zJywgJ3Bvcm5odWInLCAneHZpZGVvcycsICd4aGFtc3RlcicsXG4gICAgICAvLyBBZ2UtcmVsYXRlZCAoY29uY2VybmluZylcbiAgICAgICd0ZWVuJywgJzE4KycsICcxOSsnLCAneW91bmcnLCAnc2Nob29sZ2lybCcsXG4gICAgICAvLyBDb250ZXh0IGNsdWVzXG4gICAgICAndGlnaHQnLCAnd2V0JywgJ2hhcmQnLCAnaG9ybnknLCAna2lua3knLCAnZGlydHknXG4gICAgXVxuXG4gICAgY29uc3QgdGV4dFRvQ2hlY2sgPSBgJHt0aXRsZX0gJHtkZXNjcmlwdGlvbiB8fCAnJ31gLnRvTG93ZXJDYXNlKClcbiAgICBcbiAgICBjb25zdCBpc05TRlcgPSBuc2Z3S2V5d29yZHMuc29tZShrZXl3b3JkID0+IFxuICAgICAgdGV4dFRvQ2hlY2suaW5jbHVkZXMoa2V5d29yZC50b0xvd2VyQ2FzZSgpKVxuICAgIClcblxuICAgIGlmIChpc05TRlcpIHtcbiAgICAgIGxvZ2dlci5pbmZvKCdOU0ZXIGNvbnRlbnQgZGV0ZWN0ZWQnLCB7XG4gICAgICAgIHRpdGxlOiB0aXRsZS5zdWJzdHJpbmcoMCwgNTApICsgJy4uLicsXG4gICAgICAgIGRldGVjdGlvbk1ldGhvZDogJ2tleXdvcmRfbWF0Y2hpbmcnLFxuICAgICAgICBrZXl3b3JkczogbnNmd0tleXdvcmRzLmZpbHRlcihrID0+IHRleHRUb0NoZWNrLmluY2x1ZGVzKGspKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gaXNOU0ZXXG4gIH1cblxuICAvKipcbiAgICogTWFyayBhIHZpZGVvIGFzIE5TRlcgb3Igc2FmZSAobWFudWFsIG92ZXJyaWRlKVxuICAgKi9cbiAgYXN5bmMgbWFya1ZpZGVvKHZpZGVvSWQ6IHN0cmluZywgaXNOU0ZXOiBib29sZWFuLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBWYWxpZGF0ZSBpbnB1dFxuICAgICAgaWYgKCF2aWRlb0lkPy50cmltKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignVmlkZW8gSUQgaXMgcmVxdWlyZWQnKVxuICAgICAgfVxuICAgICAgaWYgKCF1c2VySWQ/LnRyaW0oKSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdVc2VyIElEIGlzIHJlcXVpcmVkJylcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdmlkZW8gZXhpc3RzXG4gICAgICBjb25zdCB2aWRlbyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5maW5kQnlJZCh2aWRlb0lkKVxuICAgICAgaWYgKCF2aWRlbykge1xuICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcignVmlkZW8gbm90IGZvdW5kJylcbiAgICAgIH1cblxuICAgICAgLy8gVXBkYXRlIHRoZSB2aWRlbydzIE5TRlcgc3RhdHVzXG4gICAgICBhd2FpdCB2aWRlb1JlcG9zaXRvcnkudXBkYXRlKHZpZGVvSWQsIHtcbiAgICAgICAgaXNOc2Z3OiBpc05TRldcbiAgICAgIH0pXG5cbiAgICAgIC8vIExvZyB0aGUgYWN0aW9uXG4gICAgICBsb2dVc2VyQWN0aW9uKFxuICAgICAgICBpc05TRlcgPyAnbWFya192aWRlb19uc2Z3JyA6ICdtYXJrX3ZpZGVvX3NhZmUnLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHtcbiAgICAgICAgICB2aWRlb0lkLFxuICAgICAgICAgIHZpZGVvVGl0bGU6IHZpZGVvLnRpdGxlLFxuICAgICAgICAgIHByZXZpb3VzU3RhdHVzOiB2aWRlby5pc05zZncsXG4gICAgICAgICAgbmV3U3RhdHVzOiBpc05TRldcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBsb2dnZXIuaW5mbygnVmlkZW8gTlNGVyBzdGF0dXMgdXBkYXRlZCcsIHtcbiAgICAgICAgdmlkZW9JZCxcbiAgICAgICAgaXNOU0ZXLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIGFjdGlvbjogaXNOU0ZXID8gJ21hcmtlZF9uc2Z3JyA6ICdtYXJrZWRfc2FmZSdcbiAgICAgIH0pXG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gdXBkYXRlIHZpZGVvIE5TRlcgc3RhdHVzJywge1xuICAgICAgICB2aWRlb0lkLFxuICAgICAgICBpc05TRlcsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEJ1bGsgc2NhbiBhbmQgdXBkYXRlIE5TRlcgc3RhdHVzIGZvciBhbGwgdmlkZW9zXG4gICAqIFVzZWZ1bCBmb3IgaW5pdGlhbCBzZXR1cCBvciBwZXJpb2RpYyByZS1zY2FubmluZ1xuICAgKi9cbiAgYXN5bmMgYnVsa1NjYW5WaWRlb3ModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHsgc2Nhbm5lZDogbnVtYmVyLCB1cGRhdGVkOiBudW1iZXIgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2aWRlb3MgPSBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuZmluZEFsbCgpXG4gICAgICBsZXQgc2Nhbm5lZCA9IDBcbiAgICAgIGxldCB1cGRhdGVkID0gMFxuXG4gICAgICBmb3IgKGNvbnN0IHZpZGVvIG9mIHZpZGVvcykge1xuICAgICAgICBzY2FubmVkKytcbiAgICAgICAgY29uc3QgZGV0ZWN0ZWROU0ZXID0gYXdhaXQgdGhpcy5kZXRlY3ROU0ZXKHZpZGVvLnRpdGxlLCB2aWRlby5kZXNjcmlwdGlvbiB8fCB1bmRlZmluZWQpXG4gICAgICAgIFxuICAgICAgICAvLyBPbmx5IHVwZGF0ZSBpZiBkZXRlY3Rpb24gZGlmZmVycyBmcm9tIGN1cnJlbnQgc3RhdHVzXG4gICAgICAgIGlmIChkZXRlY3RlZE5TRlcgIT09IHZpZGVvLmlzTnNmdykge1xuICAgICAgICAgIGF3YWl0IHRoaXMubWFya1ZpZGVvKHZpZGVvLmlkLCBkZXRlY3RlZE5TRlcsIHVzZXJJZClcbiAgICAgICAgICB1cGRhdGVkKytcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsb2dVc2VyQWN0aW9uKCdidWxrX25zZndfc2NhbicsIHVzZXJJZCwge1xuICAgICAgICB2aWRlb3NTY2FubmVkOiBzY2FubmVkLFxuICAgICAgICB2aWRlb3NVcGRhdGVkOiB1cGRhdGVkXG4gICAgICB9KVxuXG4gICAgICBsb2dnZXIuaW5mbygnQnVsayBOU0ZXIHNjYW4gY29tcGxldGVkJywge1xuICAgICAgICBzY2FubmVkLFxuICAgICAgICB1cGRhdGVkLFxuICAgICAgICB1c2VySWRcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiB7IHNjYW5uZWQsIHVwZGF0ZWQgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignQnVsayBOU0ZXIHNjYW4gZmFpbGVkJywge1xuICAgICAgICB1c2VySWQsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcilcbiAgICAgIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgTlNGVyBzdGF0aXN0aWNzXG4gICAqL1xuICBhc3luYyBnZXROU0ZXU3RhdHMoKTogUHJvbWlzZTx7XG4gICAgdG90YWw6IG51bWJlclxuICAgIG5zZndDb3VudDogbnVtYmVyXG4gICAgc2FmZUNvdW50OiBudW1iZXJcbiAgICBwZXJjZW50YWdlOiBudW1iZXJcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBhbGxWaWRlb3MgPSBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuZmluZEFsbCgpXG4gICAgICBjb25zdCB0b3RhbCA9IGFsbFZpZGVvcy5sZW5ndGhcbiAgICAgIGNvbnN0IG5zZndDb3VudCA9IGFsbFZpZGVvcy5maWx0ZXIodiA9PiB2LmlzTnNmdykubGVuZ3RoXG4gICAgICBjb25zdCBzYWZlQ291bnQgPSB0b3RhbCAtIG5zZndDb3VudFxuICAgICAgY29uc3QgcGVyY2VudGFnZSA9IHRvdGFsID4gMCA/IChuc2Z3Q291bnQgLyB0b3RhbCkgKiAxMDAgOiAwXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsLFxuICAgICAgICBuc2Z3Q291bnQsXG4gICAgICAgIHNhZmVDb3VudCxcbiAgICAgICAgcGVyY2VudGFnZTogTWF0aC5yb3VuZChwZXJjZW50YWdlICogMTAwKSAvIDEwMCAvLyBSb3VuZCB0byAyIGRlY2ltYWwgcGxhY2VzXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBOU0ZXIHN0YXRzJywge1xuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpXG4gICAgICB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cbn1cblxuLy8gQ3JlYXRlIHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IG5zZndTZXJ2aWNlID0gbmV3IE5TRldTZXJ2aWNlKCkiXSwibmFtZXMiOlsidmlkZW9SZXBvc2l0b3J5IiwibG9nZ2VyIiwibG9nVXNlckFjdGlvbiIsIlZhbGlkYXRpb25FcnJvciIsIk5vdEZvdW5kRXJyb3IiLCJOU0ZXU2VydmljZSIsImRldGVjdE5TRlciLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwibnNmd0tleXdvcmRzIiwidGV4dFRvQ2hlY2siLCJ0b0xvd2VyQ2FzZSIsImlzTlNGVyIsInNvbWUiLCJrZXl3b3JkIiwiaW5jbHVkZXMiLCJpbmZvIiwic3Vic3RyaW5nIiwiZGV0ZWN0aW9uTWV0aG9kIiwia2V5d29yZHMiLCJmaWx0ZXIiLCJrIiwibWFya1ZpZGVvIiwidmlkZW9JZCIsInVzZXJJZCIsInRyaW0iLCJ2aWRlbyIsImZpbmRCeUlkIiwidXBkYXRlIiwiaXNOc2Z3IiwidmlkZW9UaXRsZSIsInByZXZpb3VzU3RhdHVzIiwibmV3U3RhdHVzIiwiYWN0aW9uIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJidWxrU2NhblZpZGVvcyIsInZpZGVvcyIsImZpbmRBbGwiLCJzY2FubmVkIiwidXBkYXRlZCIsImRldGVjdGVkTlNGVyIsInVuZGVmaW5lZCIsImlkIiwidmlkZW9zU2Nhbm5lZCIsInZpZGVvc1VwZGF0ZWQiLCJnZXROU0ZXU3RhdHMiLCJhbGxWaWRlb3MiLCJ0b3RhbCIsImxlbmd0aCIsIm5zZndDb3VudCIsInYiLCJzYWZlQ291bnQiLCJwZXJjZW50YWdlIiwiTWF0aCIsInJvdW5kIiwibnNmd1NlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/services/nsfw.service.ts\n");

/***/ }),

/***/ "(api)/./src/services/reddit.service.ts":
/*!****************************************!*\
  !*** ./src/services/reddit.service.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redditService: () => (/* binding */ redditService)\n/* harmony export */ });\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/logger */ \"(api)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/errors */ \"(api)/./src/lib/errors.ts\");\n\n\nclass RedditService {\n    /**\n   * Check if URL is a Reddit URL\n   */ isRedditUrl(url) {\n        return /(?:https?:\\/\\/)?(?:www\\.|old\\.|m\\.|np\\.)?reddit\\.com\\/r\\/\\w+\\/comments\\/\\w+/i.test(url);\n    }\n    /**\n   * Extract Reddit post information from URL\n   */ extractPostInfo(url) {\n        const redditRegex = /(?:https?:\\/\\/)?(?:www\\.|old\\.|m\\.|np\\.)?reddit\\.com\\/r\\/(\\w+)\\/comments\\/([a-zA-Z0-9]+)(?:\\/([^/]+))?/i;\n        const match = url.match(redditRegex);\n        if (!match) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"Invalid Reddit URL format\");\n        }\n        return {\n            subreddit: match[1],\n            postId: match[2],\n            slug: match[3]\n        };\n    }\n    /**\n   * Get Reddit post metadata\n   */ async getPostMetadata(url) {\n        try {\n            const { subreddit, postId } = this.extractPostInfo(url);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Fetching Reddit post metadata\", {\n                subreddit,\n                postId\n            });\n            // Use Reddit JSON API to get post data\n            const jsonUrl = `${this.BASE_URL}/r/${subreddit}/comments/${postId}.json`;\n            const response = await fetch(jsonUrl, {\n                headers: {\n                    \"User-Agent\": \"RateMy Video Platform/1.0 (Educational Content Aggregator)\",\n                    \"Accept\": \"application/json\"\n                }\n            });\n            if (!response.ok) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.APIError(`Failed to fetch Reddit post: ${response.status}`);\n            }\n            const data = await response.json();\n            if (!Array.isArray(data) || data.length === 0) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"Invalid Reddit post response\");\n            }\n            const postData = data[0].data.children[0].data;\n            if (!postData) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"Reddit post not found\");\n            }\n            // Extract video information\n            const videoInfo = this.extractVideoInfo(postData);\n            const metadata = {\n                postId: postData.id,\n                subreddit: postData.subreddit,\n                title: postData.title,\n                author: postData.author,\n                description: postData.selftext || undefined,\n                videoUrl: videoInfo.videoUrl,\n                thumbnailUrl: videoInfo.thumbnailUrl,\n                isNsfw: postData.over_18 || false,\n                upvotes: postData.ups || 0,\n                comments: postData.num_comments || 0,\n                createdAt: postData.created_utc || 0,\n                domain: postData.domain\n            };\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Successfully extracted Reddit metadata\", {\n                postId: metadata.postId,\n                title: metadata.title,\n                hasVideo: !!metadata.videoUrl,\n                isNsfw: metadata.isNsfw\n            });\n            return metadata;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to fetch Reddit metadata\", {\n                url,\n                error\n            });\n            throw error;\n        }\n    }\n    /**\n   * Extract video information from Reddit post data\n   */ extractVideoInfo(postData) {\n        let videoUrl;\n        let thumbnailUrl;\n        // Check Reddit Video (v.redd.it)\n        if (postData.is_video && postData.media?.reddit_video) {\n            videoUrl = postData.media.reddit_video.hls_url || postData.media.reddit_video.fallback_url;\n            thumbnailUrl = postData.preview?.images?.[0]?.source?.url;\n        } else if (postData.domain) {\n            if (postData.domain.includes(\"redgifs.com\")) {\n                // RedGifs content embedded in Reddit\n                videoUrl = postData.url;\n                thumbnailUrl = postData.thumbnail !== \"default\" ? postData.thumbnail : undefined;\n            } else if (postData.domain.includes(\"gfycat.com\")) {\n                // Gfycat content\n                videoUrl = postData.url;\n                thumbnailUrl = postData.thumbnail !== \"default\" ? postData.thumbnail : undefined;\n            } else if (postData.domain.includes(\"imgur.com\")) {\n                // Imgur content\n                if (postData.url.includes(\".gif\") || postData.url.includes(\".mp4\")) {\n                    videoUrl = postData.url;\n                }\n            } else if (postData.domain.includes(\"streamable.com\")) {\n                // Streamable content\n                videoUrl = postData.url;\n            }\n        }\n        // Fallback: check if URL itself is a video\n        if (!videoUrl && postData.url) {\n            const url = postData.url.toLowerCase();\n            if (url.includes(\".mp4\") || url.includes(\".webm\") || url.includes(\".gif\")) {\n                videoUrl = postData.url;\n            }\n        }\n        // Clean up thumbnail URL if it exists\n        if (thumbnailUrl && thumbnailUrl.includes(\"&amp;\")) {\n            thumbnailUrl = thumbnailUrl.replace(/&amp;/g, \"&\");\n        }\n        return {\n            videoUrl,\n            thumbnailUrl\n        };\n    }\n    /**\n   * Convert Reddit URL to embed format\n   */ getEmbedUrl(url) {\n        try {\n            const { subreddit, postId } = this.extractPostInfo(url);\n            // Reddit doesn't have a direct embed format like YouTube\n            // We'll use the Reddit URL directly or create an iframe-friendly version\n            return `${this.BASE_URL}/r/${subreddit}/comments/${postId}/embed/`;\n        } catch (error) {\n            // Fallback to original URL\n            return url;\n        }\n    }\n    /**\n   * Process Reddit URL for video upload\n   */ async processRedditUrl(url) {\n        try {\n            const metadata = await this.getPostMetadata(url);\n            // Determine embed URL based on content type\n            let embedUrl;\n            if (metadata.videoUrl && metadata.domain === \"redgifs.com\") {\n                // Handle RedGifs content embedded in Reddit posts\n                const redgifsMatch = metadata.videoUrl.match(/redgifs\\.com\\/watch\\/([a-zA-Z0-9]+)/);\n                if (redgifsMatch) {\n                    const gifId = redgifsMatch[1];\n                    // Try direct MP4 first, fallback to iframe\n                    const directUrl = `https://media.redgifs.com/${this.capitalizeGifId(gifId)}.mp4`;\n                    try {\n                        const testResponse = await fetch(directUrl, {\n                            method: \"HEAD\"\n                        });\n                        embedUrl = testResponse.ok ? directUrl : `https://www.redgifs.com/ifr/${gifId}?poster=0`;\n                    } catch  {\n                        embedUrl = `https://www.redgifs.com/ifr/${gifId}?poster=0`;\n                    }\n                } else {\n                    embedUrl = metadata.videoUrl;\n                }\n            } else if (metadata.videoUrl) {\n                // Use the direct video URL if available\n                embedUrl = metadata.videoUrl;\n            } else {\n                // Fallback to Reddit embed (won't work well for video)\n                embedUrl = this.getEmbedUrl(url);\n            }\n            // Generate relevant tags\n            const tags = [\n                \"reddit\",\n                `r/${metadata.subreddit}`,\n                ...metadata.isNsfw ? [\n                    \"nsfw\"\n                ] : [\n                    \"sfw\"\n                ],\n                ...metadata.domain ? [\n                    metadata.domain\n                ] : []\n            ];\n            return {\n                embedUrl,\n                thumbnail: metadata.thumbnailUrl,\n                metadata,\n                tags: tags // Removed tag limit\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to process Reddit URL\", {\n                url,\n                error\n            });\n            throw error;\n        }\n    }\n    /**\n   * Get subreddit information\n   */ async getSubredditInfo(subredditName) {\n        try {\n            const response = await fetch(`${this.BASE_URL}/r/${subredditName}/about.json`, {\n                headers: {\n                    \"User-Agent\": \"RateMy Video Platform/1.0 (Educational Content Aggregator)\",\n                    \"Accept\": \"application/json\"\n                }\n            });\n            if (!response.ok) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.APIError(`Failed to fetch subreddit info: ${response.status}`);\n            }\n            const data = await response.json();\n            const subredditData = data.data;\n            return {\n                name: subredditData.display_name,\n                title: subredditData.title,\n                description: subredditData.public_description || subredditData.description,\n                isNsfw: subredditData.over18 || false,\n                subscribers: subredditData.subscribers || 0\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to fetch subreddit info\", {\n                subredditName,\n                error\n            });\n            throw error;\n        }\n    }\n    constructor(){\n        this.BASE_URL = \"https://www.reddit.com\";\n    }\n}\nconst redditService = new RedditService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWF1QixpQkFBaUJDLGFBQXFCLEVBTWhEO1FBQ0QsSUFBSTtZQUNGLE1BQU16RCxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQ0YsUUFBUSxDQUFDLEdBQUcsRUFBRTBELGNBQWMsV0FBVyxDQUFDLEVBQUU7Z0JBQzdFdkQsU0FBUztvQkFDUCxjQUFjO29CQUNkLFVBQVU7Z0JBQ1o7WUFDRjtZQUVBLElBQUksQ0FBQ0YsU0FBU0csRUFBRSxFQUFFO2dCQUNoQixNQUFNLElBQUlsQixpREFBUUEsQ0FBQyxDQUFDLGdDQUFnQyxFQUFFZSxTQUFTSSxNQUFNLENBQUMsQ0FBQztZQUN6RTtZQUVBLE1BQU1DLE9BQU8sTUFBTUwsU0FBU00sSUFBSTtZQUNoQyxNQUFNb0QsZ0JBQWdCckQsS0FBS0EsSUFBSTtZQUUvQixPQUFPO2dCQUNMc0QsTUFBTUQsY0FBY0UsWUFBWTtnQkFDaEM1QyxPQUFPMEMsY0FBYzFDLEtBQUs7Z0JBQzFCRSxhQUFhd0MsY0FBY0csa0JBQWtCLElBQUlILGNBQWN4QyxXQUFXO2dCQUMxRUssUUFBUW1DLGNBQWNJLE1BQU0sSUFBSTtnQkFDaENDLGFBQWFMLGNBQWNLLFdBQVcsSUFBSTtZQUM1QztRQUVGLEVBQUUsT0FBTzlCLE9BQU87WUFDZGxELCtDQUFNQSxDQUFDa0QsS0FBSyxDQUFDLGtDQUFrQztnQkFBRXdCO2dCQUFleEI7WUFBTTtZQUN0RSxNQUFNQTtRQUNSO0lBQ0Y7O2FBclFpQmxDLFdBQVc7O0FBc1E5QjtBQUVPLE1BQU1pRSxnQkFBZ0IsSUFBSTlFLGdCQUFlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9zZXJ2aWNlcy9yZWRkaXQuc2VydmljZS50cz8zMGUwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvbGliL2xvZ2dlcidcbmltcG9ydCB7IFZhbGlkYXRpb25FcnJvciwgQVBJRXJyb3IgfSBmcm9tICdAL2xpYi9lcnJvcnMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVkZGl0VmlkZW9NZXRhZGF0YSB7XG4gIHBvc3RJZDogc3RyaW5nXG4gIHN1YnJlZGRpdDogc3RyaW5nXG4gIHRpdGxlOiBzdHJpbmdcbiAgYXV0aG9yOiBzdHJpbmdcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmdcbiAgdmlkZW9Vcmw/OiBzdHJpbmdcbiAgdGh1bWJuYWlsVXJsPzogc3RyaW5nXG4gIGlzTnNmdzogYm9vbGVhblxuICB1cHZvdGVzOiBudW1iZXJcbiAgY29tbWVudHM6IG51bWJlclxuICBjcmVhdGVkQXQ6IG51bWJlclxuICBkb21haW4/OiBzdHJpbmdcbn1cblxuY2xhc3MgUmVkZGl0U2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgQkFTRV9VUkwgPSAnaHR0cHM6Ly93d3cucmVkZGl0LmNvbSdcblxuICAvKipcbiAgICogQ2hlY2sgaWYgVVJMIGlzIGEgUmVkZGl0IFVSTFxuICAgKi9cbiAgcHVibGljIGlzUmVkZGl0VXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC58b2xkXFwufG1cXC58bnBcXC4pP3JlZGRpdFxcLmNvbVxcL3JcXC9cXHcrXFwvY29tbWVudHNcXC9cXHcrL2kudGVzdCh1cmwpXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdCBSZWRkaXQgcG9zdCBpbmZvcm1hdGlvbiBmcm9tIFVSTFxuICAgKi9cbiAgcHVibGljIGV4dHJhY3RQb3N0SW5mbyh1cmw6IHN0cmluZyk6IHsgc3VicmVkZGl0OiBzdHJpbmc7IHBvc3RJZDogc3RyaW5nOyBzbHVnPzogc3RyaW5nIH0ge1xuICAgIGNvbnN0IHJlZGRpdFJlZ2V4ID0gLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLnxvbGRcXC58bVxcLnxucFxcLik/cmVkZGl0XFwuY29tXFwvclxcLyhcXHcrKVxcL2NvbW1lbnRzXFwvKFthLXpBLVowLTldKykoPzpcXC8oW14vXSspKT8vaVxuICAgIGNvbnN0IG1hdGNoID0gdXJsLm1hdGNoKHJlZGRpdFJlZ2V4KVxuICAgIFxuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgUmVkZGl0IFVSTCBmb3JtYXQnKVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWJyZWRkaXQ6IG1hdGNoWzFdLFxuICAgICAgcG9zdElkOiBtYXRjaFsyXSxcbiAgICAgIHNsdWc6IG1hdGNoWzNdXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBSZWRkaXQgcG9zdCBtZXRhZGF0YVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldFBvc3RNZXRhZGF0YSh1cmw6IHN0cmluZyk6IFByb21pc2U8UmVkZGl0VmlkZW9NZXRhZGF0YT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHN1YnJlZGRpdCwgcG9zdElkIH0gPSB0aGlzLmV4dHJhY3RQb3N0SW5mbyh1cmwpXG4gICAgICBcbiAgICAgIGxvZ2dlci5pbmZvKCdGZXRjaGluZyBSZWRkaXQgcG9zdCBtZXRhZGF0YScsIHsgc3VicmVkZGl0LCBwb3N0SWQgfSlcblxuICAgICAgLy8gVXNlIFJlZGRpdCBKU09OIEFQSSB0byBnZXQgcG9zdCBkYXRhXG4gICAgICBjb25zdCBqc29uVXJsID0gYCR7dGhpcy5CQVNFX1VSTH0vci8ke3N1YnJlZGRpdH0vY29tbWVudHMvJHtwb3N0SWR9Lmpzb25gXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goanNvblVybCwge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ1VzZXItQWdlbnQnOiAnUmF0ZU15IFZpZGVvIFBsYXRmb3JtLzEuMCAoRWR1Y2F0aW9uYWwgQ29udGVudCBBZ2dyZWdhdG9yKScsXG4gICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBSZWRkaXQgcG9zdDogJHtyZXNwb25zZS5zdGF0dXN9YClcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkgfHwgZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignSW52YWxpZCBSZWRkaXQgcG9zdCByZXNwb25zZScpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBvc3REYXRhID0gZGF0YVswXS5kYXRhLmNoaWxkcmVuWzBdLmRhdGFcbiAgICAgIFxuICAgICAgaWYgKCFwb3N0RGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdSZWRkaXQgcG9zdCBub3QgZm91bmQnKVxuICAgICAgfVxuXG4gICAgICAvLyBFeHRyYWN0IHZpZGVvIGluZm9ybWF0aW9uXG4gICAgICBjb25zdCB2aWRlb0luZm8gPSB0aGlzLmV4dHJhY3RWaWRlb0luZm8ocG9zdERhdGEpXG5cbiAgICAgIGNvbnN0IG1ldGFkYXRhOiBSZWRkaXRWaWRlb01ldGFkYXRhID0ge1xuICAgICAgICBwb3N0SWQ6IHBvc3REYXRhLmlkLFxuICAgICAgICBzdWJyZWRkaXQ6IHBvc3REYXRhLnN1YnJlZGRpdCxcbiAgICAgICAgdGl0bGU6IHBvc3REYXRhLnRpdGxlLFxuICAgICAgICBhdXRob3I6IHBvc3REYXRhLmF1dGhvcixcbiAgICAgICAgZGVzY3JpcHRpb246IHBvc3REYXRhLnNlbGZ0ZXh0IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgdmlkZW9Vcmw6IHZpZGVvSW5mby52aWRlb1VybCxcbiAgICAgICAgdGh1bWJuYWlsVXJsOiB2aWRlb0luZm8udGh1bWJuYWlsVXJsLFxuICAgICAgICBpc05zZnc6IHBvc3REYXRhLm92ZXJfMTggfHwgZmFsc2UsXG4gICAgICAgIHVwdm90ZXM6IHBvc3REYXRhLnVwcyB8fCAwLFxuICAgICAgICBjb21tZW50czogcG9zdERhdGEubnVtX2NvbW1lbnRzIHx8IDAsXG4gICAgICAgIGNyZWF0ZWRBdDogcG9zdERhdGEuY3JlYXRlZF91dGMgfHwgMCxcbiAgICAgICAgZG9tYWluOiBwb3N0RGF0YS5kb21haW5cbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ1N1Y2Nlc3NmdWxseSBleHRyYWN0ZWQgUmVkZGl0IG1ldGFkYXRhJywgeyBcbiAgICAgICAgcG9zdElkOiBtZXRhZGF0YS5wb3N0SWQsXG4gICAgICAgIHRpdGxlOiBtZXRhZGF0YS50aXRsZSxcbiAgICAgICAgaGFzVmlkZW86ICEhbWV0YWRhdGEudmlkZW9VcmwsXG4gICAgICAgIGlzTnNmdzogbWV0YWRhdGEuaXNOc2Z3XG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gbWV0YWRhdGFcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBSZWRkaXQgbWV0YWRhdGEnLCB7IHVybCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgdmlkZW8gaW5mb3JtYXRpb24gZnJvbSBSZWRkaXQgcG9zdCBkYXRhXG4gICAqL1xuICBwcml2YXRlIGV4dHJhY3RWaWRlb0luZm8ocG9zdERhdGE6IGFueSk6IHsgdmlkZW9Vcmw/OiBzdHJpbmc7IHRodW1ibmFpbFVybD86IHN0cmluZyB9IHtcbiAgICBsZXQgdmlkZW9Vcmw6IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgIGxldCB0aHVtYm5haWxVcmw6IHN0cmluZyB8IHVuZGVmaW5lZFxuXG4gICAgLy8gQ2hlY2sgUmVkZGl0IFZpZGVvICh2LnJlZGQuaXQpXG4gICAgaWYgKHBvc3REYXRhLmlzX3ZpZGVvICYmIHBvc3REYXRhLm1lZGlhPy5yZWRkaXRfdmlkZW8pIHtcbiAgICAgIHZpZGVvVXJsID0gcG9zdERhdGEubWVkaWEucmVkZGl0X3ZpZGVvLmhsc191cmwgfHwgcG9zdERhdGEubWVkaWEucmVkZGl0X3ZpZGVvLmZhbGxiYWNrX3VybFxuICAgICAgdGh1bWJuYWlsVXJsID0gcG9zdERhdGEucHJldmlldz8uaW1hZ2VzPy5bMF0/LnNvdXJjZT8udXJsXG4gICAgfVxuICAgIC8vIENoZWNrIGZvciBleHRlcm5hbCB2aWRlbyBkb21haW5zXG4gICAgZWxzZSBpZiAocG9zdERhdGEuZG9tYWluKSB7XG4gICAgICBpZiAocG9zdERhdGEuZG9tYWluLmluY2x1ZGVzKCdyZWRnaWZzLmNvbScpKSB7XG4gICAgICAgIC8vIFJlZEdpZnMgY29udGVudCBlbWJlZGRlZCBpbiBSZWRkaXRcbiAgICAgICAgdmlkZW9VcmwgPSBwb3N0RGF0YS51cmxcbiAgICAgICAgdGh1bWJuYWlsVXJsID0gcG9zdERhdGEudGh1bWJuYWlsICE9PSAnZGVmYXVsdCcgPyBwb3N0RGF0YS50aHVtYm5haWwgOiB1bmRlZmluZWRcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHBvc3REYXRhLmRvbWFpbi5pbmNsdWRlcygnZ2Z5Y2F0LmNvbScpKSB7XG4gICAgICAgIC8vIEdmeWNhdCBjb250ZW50XG4gICAgICAgIHZpZGVvVXJsID0gcG9zdERhdGEudXJsXG4gICAgICAgIHRodW1ibmFpbFVybCA9IHBvc3REYXRhLnRodW1ibmFpbCAhPT0gJ2RlZmF1bHQnID8gcG9zdERhdGEudGh1bWJuYWlsIDogdW5kZWZpbmVkXG4gICAgICB9XG4gICAgICBlbHNlIGlmIChwb3N0RGF0YS5kb21haW4uaW5jbHVkZXMoJ2ltZ3VyLmNvbScpKSB7XG4gICAgICAgIC8vIEltZ3VyIGNvbnRlbnRcbiAgICAgICAgaWYgKHBvc3REYXRhLnVybC5pbmNsdWRlcygnLmdpZicpIHx8IHBvc3REYXRhLnVybC5pbmNsdWRlcygnLm1wNCcpKSB7XG4gICAgICAgICAgdmlkZW9VcmwgPSBwb3N0RGF0YS51cmxcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAocG9zdERhdGEuZG9tYWluLmluY2x1ZGVzKCdzdHJlYW1hYmxlLmNvbScpKSB7XG4gICAgICAgIC8vIFN0cmVhbWFibGUgY29udGVudFxuICAgICAgICB2aWRlb1VybCA9IHBvc3REYXRhLnVybFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrOiBjaGVjayBpZiBVUkwgaXRzZWxmIGlzIGEgdmlkZW9cbiAgICBpZiAoIXZpZGVvVXJsICYmIHBvc3REYXRhLnVybCkge1xuICAgICAgY29uc3QgdXJsID0gcG9zdERhdGEudXJsLnRvTG93ZXJDYXNlKClcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy5tcDQnKSB8fCB1cmwuaW5jbHVkZXMoJy53ZWJtJykgfHwgdXJsLmluY2x1ZGVzKCcuZ2lmJykpIHtcbiAgICAgICAgdmlkZW9VcmwgPSBwb3N0RGF0YS51cmxcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDbGVhbiB1cCB0aHVtYm5haWwgVVJMIGlmIGl0IGV4aXN0c1xuICAgIGlmICh0aHVtYm5haWxVcmwgJiYgdGh1bWJuYWlsVXJsLmluY2x1ZGVzKCcmYW1wOycpKSB7XG4gICAgICB0aHVtYm5haWxVcmwgPSB0aHVtYm5haWxVcmwucmVwbGFjZSgvJmFtcDsvZywgJyYnKVxuICAgIH1cblxuICAgIHJldHVybiB7IHZpZGVvVXJsLCB0aHVtYm5haWxVcmwgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgUmVkZGl0IFVSTCB0byBlbWJlZCBmb3JtYXRcbiAgICovXG4gIHB1YmxpYyBnZXRFbWJlZFVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgc3VicmVkZGl0LCBwb3N0SWQgfSA9IHRoaXMuZXh0cmFjdFBvc3RJbmZvKHVybClcbiAgICAgIFxuICAgICAgLy8gUmVkZGl0IGRvZXNuJ3QgaGF2ZSBhIGRpcmVjdCBlbWJlZCBmb3JtYXQgbGlrZSBZb3VUdWJlXG4gICAgICAvLyBXZSdsbCB1c2UgdGhlIFJlZGRpdCBVUkwgZGlyZWN0bHkgb3IgY3JlYXRlIGFuIGlmcmFtZS1mcmllbmRseSB2ZXJzaW9uXG4gICAgICByZXR1cm4gYCR7dGhpcy5CQVNFX1VSTH0vci8ke3N1YnJlZGRpdH0vY29tbWVudHMvJHtwb3N0SWR9L2VtYmVkL2BcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBVUkxcbiAgICAgIHJldHVybiB1cmxcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUHJvY2VzcyBSZWRkaXQgVVJMIGZvciB2aWRlbyB1cGxvYWRcbiAgICovXG4gIHB1YmxpYyBhc3luYyBwcm9jZXNzUmVkZGl0VXJsKHVybDogc3RyaW5nKTogUHJvbWlzZTx7XG4gICAgZW1iZWRVcmw6IHN0cmluZ1xuICAgIHRodW1ibmFpbD86IHN0cmluZ1xuICAgIG1ldGFkYXRhOiBSZWRkaXRWaWRlb01ldGFkYXRhXG4gICAgdGFnczogc3RyaW5nW11cbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IHRoaXMuZ2V0UG9zdE1ldGFkYXRhKHVybClcbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIGVtYmVkIFVSTCBiYXNlZCBvbiBjb250ZW50IHR5cGVcbiAgICAgIGxldCBlbWJlZFVybDogc3RyaW5nXG4gICAgICBcbiAgICAgIGlmIChtZXRhZGF0YS52aWRlb1VybCAmJiBtZXRhZGF0YS5kb21haW4gPT09ICdyZWRnaWZzLmNvbScpIHtcbiAgICAgICAgLy8gSGFuZGxlIFJlZEdpZnMgY29udGVudCBlbWJlZGRlZCBpbiBSZWRkaXQgcG9zdHNcbiAgICAgICAgY29uc3QgcmVkZ2lmc01hdGNoID0gbWV0YWRhdGEudmlkZW9VcmwubWF0Y2goL3JlZGdpZnNcXC5jb21cXC93YXRjaFxcLyhbYS16QS1aMC05XSspLylcbiAgICAgICAgaWYgKHJlZGdpZnNNYXRjaCkge1xuICAgICAgICAgIGNvbnN0IGdpZklkID0gcmVkZ2lmc01hdGNoWzFdXG4gICAgICAgICAgLy8gVHJ5IGRpcmVjdCBNUDQgZmlyc3QsIGZhbGxiYWNrIHRvIGlmcmFtZVxuICAgICAgICAgIGNvbnN0IGRpcmVjdFVybCA9IGBodHRwczovL21lZGlhLnJlZGdpZnMuY29tLyR7dGhpcy5jYXBpdGFsaXplR2lmSWQoZ2lmSWQpfS5tcDRgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRlc3RSZXNwb25zZSA9IGF3YWl0IGZldGNoKGRpcmVjdFVybCwgeyBtZXRob2Q6ICdIRUFEJyB9KVxuICAgICAgICAgICAgZW1iZWRVcmwgPSB0ZXN0UmVzcG9uc2Uub2sgPyBkaXJlY3RVcmwgOiBgaHR0cHM6Ly93d3cucmVkZ2lmcy5jb20vaWZyLyR7Z2lmSWR9P3Bvc3Rlcj0wYFxuICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgZW1iZWRVcmwgPSBgaHR0cHM6Ly93d3cucmVkZ2lmcy5jb20vaWZyLyR7Z2lmSWR9P3Bvc3Rlcj0wYFxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbWJlZFVybCA9IG1ldGFkYXRhLnZpZGVvVXJsXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobWV0YWRhdGEudmlkZW9VcmwpIHtcbiAgICAgICAgLy8gVXNlIHRoZSBkaXJlY3QgdmlkZW8gVVJMIGlmIGF2YWlsYWJsZVxuICAgICAgICBlbWJlZFVybCA9IG1ldGFkYXRhLnZpZGVvVXJsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBSZWRkaXQgZW1iZWQgKHdvbid0IHdvcmsgd2VsbCBmb3IgdmlkZW8pXG4gICAgICAgIGVtYmVkVXJsID0gdGhpcy5nZXRFbWJlZFVybCh1cmwpXG4gICAgICB9XG5cbiAgICAgIC8vIEdlbmVyYXRlIHJlbGV2YW50IHRhZ3NcbiAgICAgIGNvbnN0IHRhZ3MgPSBbXG4gICAgICAgICdyZWRkaXQnLFxuICAgICAgICBgci8ke21ldGFkYXRhLnN1YnJlZGRpdH1gLFxuICAgICAgICAuLi4obWV0YWRhdGEuaXNOc2Z3ID8gWyduc2Z3J10gOiBbJ3NmdyddKSxcbiAgICAgICAgLi4uKG1ldGFkYXRhLmRvbWFpbiA/IFttZXRhZGF0YS5kb21haW5dIDogW10pXG4gICAgICBdXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVtYmVkVXJsLFxuICAgICAgICB0aHVtYm5haWw6IG1ldGFkYXRhLnRodW1ibmFpbFVybCxcbiAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgIHRhZ3M6IHRhZ3MgLy8gUmVtb3ZlZCB0YWcgbGltaXRcbiAgICAgIH1cblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBwcm9jZXNzIFJlZGRpdCBVUkwnLCB7IHVybCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzdWJyZWRkaXQgaW5mb3JtYXRpb25cbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRTdWJyZWRkaXRJbmZvKHN1YnJlZGRpdE5hbWU6IHN0cmluZyk6IFByb21pc2U8e1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIHRpdGxlOiBzdHJpbmdcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gICAgaXNOc2Z3OiBib29sZWFuXG4gICAgc3Vic2NyaWJlcnM6IG51bWJlclxuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5CQVNFX1VSTH0vci8ke3N1YnJlZGRpdE5hbWV9L2Fib3V0Lmpzb25gLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnVXNlci1BZ2VudCc6ICdSYXRlTXkgVmlkZW8gUGxhdGZvcm0vMS4wIChFZHVjYXRpb25hbCBDb250ZW50IEFnZ3JlZ2F0b3IpJyxcbiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihgRmFpbGVkIHRvIGZldGNoIHN1YnJlZGRpdCBpbmZvOiAke3Jlc3BvbnNlLnN0YXR1c31gKVxuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICBjb25zdCBzdWJyZWRkaXREYXRhID0gZGF0YS5kYXRhXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IHN1YnJlZGRpdERhdGEuZGlzcGxheV9uYW1lLFxuICAgICAgICB0aXRsZTogc3VicmVkZGl0RGF0YS50aXRsZSxcbiAgICAgICAgZGVzY3JpcHRpb246IHN1YnJlZGRpdERhdGEucHVibGljX2Rlc2NyaXB0aW9uIHx8IHN1YnJlZGRpdERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgIGlzTnNmdzogc3VicmVkZGl0RGF0YS5vdmVyMTggfHwgZmFsc2UsXG4gICAgICAgIHN1YnNjcmliZXJzOiBzdWJyZWRkaXREYXRhLnN1YnNjcmliZXJzIHx8IDBcbiAgICAgIH1cblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBzdWJyZWRkaXQgaW5mbycsIHsgc3VicmVkZGl0TmFtZSwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCByZWRkaXRTZXJ2aWNlID0gbmV3IFJlZGRpdFNlcnZpY2UoKSJdLCJuYW1lcyI6WyJsb2dnZXIiLCJWYWxpZGF0aW9uRXJyb3IiLCJBUElFcnJvciIsIlJlZGRpdFNlcnZpY2UiLCJpc1JlZGRpdFVybCIsInVybCIsInRlc3QiLCJleHRyYWN0UG9zdEluZm8iLCJyZWRkaXRSZWdleCIsIm1hdGNoIiwic3VicmVkZGl0IiwicG9zdElkIiwic2x1ZyIsImdldFBvc3RNZXRhZGF0YSIsImluZm8iLCJqc29uVXJsIiwiQkFTRV9VUkwiLCJyZXNwb25zZSIsImZldGNoIiwiaGVhZGVycyIsIm9rIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJwb3N0RGF0YSIsImNoaWxkcmVuIiwidmlkZW9JbmZvIiwiZXh0cmFjdFZpZGVvSW5mbyIsIm1ldGFkYXRhIiwiaWQiLCJ0aXRsZSIsImF1dGhvciIsImRlc2NyaXB0aW9uIiwic2VsZnRleHQiLCJ1bmRlZmluZWQiLCJ2aWRlb1VybCIsInRodW1ibmFpbFVybCIsImlzTnNmdyIsIm92ZXJfMTgiLCJ1cHZvdGVzIiwidXBzIiwiY29tbWVudHMiLCJudW1fY29tbWVudHMiLCJjcmVhdGVkQXQiLCJjcmVhdGVkX3V0YyIsImRvbWFpbiIsImhhc1ZpZGVvIiwiZXJyb3IiLCJpc192aWRlbyIsIm1lZGlhIiwicmVkZGl0X3ZpZGVvIiwiaGxzX3VybCIsImZhbGxiYWNrX3VybCIsInByZXZpZXciLCJpbWFnZXMiLCJzb3VyY2UiLCJpbmNsdWRlcyIsInRodW1ibmFpbCIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsImdldEVtYmVkVXJsIiwicHJvY2Vzc1JlZGRpdFVybCIsImVtYmVkVXJsIiwicmVkZ2lmc01hdGNoIiwiZ2lmSWQiLCJkaXJlY3RVcmwiLCJjYXBpdGFsaXplR2lmSWQiLCJ0ZXN0UmVzcG9uc2UiLCJtZXRob2QiLCJ0YWdzIiwiZ2V0U3VicmVkZGl0SW5mbyIsInN1YnJlZGRpdE5hbWUiLCJzdWJyZWRkaXREYXRhIiwibmFtZSIsImRpc3BsYXlfbmFtZSIsInB1YmxpY19kZXNjcmlwdGlvbiIsIm92ZXIxOCIsInN1YnNjcmliZXJzIiwicmVkZGl0U2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/services/reddit.service.ts\n");

/***/ }),

/***/ "(api)/./src/services/redgifs.service.ts":
/*!*****************************************!*\
  !*** ./src/services/redgifs.service.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redGifsService: () => (/* binding */ redGifsService)\n/* harmony export */ });\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/logger */ \"(api)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/errors */ \"(api)/./src/lib/errors.ts\");\n\n\nclass RedGifsService {\n    /**\n   * Get temporary token for API access\n   */ async getToken() {\n        // Check if current token is still valid\n        if (this.token && Date.now() < this.tokenExpiry) {\n            return this.token;\n        }\n        try {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Requesting new RedGifs API token\");\n            const response = await fetch(`${this.BASE_URL}/auth/temporary`, {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            if (!response.ok) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.APIError(`Failed to get RedGifs token: ${response.status}`);\n            }\n            const data = await response.json();\n            if (!data.token) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.APIError(\"No token returned from RedGifs API\");\n            }\n            this.token = data.token;\n            // Set expiry to 1 hour from now (tokens typically last 24h but we refresh early)\n            this.tokenExpiry = Date.now() + 60 * 60 * 1000;\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Successfully obtained RedGifs API token\");\n            return this.token;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to get RedGifs token\", {\n                error\n            });\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.APIError(\"Failed to authenticate with RedGifs API\");\n        }\n    }\n    /**\n   * Make authenticated request to RedGifs API\n   */ async makeRequest(endpoint, options = {}) {\n        const token = await this.getToken();\n        const response = await fetch(`${this.BASE_URL}${endpoint}`, {\n            ...options,\n            headers: {\n                \"Authorization\": `Bearer ${token}`,\n                \"Content-Type\": \"application/json\",\n                ...options.headers\n            }\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"RedGifs API error\", {\n                endpoint,\n                status: response.status,\n                error: errorText\n            });\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.APIError(`RedGifs API error: ${response.status} - ${errorText}`);\n        }\n        return response.json();\n    }\n    /**\n   * Extract RedGifs ID from URL\n   */ extractGifId(url) {\n        const patterns = [\n            /redgifs\\.com\\/watch\\/([a-zA-Z0-9]+)/,\n            /redgifs\\.com\\/ifr\\/([a-zA-Z0-9]+)/,\n            /redgifs\\.com\\/([a-zA-Z0-9]+)$/,\n            /\\/([a-zA-Z0-9]+)$/\n        ];\n        for (const pattern of patterns){\n            const match = url.match(pattern);\n            if (match && match[1]) {\n                return match[1].toLowerCase();\n            }\n        }\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"Invalid RedGifs URL format\");\n    }\n    /**\n   * Check if URL is a RedGifs URL\n   */ isRedGifsUrl(url) {\n        return url.includes(\"redgifs.com\") || url.includes(\"redgifs.com\");\n    }\n    /**\n   * Get metadata for a specific gif by ID\n   */ async getGifMetadata(gifId) {\n        try {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Fetching RedGifs metadata\", {\n                gifId\n            });\n            const response = await this.makeRequest(`/gifs/${gifId}`);\n            if (!response.gif) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"Gif not found\");\n            }\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Successfully fetched RedGifs metadata\", {\n                gifId,\n                title: response.gif.title,\n                tags: response.gif.tags?.length || 0\n            });\n            return response.gif;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to fetch RedGifs metadata\", {\n                gifId,\n                error\n            });\n            throw error;\n        }\n    }\n    /**\n   * Get metadata from RedGifs URL\n   */ async getMetadataFromUrl(url) {\n        if (!this.isRedGifsUrl(url)) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"URL is not a RedGifs URL\");\n        }\n        const gifId = this.extractGifId(url);\n        return this.getGifMetadata(gifId);\n    }\n    /**\n   * Convert RedGifs URL to embed format\n   * Returns the iframe URL that shows just the gif without the full website interface\n   */ getEmbedUrl(gifId) {\n        // Use the iframe URL that shows only the gif content\n        return `https://www.redgifs.com/ifr/${gifId}?poster=0`;\n    }\n    /**\n   * Get direct gif URL from metadata\n   */ getDirectGifUrl(metadata) {\n        // Return the HD URL if available, otherwise SD, otherwise fallback to embed\n        return metadata.urls?.hd || metadata.urls?.sd || this.getEmbedUrl(metadata.id);\n    }\n    /**\n   * Get thumbnail URL for a gif\n   */ getThumbnailUrl(gifId) {\n        return `https://thumbs4.redgifs.com/${gifId}-poster.jpg`;\n    }\n    /**\n   * Search for gifs by tags or query\n   */ async searchGifs(query, options = {}) {\n        try {\n            const { page = 1, count = 20, order = \"trending\" } = options;\n            const params = new URLSearchParams({\n                search_text: query,\n                order,\n                count: count.toString(),\n                page: page.toString()\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Searching RedGifs\", {\n                query,\n                options\n            });\n            const response = await this.makeRequest(`/gifs/search?${params}`);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"RedGifs search completed\", {\n                query,\n                results: response.gifs?.length || 0,\n                total: response.total\n            });\n            return {\n                gifs: response.gifs || [],\n                total: response.total || 0,\n                page: response.page || page\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to search RedGifs\", {\n                query,\n                options,\n                error\n            });\n            throw error;\n        }\n    }\n    /**\n   * Get trending gifs\n   */ async getTrendingGifs(count = 10) {\n        try {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Fetching trending RedGifs\", {\n                count\n            });\n            const response = await this.makeRequest(`/gifs/trending?count=${count}`);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Successfully fetched trending gifs\", {\n                count: response.gifs?.length || 0\n            });\n            return response.gifs || [];\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to fetch trending gifs\", {\n                count,\n                error\n            });\n            throw error;\n        }\n    }\n    /**\n   * Validate and process RedGifs URL for upload\n   */ async processRedGifsUrl(url) {\n        try {\n            const metadata = await this.getMetadataFromUrl(url);\n            const gifId = this.extractGifId(url);\n            // Use direct gif URL for better embedding experience\n            const embedUrl = this.getDirectGifUrl(metadata);\n            return {\n                embedUrl,\n                thumbnail: this.getThumbnailUrl(gifId),\n                metadata,\n                tags: metadata.tags || []\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to process RedGifs URL\", {\n                url,\n                error\n            });\n            throw error;\n        }\n    }\n    constructor(){\n        this.BASE_URL = \"https://api.redgifs.com/v2\";\n        this.token = null;\n        this.tokenExpiry = 0;\n    }\n}\nconst redGifsService = new RedGifsService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmljZXMvcmVkZ2lmcy5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFxQztBQUNtQjtBQTZCeEQsTUFBTUc7SUFLSjs7R0FFQyxHQUNELE1BQWNDLFdBQTRCO1FBQ3hDLHdDQUF3QztRQUN4QyxJQUFJLElBQUksQ0FBQ0MsS0FBSyxJQUFJQyxLQUFLQyxHQUFHLEtBQUssSUFBSSxDQUFDQyxXQUFXLEVBQUU7WUFDL0MsT0FBTyxJQUFJLENBQUNILEtBQUs7UUFDbkI7UUFFQSxJQUFJO1lBQ0ZMLCtDQUFNQSxDQUFDUyxJQUFJLENBQUM7WUFFWixNQUFNQyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQ0MsUUFBUSxDQUFDLGVBQWUsQ0FBQyxFQUFFO2dCQUM5REMsUUFBUTtnQkFDUkMsU0FBUztvQkFDUCxnQkFBZ0I7Z0JBQ2xCO1lBQ0Y7WUFFQSxJQUFJLENBQUNKLFNBQVNLLEVBQUUsRUFBRTtnQkFDaEIsTUFBTSxJQUFJYixpREFBUUEsQ0FBQyxDQUFDLDZCQUE2QixFQUFFUSxTQUFTTSxNQUFNLENBQUMsQ0FBQztZQUN0RTtZQUVBLE1BQU1DLE9BQU8sTUFBTVAsU0FBU1EsSUFBSTtZQUVoQyxJQUFJLENBQUNELEtBQUtaLEtBQUssRUFBRTtnQkFDZixNQUFNLElBQUlILGlEQUFRQSxDQUFDO1lBQ3JCO1lBRUEsSUFBSSxDQUFDRyxLQUFLLEdBQUdZLEtBQUtaLEtBQUs7WUFDdkIsaUZBQWlGO1lBQ2pGLElBQUksQ0FBQ0csV0FBVyxHQUFHRixLQUFLQyxHQUFHLEtBQU0sS0FBSyxLQUFLO1lBRTNDUCwrQ0FBTUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQ1osT0FBTyxJQUFJLENBQUNKLEtBQUs7UUFDbkIsRUFBRSxPQUFPYyxPQUFPO1lBQ2RuQiwrQ0FBTUEsQ0FBQ21CLEtBQUssQ0FBQywrQkFBK0I7Z0JBQUVBO1lBQU07WUFDcEQsTUFBTSxJQUFJakIsaURBQVFBLENBQUM7UUFDckI7SUFDRjtJQUVBOztHQUVDLEdBQ0QsTUFBY2tCLFlBQWVDLFFBQWdCLEVBQUVDLFVBQXVCLENBQUMsQ0FBQyxFQUFjO1FBQ3BGLE1BQU1qQixRQUFRLE1BQU0sSUFBSSxDQUFDRCxRQUFRO1FBRWpDLE1BQU1NLFdBQVcsTUFBTUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxDQUFDQyxRQUFRLENBQUMsRUFBRVMsU0FBUyxDQUFDLEVBQUU7WUFDMUQsR0FBR0MsT0FBTztZQUNWUixTQUFTO2dCQUNQLGlCQUFpQixDQUFDLE9BQU8sRUFBRVQsTUFBTSxDQUFDO2dCQUNsQyxnQkFBZ0I7Z0JBQ2hCLEdBQUdpQixRQUFRUixPQUFPO1lBQ3BCO1FBQ0Y7UUFFQSxJQUFJLENBQUNKLFNBQVNLLEVBQUUsRUFBRTtZQUNoQixNQUFNUSxZQUFZLE1BQU1iLFNBQVNjLElBQUk7WUFDckN4QiwrQ0FBTUEsQ0FBQ21CLEtBQUssQ0FBQyxxQkFBcUI7Z0JBQ2hDRTtnQkFDQUwsUUFBUU4sU0FBU00sTUFBTTtnQkFDdkJHLE9BQU9JO1lBQ1Q7WUFDQSxNQUFNLElBQUlyQixpREFBUUEsQ0FBQyxDQUFDLG1CQUFtQixFQUFFUSxTQUFTTSxNQUFNLENBQUMsR0FBRyxFQUFFTyxVQUFVLENBQUM7UUFDM0U7UUFFQSxPQUFPYixTQUFTUSxJQUFJO0lBQ3RCO0lBRUE7O0dBRUMsR0FDRCxhQUFvQlEsR0FBVyxFQUFVO1FBQ3ZDLE1BQU1DLFdBQVc7WUFDZjtZQUNBO1lBQ0E7WUFDQTtTQUNEO1FBRUQsS0FBSyxNQUFNQyxXQUFXRCxTQUFVO1lBQzlCLE1BQU1FLFFBQVFILElBQUlHLEtBQUssQ0FBQ0Q7WUFDeEIsSUFBSUMsU0FBU0EsS0FBSyxDQUFDLEVBQUUsRUFBRTtnQkFDckIsT0FBT0EsS0FBSyxDQUFDLEVBQUUsQ0FBQ0MsV0FBVztZQUM3QjtRQUNGO1FBRUEsTUFBTSxJQUFJN0Isd0RBQWVBLENBQUM7SUFDNUI7SUFFQTs7R0FFQyxHQUNELGFBQW9CeUIsR0FBVyxFQUFXO1FBQ3hDLE9BQU9BLElBQUlNLFFBQVEsQ0FBQyxrQkFBa0JOLElBQUlNLFFBQVEsQ0FBQztJQUNyRDtJQUVBOztHQUVDLEdBQ0QsTUFBYUMsZUFBZUMsS0FBYSxFQUEyQjtRQUNsRSxJQUFJO1lBQ0ZsQywrQ0FBTUEsQ0FBQ1MsSUFBSSxDQUFDLDZCQUE2QjtnQkFBRXlCO1lBQU07WUFFakQsTUFBTXhCLFdBQVcsTUFBTSxJQUFJLENBQUNVLFdBQVcsQ0FBMEIsQ0FBQyxNQUFNLEVBQUVjLE1BQU0sQ0FBQztZQUVqRixJQUFJLENBQUN4QixTQUFTeUIsR0FBRyxFQUFFO2dCQUNqQixNQUFNLElBQUlsQyx3REFBZUEsQ0FBQztZQUM1QjtZQUVBRCwrQ0FBTUEsQ0FBQ1MsSUFBSSxDQUFDLHlDQUF5QztnQkFDbkR5QjtnQkFDQUUsT0FBTzFCLFNBQVN5QixHQUFHLENBQUNDLEtBQUs7Z0JBQ3pCQyxNQUFNM0IsU0FBU3lCLEdBQUcsQ0FBQ0UsSUFBSSxFQUFFQyxVQUFVO1lBQ3JDO1lBRUEsT0FBTzVCLFNBQVN5QixHQUFHO1FBQ3JCLEVBQUUsT0FBT2hCLE9BQU87WUFDZG5CLCtDQUFNQSxDQUFDbUIsS0FBSyxDQUFDLG9DQUFvQztnQkFBRWU7Z0JBQU9mO1lBQU07WUFDaEUsTUFBTUE7UUFDUjtJQUNGO0lBRUE7O0dBRUMsR0FDRCxNQUFhb0IsbUJBQW1CYixHQUFXLEVBQTJCO1FBQ3BFLElBQUksQ0FBQyxJQUFJLENBQUNLLFlBQVksQ0FBQ0wsTUFBTTtZQUMzQixNQUFNLElBQUl6Qix3REFBZUEsQ0FBQztRQUM1QjtRQUVBLE1BQU1pQyxRQUFRLElBQUksQ0FBQ1QsWUFBWSxDQUFDQztRQUNoQyxPQUFPLElBQUksQ0FBQ08sY0FBYyxDQUFDQztJQUM3QjtJQUVBOzs7R0FHQyxHQUNELFlBQW1CQSxLQUFhLEVBQVU7UUFDeEMscURBQXFEO1FBQ3JELE9BQU8sQ0FBQyw0QkFBNEIsRUFBRUEsTUFBTSxTQUFTLENBQUM7SUFDeEQ7SUFFQTs7R0FFQyxHQUNELGdCQUF1QlEsUUFBd0IsRUFBVTtRQUN2RCw0RUFBNEU7UUFDNUUsT0FBT0EsU0FBU0MsSUFBSSxFQUFFQyxNQUFNRixTQUFTQyxJQUFJLEVBQUVFLE1BQU0sSUFBSSxDQUFDTCxXQUFXLENBQUNFLFNBQVNJLEVBQUU7SUFDL0U7SUFFQTs7R0FFQyxHQUNELGdCQUF1QlosS0FBYSxFQUFVO1FBQzVDLE9BQU8sQ0FBQyw0QkFBNEIsRUFBRUEsTUFBTSxXQUFXLENBQUM7SUFDMUQ7SUFFQTs7R0FFQyxHQUNELE1BQWFjLFdBQVdDLEtBQWEsRUFBRTNCLFVBSW5DLENBQUMsQ0FBQyxFQUErQjtRQUNuQyxJQUFJO1lBQ0YsTUFBTSxFQUFFNEIsT0FBTyxDQUFDLEVBQUVDLFFBQVEsRUFBRSxFQUFFQyxRQUFRLFVBQVUsRUFBRSxHQUFHOUI7WUFFckQsTUFBTStCLFNBQVMsSUFBSUMsZ0JBQWdCO2dCQUNqQ0MsYUFBYU47Z0JBQ2JHO2dCQUNBRCxPQUFPQSxNQUFNSyxRQUFRO2dCQUNyQk4sTUFBTUEsS0FBS00sUUFBUTtZQUNyQjtZQUVBeEQsK0NBQU1BLENBQUNTLElBQUksQ0FBQyxxQkFBcUI7Z0JBQUV3QztnQkFBTzNCO1lBQVE7WUFFbEQsTUFBTVosV0FBVyxNQUFNLElBQUksQ0FBQ1UsV0FBVyxDQUlwQyxDQUFDLGFBQWEsRUFBRWlDLE9BQU8sQ0FBQztZQUUzQnJELCtDQUFNQSxDQUFDUyxJQUFJLENBQUMsNEJBQTRCO2dCQUN0Q3dDO2dCQUNBUSxTQUFTL0MsU0FBU2dELElBQUksRUFBRXBCLFVBQVU7Z0JBQ2xDcUIsT0FBT2pELFNBQVNpRCxLQUFLO1lBQ3ZCO1lBRUEsT0FBTztnQkFDTEQsTUFBTWhELFNBQVNnRCxJQUFJLElBQUksRUFBRTtnQkFDekJDLE9BQU9qRCxTQUFTaUQsS0FBSyxJQUFJO2dCQUN6QlQsTUFBTXhDLFNBQVN3QyxJQUFJLElBQUlBO1lBQ3pCO1FBQ0YsRUFBRSxPQUFPL0IsT0FBTztZQUNkbkIsK0NBQU1BLENBQUNtQixLQUFLLENBQUMsNEJBQTRCO2dCQUFFOEI7Z0JBQU8zQjtnQkFBU0g7WUFBTTtZQUNqRSxNQUFNQTtRQUNSO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWF5QyxnQkFBZ0JULFFBQWdCLEVBQUUsRUFBNkI7UUFDMUUsSUFBSTtZQUNGbkQsK0NBQU1BLENBQUNTLElBQUksQ0FBQyw2QkFBNkI7Z0JBQUUwQztZQUFNO1lBRWpELE1BQU16QyxXQUFXLE1BQU0sSUFBSSxDQUFDVSxXQUFXLENBQTZCLENBQUMscUJBQXFCLEVBQUUrQixNQUFNLENBQUM7WUFFbkduRCwrQ0FBTUEsQ0FBQ1MsSUFBSSxDQUFDLHNDQUFzQztnQkFDaEQwQyxPQUFPekMsU0FBU2dELElBQUksRUFBRXBCLFVBQVU7WUFDbEM7WUFFQSxPQUFPNUIsU0FBU2dELElBQUksSUFBSSxFQUFFO1FBQzVCLEVBQUUsT0FBT3ZDLE9BQU87WUFDZG5CLCtDQUFNQSxDQUFDbUIsS0FBSyxDQUFDLGlDQUFpQztnQkFBRWdDO2dCQUFPaEM7WUFBTTtZQUM3RCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWEwQyxrQkFBa0JuQyxHQUFXLEVBS3ZDO1FBQ0QsSUFBSTtZQUNGLE1BQU1nQixXQUFXLE1BQU0sSUFBSSxDQUFDSCxrQkFBa0IsQ0FBQ2I7WUFDL0MsTUFBTVEsUUFBUSxJQUFJLENBQUNULFlBQVksQ0FBQ0M7WUFFaEMscURBQXFEO1lBQ3JELE1BQU1vQyxXQUFXLElBQUksQ0FBQ3JCLGVBQWUsQ0FBQ0M7WUFFdEMsT0FBTztnQkFDTG9CO2dCQUNBQyxXQUFXLElBQUksQ0FBQ2hCLGVBQWUsQ0FBQ2I7Z0JBQ2hDUTtnQkFDQUwsTUFBTUssU0FBU0wsSUFBSSxJQUFJLEVBQUU7WUFDM0I7UUFDRixFQUFFLE9BQU9sQixPQUFPO1lBQ2RuQiwrQ0FBTUEsQ0FBQ21CLEtBQUssQ0FBQyxpQ0FBaUM7Z0JBQUVPO2dCQUFLUDtZQUFNO1lBQzNELE1BQU1BO1FBQ1I7SUFDRjs7YUE1UGlCUCxXQUFXO2FBQ3BCUCxRQUF1QjthQUN2QkcsY0FBc0I7O0FBMlBoQztBQUVPLE1BQU13RCxpQkFBaUIsSUFBSTdELGlCQUFnQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JhdGVteS1uZXh0anMvLi9zcmMvc2VydmljZXMvcmVkZ2lmcy5zZXJ2aWNlLnRzP2YzMTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQC9saWIvbG9nZ2VyJ1xuaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9yLCBBUElFcnJvciB9IGZyb20gJ0AvbGliL2Vycm9ycydcblxuZXhwb3J0IGludGVyZmFjZSBSZWRHaWZNZXRhZGF0YSB7XG4gIGlkOiBzdHJpbmdcbiAgdGl0bGU6IHN0cmluZ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICB0YWdzOiBzdHJpbmdbXVxuICBkdXJhdGlvbjogbnVtYmVyXG4gIHdpZHRoOiBudW1iZXJcbiAgaGVpZ2h0OiBudW1iZXJcbiAgdXJsczoge1xuICAgIGhkOiBzdHJpbmdcbiAgICBzZDogc3RyaW5nXG4gICAgcG9zdGVyOiBzdHJpbmdcbiAgfVxuICB2aWV3czogbnVtYmVyXG4gIGxpa2VzOiBudW1iZXJcbiAgdXNlck5hbWU6IHN0cmluZ1xuICBjcmVhdGVEYXRlOiBudW1iZXJcbiAgdHlwZTogbnVtYmVyXG4gIGF2Z0NvbG9yOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZWRHaWZTZWFyY2hSZXN1bHQge1xuICBnaWZzOiBSZWRHaWZNZXRhZGF0YVtdXG4gIHRvdGFsOiBudW1iZXJcbiAgcGFnZTogbnVtYmVyXG59XG5cbmNsYXNzIFJlZEdpZnNTZXJ2aWNlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBCQVNFX1VSTCA9ICdodHRwczovL2FwaS5yZWRnaWZzLmNvbS92MidcbiAgcHJpdmF0ZSB0b2tlbjogc3RyaW5nIHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSB0b2tlbkV4cGlyeTogbnVtYmVyID0gMFxuXG4gIC8qKlxuICAgKiBHZXQgdGVtcG9yYXJ5IHRva2VuIGZvciBBUEkgYWNjZXNzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFRva2VuKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgLy8gQ2hlY2sgaWYgY3VycmVudCB0b2tlbiBpcyBzdGlsbCB2YWxpZFxuICAgIGlmICh0aGlzLnRva2VuICYmIERhdGUubm93KCkgPCB0aGlzLnRva2VuRXhwaXJ5KSB7XG4gICAgICByZXR1cm4gdGhpcy50b2tlblxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBsb2dnZXIuaW5mbygnUmVxdWVzdGluZyBuZXcgUmVkR2lmcyBBUEkgdG9rZW4nKVxuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuQkFTRV9VUkx9L2F1dGgvdGVtcG9yYXJ5YCwge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pXG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKGBGYWlsZWQgdG8gZ2V0IFJlZEdpZnMgdG9rZW46ICR7cmVzcG9uc2Uuc3RhdHVzfWApXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIFxuICAgICAgaWYgKCFkYXRhLnRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcignTm8gdG9rZW4gcmV0dXJuZWQgZnJvbSBSZWRHaWZzIEFQSScpXG4gICAgICB9XG5cbiAgICAgIHRoaXMudG9rZW4gPSBkYXRhLnRva2VuXG4gICAgICAvLyBTZXQgZXhwaXJ5IHRvIDEgaG91ciBmcm9tIG5vdyAodG9rZW5zIHR5cGljYWxseSBsYXN0IDI0aCBidXQgd2UgcmVmcmVzaCBlYXJseSlcbiAgICAgIHRoaXMudG9rZW5FeHBpcnkgPSBEYXRlLm5vdygpICsgKDYwICogNjAgKiAxMDAwKVxuICAgICAgXG4gICAgICBsb2dnZXIuaW5mbygnU3VjY2Vzc2Z1bGx5IG9idGFpbmVkIFJlZEdpZnMgQVBJIHRva2VuJylcbiAgICAgIHJldHVybiB0aGlzLnRva2VuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBSZWRHaWZzIHRva2VuJywgeyBlcnJvciB9KVxuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKCdGYWlsZWQgdG8gYXV0aGVudGljYXRlIHdpdGggUmVkR2lmcyBBUEknKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNYWtlIGF1dGhlbnRpY2F0ZWQgcmVxdWVzdCB0byBSZWRHaWZzIEFQSVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBtYWtlUmVxdWVzdDxUPihlbmRwb2ludDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KTogUHJvbWlzZTxUPiB7XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCB0aGlzLmdldFRva2VuKClcbiAgICBcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuQkFTRV9VUkx9JHtlbmRwb2ludH1gLCB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbn1gLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcbiAgICAgIGxvZ2dlci5lcnJvcignUmVkR2lmcyBBUEkgZXJyb3InLCB7IFxuICAgICAgICBlbmRwb2ludCwgXG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLCBcbiAgICAgICAgZXJyb3I6IGVycm9yVGV4dCBcbiAgICAgIH0pXG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoYFJlZEdpZnMgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gLSAke2Vycm9yVGV4dH1gKVxuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZS5qc29uKClcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHRyYWN0IFJlZEdpZnMgSUQgZnJvbSBVUkxcbiAgICovXG4gIHB1YmxpYyBleHRyYWN0R2lmSWQodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhdHRlcm5zID0gW1xuICAgICAgL3JlZGdpZnNcXC5jb21cXC93YXRjaFxcLyhbYS16QS1aMC05XSspLyxcbiAgICAgIC9yZWRnaWZzXFwuY29tXFwvaWZyXFwvKFthLXpBLVowLTldKykvLFxuICAgICAgL3JlZGdpZnNcXC5jb21cXC8oW2EtekEtWjAtOV0rKSQvLFxuICAgICAgL1xcLyhbYS16QS1aMC05XSspJC9cbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgIGNvbnN0IG1hdGNoID0gdXJsLm1hdGNoKHBhdHRlcm4pXG4gICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRvTG93ZXJDYXNlKClcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdJbnZhbGlkIFJlZEdpZnMgVVJMIGZvcm1hdCcpXG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgVVJMIGlzIGEgUmVkR2lmcyBVUkxcbiAgICovXG4gIHB1YmxpYyBpc1JlZEdpZnNVcmwodXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdXJsLmluY2x1ZGVzKCdyZWRnaWZzLmNvbScpIHx8IHVybC5pbmNsdWRlcygncmVkZ2lmcy5jb20nKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBtZXRhZGF0YSBmb3IgYSBzcGVjaWZpYyBnaWYgYnkgSURcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRHaWZNZXRhZGF0YShnaWZJZDogc3RyaW5nKTogUHJvbWlzZTxSZWRHaWZNZXRhZGF0YT4ge1xuICAgIHRyeSB7XG4gICAgICBsb2dnZXIuaW5mbygnRmV0Y2hpbmcgUmVkR2lmcyBtZXRhZGF0YScsIHsgZ2lmSWQgfSlcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0PHsgZ2lmOiBSZWRHaWZNZXRhZGF0YSB9PihgL2dpZnMvJHtnaWZJZH1gKVxuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLmdpZikge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdHaWYgbm90IGZvdW5kJylcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ1N1Y2Nlc3NmdWxseSBmZXRjaGVkIFJlZEdpZnMgbWV0YWRhdGEnLCB7IFxuICAgICAgICBnaWZJZCwgXG4gICAgICAgIHRpdGxlOiByZXNwb25zZS5naWYudGl0bGUsXG4gICAgICAgIHRhZ3M6IHJlc3BvbnNlLmdpZi50YWdzPy5sZW5ndGggfHwgMFxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmdpZlxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBSZWRHaWZzIG1ldGFkYXRhJywgeyBnaWZJZCwgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBtZXRhZGF0YSBmcm9tIFJlZEdpZnMgVVJMXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0TWV0YWRhdGFGcm9tVXJsKHVybDogc3RyaW5nKTogUHJvbWlzZTxSZWRHaWZNZXRhZGF0YT4ge1xuICAgIGlmICghdGhpcy5pc1JlZEdpZnNVcmwodXJsKSkge1xuICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignVVJMIGlzIG5vdCBhIFJlZEdpZnMgVVJMJylcbiAgICB9XG5cbiAgICBjb25zdCBnaWZJZCA9IHRoaXMuZXh0cmFjdEdpZklkKHVybClcbiAgICByZXR1cm4gdGhpcy5nZXRHaWZNZXRhZGF0YShnaWZJZClcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IFJlZEdpZnMgVVJMIHRvIGVtYmVkIGZvcm1hdFxuICAgKiBSZXR1cm5zIHRoZSBpZnJhbWUgVVJMIHRoYXQgc2hvd3MganVzdCB0aGUgZ2lmIHdpdGhvdXQgdGhlIGZ1bGwgd2Vic2l0ZSBpbnRlcmZhY2VcbiAgICovXG4gIHB1YmxpYyBnZXRFbWJlZFVybChnaWZJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBVc2UgdGhlIGlmcmFtZSBVUkwgdGhhdCBzaG93cyBvbmx5IHRoZSBnaWYgY29udGVudFxuICAgIHJldHVybiBgaHR0cHM6Ly93d3cucmVkZ2lmcy5jb20vaWZyLyR7Z2lmSWR9P3Bvc3Rlcj0wYFxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkaXJlY3QgZ2lmIFVSTCBmcm9tIG1ldGFkYXRhXG4gICAqL1xuICBwdWJsaWMgZ2V0RGlyZWN0R2lmVXJsKG1ldGFkYXRhOiBSZWRHaWZNZXRhZGF0YSk6IHN0cmluZyB7XG4gICAgLy8gUmV0dXJuIHRoZSBIRCBVUkwgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgU0QsIG90aGVyd2lzZSBmYWxsYmFjayB0byBlbWJlZFxuICAgIHJldHVybiBtZXRhZGF0YS51cmxzPy5oZCB8fCBtZXRhZGF0YS51cmxzPy5zZCB8fCB0aGlzLmdldEVtYmVkVXJsKG1ldGFkYXRhLmlkKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aHVtYm5haWwgVVJMIGZvciBhIGdpZlxuICAgKi9cbiAgcHVibGljIGdldFRodW1ibmFpbFVybChnaWZJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGh0dHBzOi8vdGh1bWJzNC5yZWRnaWZzLmNvbS8ke2dpZklkfS1wb3N0ZXIuanBnYFxuICB9XG5cbiAgLyoqXG4gICAqIFNlYXJjaCBmb3IgZ2lmcyBieSB0YWdzIG9yIHF1ZXJ5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2VhcmNoR2lmcyhxdWVyeTogc3RyaW5nLCBvcHRpb25zOiB7XG4gICAgcGFnZT86IG51bWJlclxuICAgIGNvdW50PzogbnVtYmVyXG4gICAgb3JkZXI/OiAndHJlbmRpbmcnIHwgJ2xhdGVzdCcgfCAndG9wJ1xuICB9ID0ge30pOiBQcm9taXNlPFJlZEdpZlNlYXJjaFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHBhZ2UgPSAxLCBjb3VudCA9IDIwLCBvcmRlciA9ICd0cmVuZGluZycgfSA9IG9wdGlvbnNcbiAgICAgIFxuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIHNlYXJjaF90ZXh0OiBxdWVyeSxcbiAgICAgICAgb3JkZXIsXG4gICAgICAgIGNvdW50OiBjb3VudC50b1N0cmluZygpLFxuICAgICAgICBwYWdlOiBwYWdlLnRvU3RyaW5nKCksXG4gICAgICB9KVxuXG4gICAgICBsb2dnZXIuaW5mbygnU2VhcmNoaW5nIFJlZEdpZnMnLCB7IHF1ZXJ5LCBvcHRpb25zIH0pXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdDx7XG4gICAgICAgIGdpZnM6IFJlZEdpZk1ldGFkYXRhW11cbiAgICAgICAgdG90YWw6IG51bWJlclxuICAgICAgICBwYWdlOiBudW1iZXJcbiAgICAgIH0+KGAvZ2lmcy9zZWFyY2g/JHtwYXJhbXN9YClcblxuICAgICAgbG9nZ2VyLmluZm8oJ1JlZEdpZnMgc2VhcmNoIGNvbXBsZXRlZCcsIHsgXG4gICAgICAgIHF1ZXJ5LCBcbiAgICAgICAgcmVzdWx0czogcmVzcG9uc2UuZ2lmcz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgIHRvdGFsOiByZXNwb25zZS50b3RhbCBcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGdpZnM6IHJlc3BvbnNlLmdpZnMgfHwgW10sXG4gICAgICAgIHRvdGFsOiByZXNwb25zZS50b3RhbCB8fCAwLFxuICAgICAgICBwYWdlOiByZXNwb25zZS5wYWdlIHx8IHBhZ2UsXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHNlYXJjaCBSZWRHaWZzJywgeyBxdWVyeSwgb3B0aW9ucywgZXJyb3IgfSlcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0cmVuZGluZyBnaWZzXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0VHJlbmRpbmdHaWZzKGNvdW50OiBudW1iZXIgPSAxMCk6IFByb21pc2U8UmVkR2lmTWV0YWRhdGFbXT4ge1xuICAgIHRyeSB7XG4gICAgICBsb2dnZXIuaW5mbygnRmV0Y2hpbmcgdHJlbmRpbmcgUmVkR2lmcycsIHsgY291bnQgfSlcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0PHsgZ2lmczogUmVkR2lmTWV0YWRhdGFbXSB9PihgL2dpZnMvdHJlbmRpbmc/Y291bnQ9JHtjb3VudH1gKVxuICAgICAgXG4gICAgICBsb2dnZXIuaW5mbygnU3VjY2Vzc2Z1bGx5IGZldGNoZWQgdHJlbmRpbmcgZ2lmcycsIHsgXG4gICAgICAgIGNvdW50OiByZXNwb25zZS5naWZzPy5sZW5ndGggfHwgMCBcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiByZXNwb25zZS5naWZzIHx8IFtdXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGZldGNoIHRyZW5kaW5nIGdpZnMnLCB7IGNvdW50LCBlcnJvciB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgYW5kIHByb2Nlc3MgUmVkR2lmcyBVUkwgZm9yIHVwbG9hZFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHByb2Nlc3NSZWRHaWZzVXJsKHVybDogc3RyaW5nKTogUHJvbWlzZTx7XG4gICAgZW1iZWRVcmw6IHN0cmluZ1xuICAgIHRodW1ibmFpbDogc3RyaW5nXG4gICAgbWV0YWRhdGE6IFJlZEdpZk1ldGFkYXRhXG4gICAgdGFnczogc3RyaW5nW11cbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IHRoaXMuZ2V0TWV0YWRhdGFGcm9tVXJsKHVybClcbiAgICAgIGNvbnN0IGdpZklkID0gdGhpcy5leHRyYWN0R2lmSWQodXJsKVxuXG4gICAgICAvLyBVc2UgZGlyZWN0IGdpZiBVUkwgZm9yIGJldHRlciBlbWJlZGRpbmcgZXhwZXJpZW5jZVxuICAgICAgY29uc3QgZW1iZWRVcmwgPSB0aGlzLmdldERpcmVjdEdpZlVybChtZXRhZGF0YSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZW1iZWRVcmwsXG4gICAgICAgIHRodW1ibmFpbDogdGhpcy5nZXRUaHVtYm5haWxVcmwoZ2lmSWQpLFxuICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgdGFnczogbWV0YWRhdGEudGFncyB8fCBbXVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBwcm9jZXNzIFJlZEdpZnMgVVJMJywgeyB1cmwsIGVycm9yIH0pXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmVkR2lmc1NlcnZpY2UgPSBuZXcgUmVkR2lmc1NlcnZpY2UoKSJdLCJuYW1lcyI6WyJsb2dnZXIiLCJWYWxpZGF0aW9uRXJyb3IiLCJBUElFcnJvciIsIlJlZEdpZnNTZXJ2aWNlIiwiZ2V0VG9rZW4iLCJ0b2tlbiIsIkRhdGUiLCJub3ciLCJ0b2tlbkV4cGlyeSIsImluZm8iLCJyZXNwb25zZSIsImZldGNoIiwiQkFTRV9VUkwiLCJtZXRob2QiLCJoZWFkZXJzIiwib2siLCJzdGF0dXMiLCJkYXRhIiwianNvbiIsImVycm9yIiwibWFrZVJlcXVlc3QiLCJlbmRwb2ludCIsIm9wdGlvbnMiLCJlcnJvclRleHQiLCJ0ZXh0IiwiZXh0cmFjdEdpZklkIiwidXJsIiwicGF0dGVybnMiLCJwYXR0ZXJuIiwibWF0Y2giLCJ0b0xvd2VyQ2FzZSIsImlzUmVkR2lmc1VybCIsImluY2x1ZGVzIiwiZ2V0R2lmTWV0YWRhdGEiLCJnaWZJZCIsImdpZiIsInRpdGxlIiwidGFncyIsImxlbmd0aCIsImdldE1ldGFkYXRhRnJvbVVybCIsImdldEVtYmVkVXJsIiwiZ2V0RGlyZWN0R2lmVXJsIiwibWV0YWRhdGEiLCJ1cmxzIiwiaGQiLCJzZCIsImlkIiwiZ2V0VGh1bWJuYWlsVXJsIiwic2VhcmNoR2lmcyIsInF1ZXJ5IiwicGFnZSIsImNvdW50Iiwib3JkZXIiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJzZWFyY2hfdGV4dCIsInRvU3RyaW5nIiwicmVzdWx0cyIsImdpZnMiLCJ0b3RhbCIsImdldFRyZW5kaW5nR2lmcyIsInByb2Nlc3NSZWRHaWZzVXJsIiwiZW1iZWRVcmwiLCJ0aHVtYm5haWwiLCJyZWRHaWZzU2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/services/redgifs.service.ts\n");

/***/ }),

/***/ "(api)/./src/services/video-metadata.service.ts":
/*!************************************************!*\
  !*** ./src/services/video-metadata.service.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VideoMetadataService: () => (/* binding */ VideoMetadataService),\n/* harmony export */   videoMetadataService: () => (/* binding */ videoMetadataService)\n/* harmony export */ });\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n\nclass VideoMetadataService {\n    async extractMetadata(originalUrl) {\n        try {\n            // Check for direct video file URLs\n            if (this.isDirectVideoFile(originalUrl)) {\n                return this.extractDirectVideoMetadata(originalUrl);\n            }\n            // Try to match against supported platforms\n            for (const [platform, config] of Object.entries(this.supportedPlatforms)){\n                for (const pattern of config.patterns){\n                    const match = originalUrl.match(pattern);\n                    if (match) {\n                        const videoId = match[1];\n                        _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(`Extracting metadata for ${platform}`, {\n                            videoId,\n                            originalUrl\n                        });\n                        return await config.extract(videoId);\n                    }\n                }\n            }\n            // Try generic oEmbed extraction\n            const oEmbedResult = await this.extractOEmbedMetadata(originalUrl);\n            if (oEmbedResult) {\n                return oEmbedResult;\n            }\n            // Fallback to URL-based extraction\n            return this.extractFallbackMetadata(originalUrl);\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting video metadata\", {\n                originalUrl,\n                error\n            });\n            return this.extractFallbackMetadata(originalUrl);\n        }\n    }\n    isDirectVideoFile(url) {\n        const videoExtensions = [\n            \".mp4\",\n            \".mov\",\n            \".avi\",\n            \".mkv\",\n            \".webm\",\n            \".flv\",\n            \".wmv\",\n            \".m4v\"\n        ];\n        const urlPath = new URL(url).pathname.toLowerCase();\n        return videoExtensions.some((ext)=>urlPath.endsWith(ext));\n    }\n    extractDirectVideoMetadata(originalUrl) {\n        const url = new URL(originalUrl);\n        const filename = url.pathname.split(\"/\").pop() || \"video\";\n        const title = filename.replace(/\\.[^/.]+$/, \"\").replace(/[-_]/g, \" \");\n        return {\n            title: this.titleCase(title),\n            description: `Direct video file: ${filename}`,\n            tags: [\n                \"video\",\n                \"direct-upload\"\n            ],\n            platform: \"direct\",\n            thumbnail: undefined\n        };\n    }\n    async extractYouTubeMetadata(videoId) {\n        try {\n            // Use YouTube oEmbed API for basic metadata\n            const response = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`);\n            if (!response.ok) {\n                throw new Error(`YouTube API error: ${response.status}`);\n            }\n            const data = await response.json();\n            // Extract tags from title and description using keywords\n            const tags = this.extractTagsFromText(`${data.title} ${data.author_name}`);\n            return {\n                title: data.title || `YouTube Video ${videoId}`,\n                description: `Video by ${data.author_name}`,\n                tags,\n                thumbnail: data.thumbnail_url\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting YouTube metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `YouTube Video ${videoId}`,\n                description: \"\",\n                tags: [\n                    \"youtube\"\n                ],\n                thumbnail: `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`\n            };\n        }\n    }\n    async extractVimeoMetadata(videoId) {\n        try {\n            // Use Vimeo oEmbed API\n            const response = await fetch(`https://vimeo.com/api/oembed.json?url=https://vimeo.com/${videoId}`);\n            if (!response.ok) {\n                throw new Error(`Vimeo API error: ${response.status}`);\n            }\n            const data = await response.json();\n            // Extract tags from title and author\n            const tags = this.extractTagsFromText(`${data.title} ${data.author_name}`);\n            return {\n                title: data.title || `Vimeo Video ${videoId}`,\n                description: data.description || `Video by ${data.author_name}`,\n                tags,\n                thumbnail: data.thumbnail_url,\n                duration: data.duration\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting Vimeo metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `Vimeo Video ${videoId}`,\n                description: \"\",\n                tags: [\n                    \"vimeo\"\n                ]\n            };\n        }\n    }\n    async extractTikTokMetadata(videoId) {\n        try {\n            // TikTok doesn't have a public API, so we'll use URL parsing and generic extraction\n            const url = `https://www.tiktok.com/@user/video/${videoId}`;\n            const oEmbedResult = await this.extractOEmbedMetadata(url);\n            if (oEmbedResult) {\n                return {\n                    ...oEmbedResult,\n                    platform: \"tiktok\",\n                    tags: [\n                        ...oEmbedResult.tags || [],\n                        \"tiktok\",\n                        \"short-form\"\n                    ]\n                };\n            }\n            return {\n                title: `TikTok Video ${videoId}`,\n                description: \"TikTok short-form video content\",\n                tags: [\n                    \"tiktok\",\n                    \"short-form\",\n                    \"social\"\n                ],\n                platform: \"tiktok\"\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting TikTok metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `TikTok Video ${videoId}`,\n                description: \"TikTok short-form video content\",\n                tags: [\n                    \"tiktok\",\n                    \"short-form\"\n                ],\n                platform: \"tiktok\"\n            };\n        }\n    }\n    async extractInstagramMetadata(videoId) {\n        try {\n            // Instagram oEmbed API\n            const url = `https://www.instagram.com/p/${videoId}/`;\n            const response = await fetch(`https://graph.facebook.com/v8.0/instagram_oembed?url=${encodeURIComponent(url)}&access_token=your_token`);\n            // Since we don't have an access token, fall back to URL parsing\n            const oEmbedResult = await this.extractOEmbedMetadata(url);\n            if (oEmbedResult) {\n                return {\n                    ...oEmbedResult,\n                    platform: \"instagram\",\n                    tags: [\n                        ...oEmbedResult.tags || [],\n                        \"instagram\",\n                        \"social\"\n                    ]\n                };\n            }\n            return {\n                title: `Instagram Video ${videoId}`,\n                description: \"Instagram video content\",\n                tags: [\n                    \"instagram\",\n                    \"social\",\n                    \"video\"\n                ],\n                platform: \"instagram\"\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting Instagram metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `Instagram Video ${videoId}`,\n                description: \"Instagram video content\",\n                tags: [\n                    \"instagram\",\n                    \"social\"\n                ],\n                platform: \"instagram\"\n            };\n        }\n    }\n    async extractTwitterMetadata(videoId) {\n        try {\n            // Twitter oEmbed API\n            const url = `https://twitter.com/user/status/${videoId}`;\n            const response = await fetch(`https://publish.twitter.com/oembed?url=${encodeURIComponent(url)}`);\n            if (response.ok) {\n                const data = await response.json();\n                const tags = this.extractTagsFromText(data.html || \"\");\n                return {\n                    title: data.title || `Twitter Video ${videoId}`,\n                    description: \"Twitter video content\",\n                    tags: [\n                        ...tags,\n                        \"twitter\",\n                        \"social\"\n                    ],\n                    platform: \"twitter\"\n                };\n            }\n            return {\n                title: `Twitter Video ${videoId}`,\n                description: \"Twitter video content\",\n                tags: [\n                    \"twitter\",\n                    \"social\",\n                    \"video\"\n                ],\n                platform: \"twitter\"\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting Twitter metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `Twitter Video ${videoId}`,\n                description: \"Twitter video content\",\n                tags: [\n                    \"twitter\",\n                    \"social\"\n                ],\n                platform: \"twitter\"\n            };\n        }\n    }\n    async extractDailymotionMetadata(videoId) {\n        try {\n            // Dailymotion oEmbed API\n            const response = await fetch(`https://www.dailymotion.com/services/oembed?url=https://www.dailymotion.com/video/${videoId}&format=json`);\n            if (response.ok) {\n                const data = await response.json();\n                const tags = this.extractTagsFromText(`${data.title} ${data.author_name}`);\n                return {\n                    title: data.title || `Dailymotion Video ${videoId}`,\n                    description: `Video by ${data.author_name}`,\n                    tags: [\n                        ...tags,\n                        \"dailymotion\"\n                    ],\n                    thumbnail: data.thumbnail_url,\n                    platform: \"dailymotion\"\n                };\n            }\n            return {\n                title: `Dailymotion Video ${videoId}`,\n                description: \"Dailymotion video content\",\n                tags: [\n                    \"dailymotion\",\n                    \"video\"\n                ],\n                platform: \"dailymotion\"\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting Dailymotion metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `Dailymotion Video ${videoId}`,\n                description: \"Dailymotion video content\",\n                tags: [\n                    \"dailymotion\"\n                ],\n                platform: \"dailymotion\"\n            };\n        }\n    }\n    async extractTwitchMetadata(videoId) {\n        try {\n            // Twitch doesn't have public oEmbed, so we'll use generic extraction\n            const isClip = videoId.length < 15 // Clips have shorter IDs\n            ;\n            const url = isClip ? `https://clips.twitch.tv/${videoId}` : `https://www.twitch.tv/videos/${videoId}`;\n            return {\n                title: isClip ? `Twitch Clip ${videoId}` : `Twitch Video ${videoId}`,\n                description: isClip ? \"Twitch gaming clip\" : \"Twitch gaming video\",\n                tags: [\n                    \"twitch\",\n                    \"gaming\",\n                    \"streaming\",\n                    isClip ? \"clip\" : \"vod\"\n                ],\n                platform: \"twitch\"\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting Twitch metadata\", {\n                videoId,\n                error\n            });\n            return {\n                title: `Twitch Content ${videoId}`,\n                description: \"Twitch gaming content\",\n                tags: [\n                    \"twitch\",\n                    \"gaming\"\n                ],\n                platform: \"twitch\"\n            };\n        }\n    }\n    async extractOEmbedMetadata(originalUrl) {\n        try {\n            // Try common oEmbed endpoints\n            const oEmbedEndpoints = [\n                `https://noembed.com/embed?url=${encodeURIComponent(originalUrl)}`,\n                `https://iframe.ly/api/oembed?url=${encodeURIComponent(originalUrl)}&api_key=your_key`\n            ];\n            for (const endpoint of oEmbedEndpoints){\n                try {\n                    const response = await fetch(endpoint);\n                    if (response.ok) {\n                        const data = await response.json();\n                        if (data.title) {\n                            const tags = this.extractTagsFromText(`${data.title} ${data.description || \"\"} ${data.author_name || \"\"}`);\n                            return {\n                                title: data.title,\n                                description: data.description || \"\",\n                                tags,\n                                thumbnail: data.thumbnail_url,\n                                platform: \"generic\"\n                            };\n                        }\n                    }\n                } catch (err) {\n                    continue;\n                }\n            }\n            return null;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Error extracting oEmbed metadata\", {\n                originalUrl,\n                error\n            });\n            return null;\n        }\n    }\n    extractFallbackMetadata(originalUrl) {\n        // Extract domain and basic info from URL\n        try {\n            const url = new URL(originalUrl);\n            const domain = url.hostname.replace(\"www.\", \"\");\n            const pathSegments = url.pathname.split(\"/\").filter(Boolean);\n            // Generate a basic title from URL\n            const title = pathSegments.length > 0 ? this.titleCase(pathSegments[pathSegments.length - 1].replace(/[-_]/g, \" \")) : `Video from ${domain}`;\n            return {\n                title,\n                description: `Video from ${domain}`,\n                tags: [\n                    domain.split(\".\")[0]\n                ]\n            };\n        } catch (error) {\n            return {\n                title: \"Uploaded Video\",\n                description: \"\",\n                tags: [\n                    \"video\"\n                ]\n            };\n        }\n    }\n    extractTagsFromText(text) {\n        if (!text) return [];\n        const commonVideoTags = [\n            \"music\",\n            \"gaming\",\n            \"sports\",\n            \"news\",\n            \"education\",\n            \"entertainment\",\n            \"technology\",\n            \"science\",\n            \"cooking\",\n            \"travel\",\n            \"fashion\",\n            \"fitness\",\n            \"comedy\",\n            \"tutorial\",\n            \"review\",\n            \"unboxing\",\n            \"vlog\",\n            \"documentary\",\n            \"animation\",\n            \"film\",\n            \"art\",\n            \"design\",\n            \"programming\",\n            \"business\",\n            \"lifestyle\",\n            \"health\",\n            \"beauty\",\n            \"diy\",\n            \"how-to\",\n            \"tips\",\n            \"guide\"\n        ];\n        const tags = [];\n        const lowerText = text.toLowerCase();\n        // Check for common video tags in the text\n        commonVideoTags.forEach((tag)=>{\n            if (lowerText.includes(tag)) {\n                tags.push(tag);\n            }\n        });\n        // Extract hashtags if present\n        const hashtagMatches = text.match(/#\\w+/g);\n        if (hashtagMatches) {\n            hashtagMatches.forEach((hashtag)=>{\n                tags.push(hashtag.substring(1).toLowerCase());\n            });\n        }\n        // If no specific tags found, try to categorize based on keywords\n        if (tags.length === 0) {\n            if (/music|song|album|artist|band|concert/i.test(text)) tags.push(\"music\");\n            if (/game|gaming|play|xbox|playstation|nintendo/i.test(text)) tags.push(\"gaming\");\n            if (/tutorial|how.?to|guide|learn|lesson/i.test(text)) tags.push(\"tutorial\");\n            if (/review|unboxing|test|comparison/i.test(text)) tags.push(\"review\");\n            if (/funny|comedy|humor|laugh|joke/i.test(text)) tags.push(\"comedy\");\n            if (/food|cooking|recipe|kitchen|chef/i.test(text)) tags.push(\"cooking\");\n            if (/tech|technology|software|app|coding|programming/i.test(text)) tags.push(\"technology\");\n            if (/news|breaking|update|report/i.test(text)) tags.push(\"news\");\n            if (/sport|football|basketball|soccer|tennis/i.test(text)) tags.push(\"sports\");\n            if (/travel|vacation|trip|adventure|explore/i.test(text)) tags.push(\"travel\");\n        }\n        // Ensure we have at least one tag\n        if (tags.length === 0) {\n            tags.push(\"video\");\n        }\n        // Remove duplicates and limit to 5 tags\n        return Array.from(new Set(tags)).slice(0, 5);\n    }\n    titleCase(str) {\n        return str.replace(/\\w\\S*/g, (txt)=>txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase());\n    }\n    constructor(){\n        this.supportedPlatforms = {\n            youtube: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/,\n                    /(?:https?:\\/\\/)?(?:www\\.)?youtube\\.com\\/embed\\/([a-zA-Z0-9_-]{11})/\n                ],\n                extract: (videoId)=>this.extractYouTubeMetadata(videoId)\n            },\n            vimeo: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?vimeo\\.com\\/(\\d+)/,\n                    /(?:https?:\\/\\/)?player\\.vimeo\\.com\\/video\\/(\\d+)/\n                ],\n                extract: (videoId)=>this.extractVimeoMetadata(videoId)\n            },\n            tiktok: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?tiktok\\.com\\/@[\\w.-]+\\/video\\/(\\d+)/,\n                    /(?:https?:\\/\\/)?vm\\.tiktok\\.com\\/([a-zA-Z0-9]+)/\n                ],\n                extract: (videoId)=>this.extractTikTokMetadata(videoId)\n            },\n            instagram: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?instagram\\.com\\/(?:p|reel)\\/([a-zA-Z0-9_-]+)/,\n                    /(?:https?:\\/\\/)?(?:www\\.)?instagram\\.com\\/tv\\/([a-zA-Z0-9_-]+)/\n                ],\n                extract: (videoId)=>this.extractInstagramMetadata(videoId)\n            },\n            twitter: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?(?:twitter\\.com|x\\.com)\\/\\w+\\/status\\/(\\d+)/\n                ],\n                extract: (videoId)=>this.extractTwitterMetadata(videoId)\n            },\n            dailymotion: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?dailymotion\\.com\\/video\\/([a-zA-Z0-9]+)/\n                ],\n                extract: (videoId)=>this.extractDailymotionMetadata(videoId)\n            },\n            twitch: {\n                patterns: [\n                    /(?:https?:\\/\\/)?(?:www\\.)?twitch\\.tv\\/videos\\/(\\d+)/,\n                    /(?:https?:\\/\\/)?clips\\.twitch\\.tv\\/([a-zA-Z0-9_-]+)/\n                ],\n                extract: (videoId)=>this.extractTwitchMetadata(videoId)\n            }\n        };\n    }\n}\nconst videoMetadataService = new VideoMetadataService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmljZXMvdmlkZW8tbWV0YWRhdGEuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0M7QUFZL0IsTUFBTUM7SUFtRFgsTUFBTUMsZ0JBQWdCQyxXQUFtQixFQUEwQjtRQUNqRSxJQUFJO1lBQ0YsbUNBQW1DO1lBQ25DLElBQUksSUFBSSxDQUFDQyxpQkFBaUIsQ0FBQ0QsY0FBYztnQkFDdkMsT0FBTyxJQUFJLENBQUNFLDBCQUEwQixDQUFDRjtZQUN6QztZQUVBLDJDQUEyQztZQUMzQyxLQUFLLE1BQU0sQ0FBQ0csVUFBVUMsT0FBTyxJQUFJQyxPQUFPQyxPQUFPLENBQUMsSUFBSSxDQUFDQyxrQkFBa0IsRUFBRztnQkFDeEUsS0FBSyxNQUFNQyxXQUFXSixPQUFPSyxRQUFRLENBQUU7b0JBQ3JDLE1BQU1DLFFBQVFWLFlBQVlVLEtBQUssQ0FBQ0Y7b0JBQ2hDLElBQUlFLE9BQU87d0JBQ1QsTUFBTUMsVUFBVUQsS0FBSyxDQUFDLEVBQUU7d0JBQ3hCYiwrQ0FBTUEsQ0FBQ2UsSUFBSSxDQUFDLENBQUMsd0JBQXdCLEVBQUVULFNBQVMsQ0FBQyxFQUFFOzRCQUFFUTs0QkFBU1g7d0JBQVk7d0JBQzFFLE9BQU8sTUFBTUksT0FBT1MsT0FBTyxDQUFDRjtvQkFDOUI7Z0JBQ0Y7WUFDRjtZQUVBLGdDQUFnQztZQUNoQyxNQUFNRyxlQUFlLE1BQU0sSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQ2Y7WUFDdEQsSUFBSWMsY0FBYztnQkFDaEIsT0FBT0E7WUFDVDtZQUVBLG1DQUFtQztZQUNuQyxPQUFPLElBQUksQ0FBQ0UsdUJBQXVCLENBQUNoQjtRQUN0QyxFQUFFLE9BQU9pQixPQUFPO1lBQ2RwQiwrQ0FBTUEsQ0FBQ29CLEtBQUssQ0FBQyxtQ0FBbUM7Z0JBQUVqQjtnQkFBYWlCO1lBQU07WUFDckUsT0FBTyxJQUFJLENBQUNELHVCQUF1QixDQUFDaEI7UUFDdEM7SUFDRjtJQUVRQyxrQkFBa0JpQixHQUFXLEVBQVc7UUFDOUMsTUFB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cmF0ZW15LW5leHRqcy8uL3NyYy9zZXJ2aWNlcy92aWRlby1tZXRhZGF0YS5zZXJ2aWNlLnRzPzdiYjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vbGliL2xvZ2dlcidcbmltcG9ydCB7IFZBTElEQVRJT05fUEFUVEVSTlMgfSBmcm9tICcuLi9saWIvY29uc3RhbnRzJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFZpZGVvTWV0YWRhdGEge1xuICB0aXRsZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gIHRhZ3M6IHN0cmluZ1tdXG4gIHRodW1ibmFpbD86IHN0cmluZ1xuICBkdXJhdGlvbj86IG51bWJlclxuICBwbGF0Zm9ybT86IHN0cmluZ1xufVxuXG5leHBvcnQgY2xhc3MgVmlkZW9NZXRhZGF0YVNlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IHN1cHBvcnRlZFBsYXRmb3JtcyA9IHtcbiAgICB5b3V0dWJlOiB7XG4gICAgICBwYXR0ZXJuczogW1xuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT8oPzp5b3V0dWJlXFwuY29tXFwvd2F0Y2hcXD92PXx5b3V0dVxcLmJlXFwvKShbYS16QS1aMC05Xy1dezExfSkvLFxuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT95b3V0dWJlXFwuY29tXFwvZW1iZWRcXC8oW2EtekEtWjAtOV8tXXsxMX0pL1xuICAgICAgXSxcbiAgICAgIGV4dHJhY3Q6ICh2aWRlb0lkOiBzdHJpbmcpID0+IHRoaXMuZXh0cmFjdFlvdVR1YmVNZXRhZGF0YSh2aWRlb0lkKVxuICAgIH0sXG4gICAgdmltZW86IHtcbiAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgIC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pP3ZpbWVvXFwuY29tXFwvKFxcZCspLyxcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pP3BsYXllclxcLnZpbWVvXFwuY29tXFwvdmlkZW9cXC8oXFxkKykvXG4gICAgICBdLFxuICAgICAgZXh0cmFjdDogKHZpZGVvSWQ6IHN0cmluZykgPT4gdGhpcy5leHRyYWN0VmltZW9NZXRhZGF0YSh2aWRlb0lkKVxuICAgIH0sXG4gICAgdGlrdG9rOiB7XG4gICAgICBwYXR0ZXJuczogW1xuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT90aWt0b2tcXC5jb21cXC9AW1xcdy4tXStcXC92aWRlb1xcLyhcXGQrKS8sXG4gICAgICAgIC8oPzpodHRwcz86XFwvXFwvKT92bVxcLnRpa3Rva1xcLmNvbVxcLyhbYS16QS1aMC05XSspL1xuICAgICAgXSxcbiAgICAgIGV4dHJhY3Q6ICh2aWRlb0lkOiBzdHJpbmcpID0+IHRoaXMuZXh0cmFjdFRpa1Rva01ldGFkYXRhKHZpZGVvSWQpXG4gICAgfSxcbiAgICBpbnN0YWdyYW06IHtcbiAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgIC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pP2luc3RhZ3JhbVxcLmNvbVxcLyg/OnB8cmVlbClcXC8oW2EtekEtWjAtOV8tXSspLyxcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/aW5zdGFncmFtXFwuY29tXFwvdHZcXC8oW2EtekEtWjAtOV8tXSspL1xuICAgICAgXSxcbiAgICAgIGV4dHJhY3Q6ICh2aWRlb0lkOiBzdHJpbmcpID0+IHRoaXMuZXh0cmFjdEluc3RhZ3JhbU1ldGFkYXRhKHZpZGVvSWQpXG4gICAgfSxcbiAgICB0d2l0dGVyOiB7XG4gICAgICBwYXR0ZXJuczogW1xuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT8oPzp0d2l0dGVyXFwuY29tfHhcXC5jb20pXFwvXFx3K1xcL3N0YXR1c1xcLyhcXGQrKS9cbiAgICAgIF0sXG4gICAgICBleHRyYWN0OiAodmlkZW9JZDogc3RyaW5nKSA9PiB0aGlzLmV4dHJhY3RUd2l0dGVyTWV0YWRhdGEodmlkZW9JZClcbiAgICB9LFxuICAgIGRhaWx5bW90aW9uOiB7XG4gICAgICBwYXR0ZXJuczogW1xuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT9kYWlseW1vdGlvblxcLmNvbVxcL3ZpZGVvXFwvKFthLXpBLVowLTldKykvXG4gICAgICBdLFxuICAgICAgZXh0cmFjdDogKHZpZGVvSWQ6IHN0cmluZykgPT4gdGhpcy5leHRyYWN0RGFpbHltb3Rpb25NZXRhZGF0YSh2aWRlb0lkKVxuICAgIH0sXG4gICAgdHdpdGNoOiB7XG4gICAgICBwYXR0ZXJuczogW1xuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT90d2l0Y2hcXC50dlxcL3ZpZGVvc1xcLyhcXGQrKS8sXG4gICAgICAgIC8oPzpodHRwcz86XFwvXFwvKT9jbGlwc1xcLnR3aXRjaFxcLnR2XFwvKFthLXpBLVowLTlfLV0rKS9cbiAgICAgIF0sXG4gICAgICBleHRyYWN0OiAodmlkZW9JZDogc3RyaW5nKSA9PiB0aGlzLmV4dHJhY3RUd2l0Y2hNZXRhZGF0YSh2aWRlb0lkKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGV4dHJhY3RNZXRhZGF0YShvcmlnaW5hbFVybDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb01ldGFkYXRhPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGZvciBkaXJlY3QgdmlkZW8gZmlsZSBVUkxzXG4gICAgICBpZiAodGhpcy5pc0RpcmVjdFZpZGVvRmlsZShvcmlnaW5hbFVybCkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdERpcmVjdFZpZGVvTWV0YWRhdGEob3JpZ2luYWxVcmwpXG4gICAgICB9XG5cbiAgICAgIC8vIFRyeSB0byBtYXRjaCBhZ2FpbnN0IHN1cHBvcnRlZCBwbGF0Zm9ybXNcbiAgICAgIGZvciAoY29uc3QgW3BsYXRmb3JtLCBjb25maWddIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuc3VwcG9ydGVkUGxhdGZvcm1zKSkge1xuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgY29uZmlnLnBhdHRlcm5zKSB7XG4gICAgICAgICAgY29uc3QgbWF0Y2ggPSBvcmlnaW5hbFVybC5tYXRjaChwYXR0ZXJuKVxuICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgY29uc3QgdmlkZW9JZCA9IG1hdGNoWzFdXG4gICAgICAgICAgICBsb2dnZXIuaW5mbyhgRXh0cmFjdGluZyBtZXRhZGF0YSBmb3IgJHtwbGF0Zm9ybX1gLCB7IHZpZGVvSWQsIG9yaWdpbmFsVXJsIH0pXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgY29uZmlnLmV4dHJhY3QodmlkZW9JZClcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVHJ5IGdlbmVyaWMgb0VtYmVkIGV4dHJhY3Rpb25cbiAgICAgIGNvbnN0IG9FbWJlZFJlc3VsdCA9IGF3YWl0IHRoaXMuZXh0cmFjdE9FbWJlZE1ldGFkYXRhKG9yaWdpbmFsVXJsKVxuICAgICAgaWYgKG9FbWJlZFJlc3VsdCkge1xuICAgICAgICByZXR1cm4gb0VtYmVkUmVzdWx0XG4gICAgICB9XG5cbiAgICAgIC8vIEZhbGxiYWNrIHRvIFVSTC1iYXNlZCBleHRyYWN0aW9uXG4gICAgICByZXR1cm4gdGhpcy5leHRyYWN0RmFsbGJhY2tNZXRhZGF0YShvcmlnaW5hbFVybClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIHZpZGVvIG1ldGFkYXRhJywgeyBvcmlnaW5hbFVybCwgZXJyb3IgfSlcbiAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RGYWxsYmFja01ldGFkYXRhKG9yaWdpbmFsVXJsKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaXNEaXJlY3RWaWRlb0ZpbGUodXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCB2aWRlb0V4dGVuc2lvbnMgPSBbJy5tcDQnLCAnLm1vdicsICcuYXZpJywgJy5ta3YnLCAnLndlYm0nLCAnLmZsdicsICcud212JywgJy5tNHYnXVxuICAgIGNvbnN0IHVybFBhdGggPSBuZXcgVVJMKHVybCkucGF0aG5hbWUudG9Mb3dlckNhc2UoKVxuICAgIHJldHVybiB2aWRlb0V4dGVuc2lvbnMuc29tZShleHQgPT4gdXJsUGF0aC5lbmRzV2l0aChleHQpKVxuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0RGlyZWN0VmlkZW9NZXRhZGF0YShvcmlnaW5hbFVybDogc3RyaW5nKTogVmlkZW9NZXRhZGF0YSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChvcmlnaW5hbFVybClcbiAgICBjb25zdCBmaWxlbmFtZSA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpIHx8ICd2aWRlbydcbiAgICBjb25zdCB0aXRsZSA9IGZpbGVuYW1lLnJlcGxhY2UoL1xcLlteLy5dKyQvLCAnJykucmVwbGFjZSgvWy1fXS9nLCAnICcpXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRpdGxlOiB0aGlzLnRpdGxlQ2FzZSh0aXRsZSksXG4gICAgICBkZXNjcmlwdGlvbjogYERpcmVjdCB2aWRlbyBmaWxlOiAke2ZpbGVuYW1lfWAsXG4gICAgICB0YWdzOiBbJ3ZpZGVvJywgJ2RpcmVjdC11cGxvYWQnXSxcbiAgICAgIHBsYXRmb3JtOiAnZGlyZWN0JyxcbiAgICAgIHRodW1ibmFpbDogdW5kZWZpbmVkXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0WW91VHViZU1ldGFkYXRhKHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8VmlkZW9NZXRhZGF0YT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgWW91VHViZSBvRW1iZWQgQVBJIGZvciBiYXNpYyBtZXRhZGF0YVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly93d3cueW91dHViZS5jb20vb2VtYmVkP3VybD1odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PSR7dmlkZW9JZH0mZm9ybWF0PWpzb25gKVxuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgWW91VHViZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIFxuICAgICAgLy8gRXh0cmFjdCB0YWdzIGZyb20gdGl0bGUgYW5kIGRlc2NyaXB0aW9uIHVzaW5nIGtleXdvcmRzXG4gICAgICBjb25zdCB0YWdzID0gdGhpcy5leHRyYWN0VGFnc0Zyb21UZXh0KGAke2RhdGEudGl0bGV9ICR7ZGF0YS5hdXRob3JfbmFtZX1gKVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogZGF0YS50aXRsZSB8fCBgWW91VHViZSBWaWRlbyAke3ZpZGVvSWR9YCxcbiAgICAgICAgZGVzY3JpcHRpb246IGBWaWRlbyBieSAke2RhdGEuYXV0aG9yX25hbWV9YCxcbiAgICAgICAgdGFncyxcbiAgICAgICAgdGh1bWJuYWlsOiBkYXRhLnRodW1ibmFpbF91cmwsXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZXh0cmFjdGluZyBZb3VUdWJlIG1ldGFkYXRhJywgeyB2aWRlb0lkLCBlcnJvciB9KVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGU6IGBZb3VUdWJlIFZpZGVvICR7dmlkZW9JZH1gLFxuICAgICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICAgIHRhZ3M6IFsneW91dHViZSddLFxuICAgICAgICB0aHVtYm5haWw6IGBodHRwczovL2ltZy55b3V0dWJlLmNvbS92aS8ke3ZpZGVvSWR9L21heHJlc2RlZmF1bHQuanBnYFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZXh0cmFjdFZpbWVvTWV0YWRhdGEodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb01ldGFkYXRhPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBWaW1lbyBvRW1iZWQgQVBJXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL3ZpbWVvLmNvbS9hcGkvb2VtYmVkLmpzb24/dXJsPWh0dHBzOi8vdmltZW8uY29tLyR7dmlkZW9JZH1gKVxuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVmltZW8gQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKVxuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICBcbiAgICAgIC8vIEV4dHJhY3QgdGFncyBmcm9tIHRpdGxlIGFuZCBhdXRob3JcbiAgICAgIGNvbnN0IHRhZ3MgPSB0aGlzLmV4dHJhY3RUYWdzRnJvbVRleHQoYCR7ZGF0YS50aXRsZX0gJHtkYXRhLmF1dGhvcl9uYW1lfWApXG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlIHx8IGBWaW1lbyBWaWRlbyAke3ZpZGVvSWR9YCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgYFZpZGVvIGJ5ICR7ZGF0YS5hdXRob3JfbmFtZX1gLFxuICAgICAgICB0YWdzLFxuICAgICAgICB0aHVtYm5haWw6IGRhdGEudGh1bWJuYWlsX3VybCxcbiAgICAgICAgZHVyYXRpb246IGRhdGEuZHVyYXRpb25cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIFZpbWVvIG1ldGFkYXRhJywgeyB2aWRlb0lkLCBlcnJvciB9KVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGU6IGBWaW1lbyBWaWRlbyAke3ZpZGVvSWR9YCxcbiAgICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgICB0YWdzOiBbJ3ZpbWVvJ11cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4dHJhY3RUaWtUb2tNZXRhZGF0YSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFZpZGVvTWV0YWRhdGE+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVGlrVG9rIGRvZXNuJ3QgaGF2ZSBhIHB1YmxpYyBBUEksIHNvIHdlJ2xsIHVzZSBVUkwgcGFyc2luZyBhbmQgZ2VuZXJpYyBleHRyYWN0aW9uXG4gICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cudGlrdG9rLmNvbS9AdXNlci92aWRlby8ke3ZpZGVvSWR9YFxuICAgICAgY29uc3Qgb0VtYmVkUmVzdWx0ID0gYXdhaXQgdGhpcy5leHRyYWN0T0VtYmVkTWV0YWRhdGEodXJsKVxuICAgICAgaWYgKG9FbWJlZFJlc3VsdCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm9FbWJlZFJlc3VsdCxcbiAgICAgICAgICBwbGF0Zm9ybTogJ3Rpa3RvaycsXG4gICAgICAgICAgdGFnczogWy4uLihvRW1iZWRSZXN1bHQudGFncyB8fCBbXSksICd0aWt0b2snLCAnc2hvcnQtZm9ybSddXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGU6IGBUaWtUb2sgVmlkZW8gJHt2aWRlb0lkfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGlrVG9rIHNob3J0LWZvcm0gdmlkZW8gY29udGVudCcsXG4gICAgICAgIHRhZ3M6IFsndGlrdG9rJywgJ3Nob3J0LWZvcm0nLCAnc29jaWFsJ10sXG4gICAgICAgIHBsYXRmb3JtOiAndGlrdG9rJ1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGV4dHJhY3RpbmcgVGlrVG9rIG1ldGFkYXRhJywgeyB2aWRlb0lkLCBlcnJvciB9KVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGU6IGBUaWtUb2sgVmlkZW8gJHt2aWRlb0lkfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGlrVG9rIHNob3J0LWZvcm0gdmlkZW8gY29udGVudCcsXG4gICAgICAgIHRhZ3M6IFsndGlrdG9rJywgJ3Nob3J0LWZvcm0nXSxcbiAgICAgICAgcGxhdGZvcm06ICd0aWt0b2snXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0SW5zdGFncmFtTWV0YWRhdGEodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb01ldGFkYXRhPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEluc3RhZ3JhbSBvRW1iZWQgQVBJXG4gICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9wLyR7dmlkZW9JZH0vYFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjguMC9pbnN0YWdyYW1fb2VtYmVkP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudCh1cmwpfSZhY2Nlc3NfdG9rZW49eW91cl90b2tlbmApXG4gICAgICBcbiAgICAgIC8vIFNpbmNlIHdlIGRvbid0IGhhdmUgYW4gYWNjZXNzIHRva2VuLCBmYWxsIGJhY2sgdG8gVVJMIHBhcnNpbmdcbiAgICAgIGNvbnN0IG9FbWJlZFJlc3VsdCA9IGF3YWl0IHRoaXMuZXh0cmFjdE9FbWJlZE1ldGFkYXRhKHVybClcbiAgICAgIGlmIChvRW1iZWRSZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5vRW1iZWRSZXN1bHQsXG4gICAgICAgICAgcGxhdGZvcm06ICdpbnN0YWdyYW0nLFxuICAgICAgICAgIHRhZ3M6IFsuLi4ob0VtYmVkUmVzdWx0LnRhZ3MgfHwgW10pLCAnaW5zdGFncmFtJywgJ3NvY2lhbCddXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGU6IGBJbnN0YWdyYW0gVmlkZW8gJHt2aWRlb0lkfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnSW5zdGFncmFtIHZpZGVvIGNvbnRlbnQnLFxuICAgICAgICB0YWdzOiBbJ2luc3RhZ3JhbScsICdzb2NpYWwnLCAndmlkZW8nXSxcbiAgICAgICAgcGxhdGZvcm06ICdpbnN0YWdyYW0nXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZXh0cmFjdGluZyBJbnN0YWdyYW0gbWV0YWRhdGEnLCB7IHZpZGVvSWQsIGVycm9yIH0pXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogYEluc3RhZ3JhbSBWaWRlbyAke3ZpZGVvSWR9YCxcbiAgICAgICAgZGVzY3JpcHRpb246ICdJbnN0YWdyYW0gdmlkZW8gY29udGVudCcsXG4gICAgICAgIHRhZ3M6IFsnaW5zdGFncmFtJywgJ3NvY2lhbCddLFxuICAgICAgICBwbGF0Zm9ybTogJ2luc3RhZ3JhbSdcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4dHJhY3RUd2l0dGVyTWV0YWRhdGEodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb01ldGFkYXRhPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFR3aXR0ZXIgb0VtYmVkIEFQSVxuICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vdHdpdHRlci5jb20vdXNlci9zdGF0dXMvJHt2aWRlb0lkfWBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vcHVibGlzaC50d2l0dGVyLmNvbS9vZW1iZWQ/dXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHVybCl9YClcbiAgICAgIFxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgY29uc3QgdGFncyA9IHRoaXMuZXh0cmFjdFRhZ3NGcm9tVGV4dChkYXRhLmh0bWwgfHwgJycpXG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlIHx8IGBUd2l0dGVyIFZpZGVvICR7dmlkZW9JZH1gLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVHdpdHRlciB2aWRlbyBjb250ZW50JyxcbiAgICAgICAgICB0YWdzOiBbLi4udGFncywgJ3R3aXR0ZXInLCAnc29jaWFsJ10sXG4gICAgICAgICAgcGxhdGZvcm06ICd0d2l0dGVyJ1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiBgVHdpdHRlciBWaWRlbyAke3ZpZGVvSWR9YCxcbiAgICAgICAgZGVzY3JpcHRpb246ICdUd2l0dGVyIHZpZGVvIGNvbnRlbnQnLFxuICAgICAgICB0YWdzOiBbJ3R3aXR0ZXInLCAnc29jaWFsJywgJ3ZpZGVvJ10sXG4gICAgICAgIHBsYXRmb3JtOiAndHdpdHRlcidcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIFR3aXR0ZXIgbWV0YWRhdGEnLCB7IHZpZGVvSWQsIGVycm9yIH0pXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogYFR3aXR0ZXIgVmlkZW8gJHt2aWRlb0lkfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVHdpdHRlciB2aWRlbyBjb250ZW50JyxcbiAgICAgICAgdGFnczogWyd0d2l0dGVyJywgJ3NvY2lhbCddLFxuICAgICAgICBwbGF0Zm9ybTogJ3R3aXR0ZXInXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0RGFpbHltb3Rpb25NZXRhZGF0YSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFZpZGVvTWV0YWRhdGE+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRGFpbHltb3Rpb24gb0VtYmVkIEFQSVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly93d3cuZGFpbHltb3Rpb24uY29tL3NlcnZpY2VzL29lbWJlZD91cmw9aHR0cHM6Ly93d3cuZGFpbHltb3Rpb24uY29tL3ZpZGVvLyR7dmlkZW9JZH0mZm9ybWF0PWpzb25gKVxuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICBjb25zdCB0YWdzID0gdGhpcy5leHRyYWN0VGFnc0Zyb21UZXh0KGAke2RhdGEudGl0bGV9ICR7ZGF0YS5hdXRob3JfbmFtZX1gKVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSB8fCBgRGFpbHltb3Rpb24gVmlkZW8gJHt2aWRlb0lkfWAsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGBWaWRlbyBieSAke2RhdGEuYXV0aG9yX25hbWV9YCxcbiAgICAgICAgICB0YWdzOiBbLi4udGFncywgJ2RhaWx5bW90aW9uJ10sXG4gICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLnRodW1ibmFpbF91cmwsXG4gICAgICAgICAgcGxhdGZvcm06ICdkYWlseW1vdGlvbidcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogYERhaWx5bW90aW9uIFZpZGVvICR7dmlkZW9JZH1gLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0RhaWx5bW90aW9uIHZpZGVvIGNvbnRlbnQnLFxuICAgICAgICB0YWdzOiBbJ2RhaWx5bW90aW9uJywgJ3ZpZGVvJ10sXG4gICAgICAgIHBsYXRmb3JtOiAnZGFpbHltb3Rpb24nXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZXh0cmFjdGluZyBEYWlseW1vdGlvbiBtZXRhZGF0YScsIHsgdmlkZW9JZCwgZXJyb3IgfSlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiBgRGFpbHltb3Rpb24gVmlkZW8gJHt2aWRlb0lkfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRGFpbHltb3Rpb24gdmlkZW8gY29udGVudCcsXG4gICAgICAgIHRhZ3M6IFsnZGFpbHltb3Rpb24nXSxcbiAgICAgICAgcGxhdGZvcm06ICdkYWlseW1vdGlvbidcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4dHJhY3RUd2l0Y2hNZXRhZGF0YSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFZpZGVvTWV0YWRhdGE+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVHdpdGNoIGRvZXNuJ3QgaGF2ZSBwdWJsaWMgb0VtYmVkLCBzbyB3ZSdsbCB1c2UgZ2VuZXJpYyBleHRyYWN0aW9uXG4gICAgICBjb25zdCBpc0NsaXAgPSB2aWRlb0lkLmxlbmd0aCA8IDE1IC8vIENsaXBzIGhhdmUgc2hvcnRlciBJRHNcbiAgICAgIGNvbnN0IHVybCA9IGlzQ2xpcCBcbiAgICAgICAgPyBgaHR0cHM6Ly9jbGlwcy50d2l0Y2gudHYvJHt2aWRlb0lkfWBcbiAgICAgICAgOiBgaHR0cHM6Ly93d3cudHdpdGNoLnR2L3ZpZGVvcy8ke3ZpZGVvSWR9YFxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogaXNDbGlwID8gYFR3aXRjaCBDbGlwICR7dmlkZW9JZH1gIDogYFR3aXRjaCBWaWRlbyAke3ZpZGVvSWR9YCxcbiAgICAgICAgZGVzY3JpcHRpb246IGlzQ2xpcCA/ICdUd2l0Y2ggZ2FtaW5nIGNsaXAnIDogJ1R3aXRjaCBnYW1pbmcgdmlkZW8nLFxuICAgICAgICB0YWdzOiBbJ3R3aXRjaCcsICdnYW1pbmcnLCAnc3RyZWFtaW5nJywgaXNDbGlwID8gJ2NsaXAnIDogJ3ZvZCddLFxuICAgICAgICBwbGF0Zm9ybTogJ3R3aXRjaCdcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIFR3aXRjaCBtZXRhZGF0YScsIHsgdmlkZW9JZCwgZXJyb3IgfSlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiBgVHdpdGNoIENvbnRlbnQgJHt2aWRlb0lkfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVHdpdGNoIGdhbWluZyBjb250ZW50JyxcbiAgICAgICAgdGFnczogWyd0d2l0Y2gnLCAnZ2FtaW5nJ10sXG4gICAgICAgIHBsYXRmb3JtOiAndHdpdGNoJ1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZXh0cmFjdE9FbWJlZE1ldGFkYXRhKG9yaWdpbmFsVXJsOiBzdHJpbmcpOiBQcm9taXNlPFZpZGVvTWV0YWRhdGEgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRyeSBjb21tb24gb0VtYmVkIGVuZHBvaW50c1xuICAgICAgY29uc3Qgb0VtYmVkRW5kcG9pbnRzID0gW1xuICAgICAgICBgaHR0cHM6Ly9ub2VtYmVkLmNvbS9lbWJlZD91cmw9JHtlbmNvZGVVUklDb21wb25lbnQob3JpZ2luYWxVcmwpfWAsXG4gICAgICAgIGBodHRwczovL2lmcmFtZS5seS9hcGkvb2VtYmVkP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudChvcmlnaW5hbFVybCl9JmFwaV9rZXk9eW91cl9rZXlgXG4gICAgICBdXG5cbiAgICAgIGZvciAoY29uc3QgZW5kcG9pbnQgb2Ygb0VtYmVkRW5kcG9pbnRzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludClcbiAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgICAgIGlmIChkYXRhLnRpdGxlKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRhZ3MgPSB0aGlzLmV4dHJhY3RUYWdzRnJvbVRleHQoYCR7ZGF0YS50aXRsZX0gJHtkYXRhLmRlc2NyaXB0aW9uIHx8ICcnfSAke2RhdGEuYXV0aG9yX25hbWUgfHwgJyd9YClcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IGRhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgICAgICAgdGFncyxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGRhdGEudGh1bWJuYWlsX3VybCxcbiAgICAgICAgICAgICAgICBwbGF0Zm9ybTogJ2dlbmVyaWMnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIC8vIENvbnRpbnVlIHRvIG5leHQgZW5kcG9pbnRcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZXh0cmFjdGluZyBvRW1iZWQgbWV0YWRhdGEnLCB7IG9yaWdpbmFsVXJsLCBlcnJvciB9KVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RGYWxsYmFja01ldGFkYXRhKG9yaWdpbmFsVXJsOiBzdHJpbmcpOiBWaWRlb01ldGFkYXRhIHtcbiAgICAvLyBFeHRyYWN0IGRvbWFpbiBhbmQgYmFzaWMgaW5mbyBmcm9tIFVSTFxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKG9yaWdpbmFsVXJsKVxuICAgICAgY29uc3QgZG9tYWluID0gdXJsLmhvc3RuYW1lLnJlcGxhY2UoJ3d3dy4nLCAnJylcbiAgICAgIGNvbnN0IHBhdGhTZWdtZW50cyA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycpLmZpbHRlcihCb29sZWFuKVxuICAgICAgXG4gICAgICAvLyBHZW5lcmF0ZSBhIGJhc2ljIHRpdGxlIGZyb20gVVJMXG4gICAgICBjb25zdCB0aXRsZSA9IHBhdGhTZWdtZW50cy5sZW5ndGggPiAwIFxuICAgICAgICA/IHRoaXMudGl0bGVDYXNlKHBhdGhTZWdtZW50c1twYXRoU2VnbWVudHMubGVuZ3RoIC0gMV0ucmVwbGFjZSgvWy1fXS9nLCAnICcpKVxuICAgICAgICA6IGBWaWRlbyBmcm9tICR7ZG9tYWlufWBcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgVmlkZW8gZnJvbSAke2RvbWFpbn1gLFxuICAgICAgICB0YWdzOiBbZG9tYWluLnNwbGl0KCcuJylbMF1dXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiAnVXBsb2FkZWQgVmlkZW8nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICAgIHRhZ3M6IFsndmlkZW8nXVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFRhZ3NGcm9tVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgaWYgKCF0ZXh0KSByZXR1cm4gW11cblxuICAgIGNvbnN0IGNvbW1vblZpZGVvVGFncyA9IFtcbiAgICAgICdtdXNpYycsICdnYW1pbmcnLCAnc3BvcnRzJywgJ25ld3MnLCAnZWR1Y2F0aW9uJywgJ2VudGVydGFpbm1lbnQnLFxuICAgICAgJ3RlY2hub2xvZ3knLCAnc2NpZW5jZScsICdjb29raW5nJywgJ3RyYXZlbCcsICdmYXNoaW9uJywgJ2ZpdG5lc3MnLFxuICAgICAgJ2NvbWVkeScsICd0dXRvcmlhbCcsICdyZXZpZXcnLCAndW5ib3hpbmcnLCAndmxvZycsICdkb2N1bWVudGFyeScsXG4gICAgICAnYW5pbWF0aW9uJywgJ2ZpbG0nLCAnYXJ0JywgJ2Rlc2lnbicsICdwcm9ncmFtbWluZycsICdidXNpbmVzcycsXG4gICAgICAnbGlmZXN0eWxlJywgJ2hlYWx0aCcsICdiZWF1dHknLCAnZGl5JywgJ2hvdy10bycsICd0aXBzJywgJ2d1aWRlJ1xuICAgIF1cblxuICAgIGNvbnN0IHRhZ3M6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCBsb3dlclRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKClcblxuICAgIC8vIENoZWNrIGZvciBjb21tb24gdmlkZW8gdGFncyBpbiB0aGUgdGV4dFxuICAgIGNvbW1vblZpZGVvVGFncy5mb3JFYWNoKHRhZyA9PiB7XG4gICAgICBpZiAobG93ZXJUZXh0LmluY2x1ZGVzKHRhZykpIHtcbiAgICAgICAgdGFncy5wdXNoKHRhZylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gRXh0cmFjdCBoYXNodGFncyBpZiBwcmVzZW50XG4gICAgY29uc3QgaGFzaHRhZ01hdGNoZXMgPSB0ZXh0Lm1hdGNoKC8jXFx3Ky9nKVxuICAgIGlmIChoYXNodGFnTWF0Y2hlcykge1xuICAgICAgaGFzaHRhZ01hdGNoZXMuZm9yRWFjaChoYXNodGFnID0+IHtcbiAgICAgICAgdGFncy5wdXNoKGhhc2h0YWcuc3Vic3RyaW5nKDEpLnRvTG93ZXJDYXNlKCkpXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIElmIG5vIHNwZWNpZmljIHRhZ3MgZm91bmQsIHRyeSB0byBjYXRlZ29yaXplIGJhc2VkIG9uIGtleXdvcmRzXG4gICAgaWYgKHRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBpZiAoL211c2ljfHNvbmd8YWxidW18YXJ0aXN0fGJhbmR8Y29uY2VydC9pLnRlc3QodGV4dCkpIHRhZ3MucHVzaCgnbXVzaWMnKVxuICAgICAgaWYgKC9nYW1lfGdhbWluZ3xwbGF5fHhib3h8cGxheXN0YXRpb258bmludGVuZG8vaS50ZXN0KHRleHQpKSB0YWdzLnB1c2goJ2dhbWluZycpXG4gICAgICBpZiAoL3R1dG9yaWFsfGhvdy4/dG98Z3VpZGV8bGVhcm58bGVzc29uL2kudGVzdCh0ZXh0KSkgdGFncy5wdXNoKCd0dXRvcmlhbCcpXG4gICAgICBpZiAoL3Jldmlld3x1bmJveGluZ3x0ZXN0fGNvbXBhcmlzb24vaS50ZXN0KHRleHQpKSB0YWdzLnB1c2goJ3JldmlldycpXG4gICAgICBpZiAoL2Z1bm55fGNvbWVkeXxodW1vcnxsYXVnaHxqb2tlL2kudGVzdCh0ZXh0KSkgdGFncy5wdXNoKCdjb21lZHknKVxuICAgICAgaWYgKC9mb29kfGNvb2tpbmd8cmVjaXBlfGtpdGNoZW58Y2hlZi9pLnRlc3QodGV4dCkpIHRhZ3MucHVzaCgnY29va2luZycpXG4gICAgICBpZiAoL3RlY2h8dGVjaG5vbG9neXxzb2Z0d2FyZXxhcHB8Y29kaW5nfHByb2dyYW1taW5nL2kudGVzdCh0ZXh0KSkgdGFncy5wdXNoKCd0ZWNobm9sb2d5JylcbiAgICAgIGlmICgvbmV3c3xicmVha2luZ3x1cGRhdGV8cmVwb3J0L2kudGVzdCh0ZXh0KSkgdGFncy5wdXNoKCduZXdzJylcbiAgICAgIGlmICgvc3BvcnR8Zm9vdGJhbGx8YmFza2V0YmFsbHxzb2NjZXJ8dGVubmlzL2kudGVzdCh0ZXh0KSkgdGFncy5wdXNoKCdzcG9ydHMnKVxuICAgICAgaWYgKC90cmF2ZWx8dmFjYXRpb258dHJpcHxhZHZlbnR1cmV8ZXhwbG9yZS9pLnRlc3QodGV4dCkpIHRhZ3MucHVzaCgndHJhdmVsJylcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgd2UgaGF2ZSBhdCBsZWFzdCBvbmUgdGFnXG4gICAgaWYgKHRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICB0YWdzLnB1c2goJ3ZpZGVvJylcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBhbmQgbGltaXQgdG8gNSB0YWdzXG4gICAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldCh0YWdzKSkuc2xpY2UoMCwgNSlcbiAgfVxuXG4gIHByaXZhdGUgdGl0bGVDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1xcd1xcUyovZywgKHR4dCkgPT4gXG4gICAgICB0eHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eHQuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKClcbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHZpZGVvTWV0YWRhdGFTZXJ2aWNlID0gbmV3IFZpZGVvTWV0YWRhdGFTZXJ2aWNlKCkiXSwibmFtZXMiOlsibG9nZ2VyIiwiVmlkZW9NZXRhZGF0YVNlcnZpY2UiLCJleHRyYWN0TWV0YWRhdGEiLCJvcmlnaW5hbFVybCIsImlzRGlyZWN0VmlkZW9GaWxlIiwiZXh0cmFjdERpcmVjdFZpZGVvTWV0YWRhdGEiLCJwbGF0Zm9ybSIsImNvbmZpZyIsIk9iamVjdCIsImVudHJpZXMiLCJzdXBwb3J0ZWRQbGF0Zm9ybXMiLCJwYXR0ZXJuIiwicGF0dGVybnMiLCJtYXRjaCIsInZpZGVvSWQiLCJpbmZvIiwiZXh0cmFjdCIsIm9FbWJlZFJlc3VsdCIsImV4dHJhY3RPRW1iZWRNZXRhZGF0YSIsImV4dHJhY3RGYWxsYmFja01ldGFkYXRhIiwiZXJyb3IiLCJ1cmwiLCJ2aWRlb0V4dGVuc2lvbnMiLCJ1cmxQYXRoIiwiVVJMIiwicGF0aG5hbWUiLCJ0b0xvd2VyQ2FzZSIsInNvbWUiLCJleHQiLCJlbmRzV2l0aCIsImZpbGVuYW1lIiwic3BsaXQiLCJwb3AiLCJ0aXRsZSIsInJlcGxhY2UiLCJ0aXRsZUNhc2UiLCJkZXNjcmlwdGlvbiIsInRhZ3MiLCJ0aHVtYm5haWwiLCJ1bmRlZmluZWQiLCJleHRyYWN0WW91VHViZU1ldGFkYXRhIiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJkYXRhIiwianNvbiIsImV4dHJhY3RUYWdzRnJvbVRleHQiLCJhdXRob3JfbmFtZSIsInRodW1ibmFpbF91cmwiLCJleHRyYWN0VmltZW9NZXRhZGF0YSIsImR1cmF0aW9uIiwiZXh0cmFjdFRpa1Rva01ldGFkYXRhIiwiZXh0cmFjdEluc3RhZ3JhbU1ldGFkYXRhIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZXh0cmFjdFR3aXR0ZXJNZXRhZGF0YSIsImh0bWwiLCJleHRyYWN0RGFpbHltb3Rpb25NZXRhZGF0YSIsImV4dHJhY3RUd2l0Y2hNZXRhZGF0YSIsImlzQ2xpcCIsImxlbmd0aCIsIm9FbWJlZEVuZHBvaW50cyIsImVuZHBvaW50IiwiZXJyIiwiZG9tYWluIiwiaG9zdG5hbWUiLCJwYXRoU2VnbWVudHMiLCJmaWx0ZXIiLCJCb29sZWFuIiwidGV4dCIsImNvbW1vblZpZGVvVGFncyIsImxvd2VyVGV4dCIsImZvckVhY2giLCJ0YWciLCJpbmNsdWRlcyIsInB1c2giLCJoYXNodGFnTWF0Y2hlcyIsImhhc2h0YWciLCJzdWJzdHJpbmciLCJ0ZXN0IiwiQXJyYXkiLCJmcm9tIiwiU2V0Iiwic2xpY2UiLCJzdHIiLCJ0eHQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInN1YnN0ciIsInlvdXR1YmUiLCJ2aW1lbyIsInRpa3RvayIsImluc3RhZ3JhbSIsInR3aXR0ZXIiLCJkYWlseW1vdGlvbiIsInR3aXRjaCIsInZpZGVvTWV0YWRhdGFTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/services/video-metadata.service.ts\n");

/***/ }),

/***/ "(api)/./src/services/video.service.ts":
/*!***************************************!*\
  !*** ./src/services/video.service.ts ***!
  \***************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VideoServiceImpl: () => (/* binding */ VideoServiceImpl),\n/* harmony export */   videoService: () => (/* binding */ videoService)\n/* harmony export */ });\n/* harmony import */ var _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../repositories/video.repository */ \"(api)/./src/repositories/video.repository.ts\");\n/* harmony import */ var _repositories_rating_repository__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../repositories/rating.repository */ \"(api)/./src/repositories/rating.repository.ts\");\n/* harmony import */ var _repositories_tag_repository__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../repositories/tag.repository */ \"(api)/./src/repositories/tag.repository.ts\");\n/* harmony import */ var _repositories_user_repository__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../repositories/user.repository */ \"(api)/./src/repositories/user.repository.ts\");\n/* harmony import */ var _video_metadata_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./video-metadata.service */ \"(api)/./src/services/video-metadata.service.ts\");\n/* harmony import */ var _nsfw_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./nsfw.service */ \"(api)/./src/services/nsfw.service.ts\");\n/* harmony import */ var _redgifs_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./redgifs.service */ \"(api)/./src/services/redgifs.service.ts\");\n/* harmony import */ var _reddit_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./reddit.service */ \"(api)/./src/services/reddit.service.ts\");\n/* harmony import */ var _xhamster_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./xhamster.service */ \"(api)/./src/services/xhamster.service.ts\");\n/* harmony import */ var _lib_validation__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../lib/validation */ \"(api)/./src/lib/validation.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../lib/errors */ \"(api)/./src/lib/errors.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../lib/logger */ \"(api)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_constants__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../lib/constants */ \"(api)/./src/lib/constants.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_validation__WEBPACK_IMPORTED_MODULE_9__]);\n_lib_validation__WEBPACK_IMPORTED_MODULE_9__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass VideoServiceImpl {\n    async getVideos(filters) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            const validatedFilters = filters ? (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.validateSchema)(_lib_validation__WEBPACK_IMPORTED_MODULE_9__.videoFilterSchema, filters) : {};\n            const result = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findWithFilters(validatedFilters);\n            return {\n                success: true,\n                data: result.videos,\n                pagination: {\n                    page: validatedFilters.page || 1,\n                    limit: validatedFilters.limit || 12,\n                    total: result.total,\n                    totalPages: result.totalPages\n                }\n            };\n        })();\n    }\n    async getVideoById(id) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            const video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findWithRatings(id);\n            if (!video) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", id);\n            }\n            return {\n                success: true,\n                data: video\n            };\n        })();\n    }\n    async createVideo(data, userId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Validate input - originalUrl is required\n            const validatedData = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.validateSchema)(_lib_validation__WEBPACK_IMPORTED_MODULE_9__.createVideoSchema, {\n                title: data.title || \"\",\n                originalUrl: data.originalUrl,\n                description: data.description || \"\",\n                tags: []\n            });\n            // Verify user exists\n            const user = await _repositories_user_repository__WEBPACK_IMPORTED_MODULE_3__.userRepository.findById(userId);\n            if (!user) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"User\", userId);\n            }\n            // Check if metadata was already provided from extract-metadata step\n            let extractedMetadata, embedUrl, finalThumbnail, previewUrl;\n            if (data.embedUrl && data.thumbnail !== undefined) {\n                // Use provided metadata from extract-metadata flow\n                extractedMetadata = {\n                    title: data.title || \"\",\n                    description: data.description || \"\",\n                    tags: [],\n                    thumbnail: data.thumbnail\n                };\n                embedUrl = data.embedUrl;\n                finalThumbnail = data.thumbnail;\n                previewUrl = data.previewUrl || null;\n            } else if (_redgifs_service__WEBPACK_IMPORTED_MODULE_6__.redGifsService.isRedGifsUrl(validatedData.originalUrl)) {\n                try {\n                    const redGifsData = await _redgifs_service__WEBPACK_IMPORTED_MODULE_6__.redGifsService.processRedGifsUrl(validatedData.originalUrl);\n                    extractedMetadata = {\n                        title: redGifsData.metadata.title,\n                        description: redGifsData.metadata.description || \"\",\n                        tags: redGifsData.tags,\n                        thumbnail: redGifsData.thumbnail\n                    };\n                    embedUrl = redGifsData.embedUrl // This will be the direct video URL\n                    ;\n                    finalThumbnail = redGifsData.thumbnail;\n                    _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.info(\"RedGifs processing successful for video creation\", {\n                        url: validatedData.originalUrl,\n                        tagsExtracted: redGifsData.tags?.length || 0,\n                        hasTagRatings: !!data.tagRatings,\n                        tagRatingsCount: data.tagRatings?.length || 0\n                    });\n                } catch (error) {\n                    _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.error(\"Failed to process RedGifs URL, falling back to standard processing\", {\n                        error\n                    });\n                    extractedMetadata = await _video_metadata_service__WEBPACK_IMPORTED_MODULE_4__.videoMetadataService.extractMetadata(validatedData.originalUrl);\n                    embedUrl = this.convertToEmbedUrl(validatedData.originalUrl);\n                    finalThumbnail = extractedMetadata.thumbnail || null;\n                }\n            } else if (_reddit_service__WEBPACK_IMPORTED_MODULE_7__.redditService.isRedditUrl(validatedData.originalUrl)) {\n                try {\n                    const redditData = await _reddit_service__WEBPACK_IMPORTED_MODULE_7__.redditService.processRedditUrl(validatedData.originalUrl);\n                    extractedMetadata = {\n                        title: redditData.metadata.title,\n                        description: redditData.metadata.description || \"\",\n                        tags: redditData.tags,\n                        thumbnail: redditData.thumbnail\n                    };\n                    embedUrl = redditData.embedUrl;\n                    finalThumbnail = redditData.thumbnail;\n                } catch (error) {\n                    _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.error(\"Failed to process Reddit URL, falling back to standard processing\", {\n                        error\n                    });\n                    extractedMetadata = await _video_metadata_service__WEBPACK_IMPORTED_MODULE_4__.videoMetadataService.extractMetadata(validatedData.originalUrl);\n                    embedUrl = this.convertToEmbedUrl(validatedData.originalUrl);\n                    finalThumbnail = extractedMetadata.thumbnail || null;\n                }\n            } else if (_xhamster_service__WEBPACK_IMPORTED_MODULE_8__.xHamsterService.isXHamsterUrl(validatedData.originalUrl)) {\n                try {\n                    const xHamsterData = await _xhamster_service__WEBPACK_IMPORTED_MODULE_8__.xHamsterService.processXHamsterUrl(validatedData.originalUrl);\n                    extractedMetadata = {\n                        title: xHamsterData.title || \"\",\n                        description: xHamsterData.description || \"\",\n                        tags: xHamsterData.tags || [],\n                        thumbnail: xHamsterData.thumbnail\n                    };\n                    embedUrl = this.convertToEmbedUrl(validatedData.originalUrl);\n                    finalThumbnail = xHamsterData.thumbnail || null;\n                    previewUrl = xHamsterData.previewUrl || null;\n                } catch (error) {\n                    _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.error(\"Failed to process XHamster URL, falling back to standard processing\", {\n                        error\n                    });\n                    extractedMetadata = await _video_metadata_service__WEBPACK_IMPORTED_MODULE_4__.videoMetadataService.extractMetadata(validatedData.originalUrl);\n                    embedUrl = this.convertToEmbedUrl(validatedData.originalUrl);\n                    finalThumbnail = extractedMetadata.thumbnail || null;\n                }\n            } else {\n                // Extract metadata automatically from video URL\n                extractedMetadata = await _video_metadata_service__WEBPACK_IMPORTED_MODULE_4__.videoMetadataService.extractMetadata(validatedData.originalUrl);\n                // Convert original URL to embed URL\n                embedUrl = this.convertToEmbedUrl(validatedData.originalUrl);\n                finalThumbnail = extractedMetadata.thumbnail || null;\n            }\n            // Use extracted data or fallback to provided data\n            let finalTitle = data.title?.trim() || extractedMetadata.title;\n            // If still no title, generate one from the URL\n            if (!finalTitle) {\n                if (validatedData.originalUrl.includes(\"redgifs.com\")) {\n                    const match = validatedData.originalUrl.match(/\\/watch\\/([a-zA-Z0-9]+)/);\n                    const gifId = match ? match[1] : \"video\";\n                    finalTitle = `RedGifs ${gifId}`;\n                } else {\n                    finalTitle = \"Untitled Video\";\n                }\n            }\n            const finalDescription = data.description?.trim() || extractedMetadata.description || null;\n            // Combine provided tags with extracted tags and rated tags\n            const providedTags = data.tags ? this.extractTagsFromVideo(data) : [];\n            const extractedTags = Array.isArray(extractedMetadata.tags) ? extractedMetadata.tags : [];\n            const ratedTags = data.tagRatings ? data.tagRatings.map((tr)=>tr.name) : [] // Include all rated tags, even rating 0\n            ;\n            const combinedTags = Array.from(new Set([\n                ...providedTags,\n                ...extractedTags,\n                ...ratedTags\n            ]));\n            const sanitizedTags = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.sanitizeTags)(combinedTags);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.info(\"Processing tags for video creation\", {\n                providedTags: providedTags.length,\n                extractedTags: extractedTags.length,\n                ratedTags: ratedTags.length,\n                combinedTags: combinedTags.length,\n                sanitizedTags: sanitizedTags.length,\n                finalTags: sanitizedTags\n            });\n            // Detect NSFW content automatically or use provided value\n            let isNSFW;\n            if (data.isNsfw !== undefined) {\n                // Use provided NSFW status from extract-metadata flow\n                isNSFW = data.isNsfw;\n            } else {\n                // Fallback to automatic detection\n                const isRedGifs = _redgifs_service__WEBPACK_IMPORTED_MODULE_6__.redGifsService.isRedGifsUrl(validatedData.originalUrl);\n                const isReddit = _reddit_service__WEBPACK_IMPORTED_MODULE_7__.redditService.isRedditUrl(validatedData.originalUrl);\n                const isXHamster = _xhamster_service__WEBPACK_IMPORTED_MODULE_8__.xHamsterService.isXHamsterUrl(validatedData.originalUrl);\n                if (isRedGifs || isXHamster) {\n                    isNSFW = true // RedGifs and XHamster are automatically NSFW\n                    ;\n                } else if (isReddit && Array.isArray(extractedMetadata.tags) && extractedMetadata.tags.includes(\"nsfw\")) {\n                    isNSFW = true // Reddit marked as NSFW\n                    ;\n                } else {\n                    isNSFW = await _nsfw_service__WEBPACK_IMPORTED_MODULE_5__.nsfwService.detectNSFW(finalTitle, finalDescription || undefined);\n                }\n            }\n            // Create video with tags\n            let video;\n            try {\n                video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.createWithTags({\n                    title: finalTitle,\n                    originalUrl: validatedData.originalUrl,\n                    embedUrl,\n                    thumbnail: finalThumbnail || null,\n                    previewUrl: previewUrl || null,\n                    description: finalDescription,\n                    isNsfw: isNSFW,\n                    userId\n                }, sanitizedTags);\n                _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.info(\"Video created successfully\", {\n                    videoId: video.id,\n                    title: finalTitle,\n                    tagsCount: sanitizedTags.length\n                });\n                // Handle tag ratings if provided\n                if (data.tagRatings && data.tagRatings.length > 0) {\n                    try {\n                        let ratingsCreated = 0;\n                        _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.info(\"Creating tag ratings for video\", {\n                            videoId: video.id,\n                            totalTagRatings: data.tagRatings.length\n                        });\n                        for (const tagRating of data.tagRatings){\n                            if (tagRating.rating >= 0) {\n                                // Sanitize tag name to ensure consistency with video tags\n                                const sanitizedTagName = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.sanitizeTags)([\n                                    tagRating.name\n                                ])[0];\n                                if (!sanitizedTagName) continue;\n                                // Find or create the tag (ensure it exists)\n                                const tag = await _repositories_tag_repository__WEBPACK_IMPORTED_MODULE_2__.tagRepository.findOrCreate(sanitizedTagName);\n                                // Check if this tag is actually associated with the video\n                                const videoHasTag = sanitizedTags.includes(sanitizedTagName);\n                                if (videoHasTag) {\n                                    // Create a rating for this tag using the upsert method\n                                    await _repositories_rating_repository__WEBPACK_IMPORTED_MODULE_1__.ratingRepository.upsertRating(video.id, userId, tag.id, tagRating.rating);\n                                    ratingsCreated++;\n                                } else {\n                                    _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.warn(\"Skipping rating for tag not associated with video\", {\n                                        originalTagName: tagRating.name,\n                                        sanitizedTagName,\n                                        videoId: video.id\n                                    });\n                                }\n                            }\n                        }\n                        _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.info(\"Tag ratings creation completed\", {\n                            videoId: video.id,\n                            ratingsCreated,\n                            totalProcessed: data.tagRatings.length\n                        });\n                    } catch (ratingError) {\n                        _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.error(\"Failed to create tag ratings\", {\n                            error: ratingError,\n                            videoId: video.id,\n                            tagRatings: data.tagRatings\n                        });\n                    // Don't throw here - video was created successfully, ratings are optional\n                    }\n                }\n            } catch (createError) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_11__.logger.error(\"Failed to create video in database\", {\n                    error: createError,\n                    videoData: {\n                        title: finalTitle,\n                        originalUrl: validatedData.originalUrl,\n                        embedUrl,\n                        thumbnail: finalThumbnail,\n                        description: finalDescription,\n                        isNsfw: isNSFW,\n                        userId\n                    },\n                    tags: sanitizedTags\n                });\n                throw createError;\n            }\n            (0,_lib_logger__WEBPACK_IMPORTED_MODULE_11__.logUserAction)(\"video_created\", userId, {\n                videoId: video.id,\n                title: video.title,\n                autoExtracted: !data.title || !data.description\n            });\n            // Refetch the video with all ratings to ensure fresh data\n            const videoWithRatings = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findWithRatings(video.id);\n            return {\n                success: true,\n                data: videoWithRatings || video\n            };\n        })();\n    }\n    async updateVideo(id, data, userId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Find existing video\n            const existingVideo = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(id);\n            if (!existingVideo) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", id);\n            }\n            // Check ownership\n            if (existingVideo.userId !== userId) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_10__.AuthorizationError(\"You can only update your own videos\");\n            }\n            // Validate input\n            const validatedData = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.validateSchema)(_lib_validation__WEBPACK_IMPORTED_MODULE_9__.updateVideoSchema, data);\n            // Update embed URL if original URL changed\n            const updateData = {\n                ...validatedData\n            };\n            if (validatedData.originalUrl) {\n                updateData.embedUrl = this.convertToEmbedUrl(validatedData.originalUrl);\n            }\n            // Update video\n            const updatedVideo = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.update(id, updateData);\n            (0,_lib_logger__WEBPACK_IMPORTED_MODULE_11__.logUserAction)(\"video_updated\", userId, {\n                videoId: id\n            });\n            return {\n                success: true,\n                data: updatedVideo\n            };\n        })();\n    }\n    async deleteVideo(id, userId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Find existing video\n            const existingVideo = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(id);\n            if (!existingVideo) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", id);\n            }\n            // Get user to check if they're admin\n            const user = await _repositories_user_repository__WEBPACK_IMPORTED_MODULE_3__.userRepository.findById(userId);\n            if (!user) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"User\", userId);\n            }\n            // Check ownership or admin status\n            const isOwner = existingVideo.userId === userId;\n            const isAdmin = user.isAdmin === true;\n            if (!isOwner && !isAdmin) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_10__.AuthorizationError(\"You can only delete your own videos or must be an admin\");\n            }\n            // Delete video (cascade will handle related records)\n            await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.delete(id);\n            (0,_lib_logger__WEBPACK_IMPORTED_MODULE_11__.logUserAction)(\"video_deleted\", userId, {\n                videoId: id,\n                title: existingVideo.title,\n                isAdminDelete: !isOwner\n            });\n            return {\n                success: true\n            };\n        })();\n    }\n    async rateVideo(videoId, tagId, level, userId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Validate input\n            const validatedData = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.validateSchema)(_lib_validation__WEBPACK_IMPORTED_MODULE_9__.ratingSchema, {\n                tagId,\n                level\n            });\n            // Check if video exists\n            const video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(videoId);\n            if (!video) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", videoId);\n            }\n            // Check if user exists\n            const user = await _repositories_user_repository__WEBPACK_IMPORTED_MODULE_3__.userRepository.findById(userId);\n            if (!user) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"User\", userId);\n            }\n            // Check if tag exists\n            const tag = await _repositories_tag_repository__WEBPACK_IMPORTED_MODULE_2__.tagRepository.findById(validatedData.tagId);\n            if (!tag) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Tag\", validatedData.tagId);\n            }\n            // Upsert rating\n            const rating = await _repositories_rating_repository__WEBPACK_IMPORTED_MODULE_1__.ratingRepository.upsertRating(videoId, userId, validatedData.tagId, validatedData.level);\n            (0,_lib_logger__WEBPACK_IMPORTED_MODULE_11__.logUserAction)(\"video_rated\", userId, {\n                videoId,\n                tagId: validatedData.tagId,\n                level: validatedData.level\n            });\n            return {\n                success: true,\n                data: rating\n            };\n        })();\n    }\n    async getVideosByUser(userId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Check if user exists\n            const user = await _repositories_user_repository__WEBPACK_IMPORTED_MODULE_3__.userRepository.findById(userId);\n            if (!user) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"User\", userId);\n            }\n            const videos = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findByUserId(userId);\n            return {\n                success: true,\n                data: videos\n            };\n        })();\n    }\n    async searchVideos(query) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            if (!query || query.trim().length === 0) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_10__.ValidationError(\"Search query is required\", \"query\");\n            }\n            const videos = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.search(query.trim());\n            return {\n                success: true,\n                data: videos\n            };\n        })();\n    }\n    async getVideosByTags(tags) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            if (!tags || tags.length === 0) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_10__.ValidationError(\"At least one tag is required\", \"tags\");\n            }\n            const sanitizedTags = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_9__.sanitizeTags)(tags);\n            const videos = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findByTags(sanitizedTags);\n            return {\n                success: true,\n                data: videos\n            };\n        })();\n    }\n    async getTrendingVideos(limit = 10) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            const videos = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.getTrendingVideos(limit);\n            return {\n                success: true,\n                data: videos\n            };\n        })();\n    }\n    async getVideoStats(videoId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            const video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(videoId);\n            if (!video) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", videoId);\n            }\n            const stats = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.getVideoStats(videoId);\n            return {\n                success: true,\n                data: stats\n            };\n        })();\n    }\n    convertToEmbedUrl(originalUrl) {\n        // YouTube URLs\n        const youtubeMatch = originalUrl.match(_lib_constants__WEBPACK_IMPORTED_MODULE_12__.VALIDATION_PATTERNS.YOUTUBE_URL);\n        if (youtubeMatch) {\n            return `https://www.youtube.com/embed/${youtubeMatch[1]}`;\n        }\n        // Vimeo URLs\n        const vimeoMatch = originalUrl.match(_lib_constants__WEBPACK_IMPORTED_MODULE_12__.VALIDATION_PATTERNS.VIMEO_URL);\n        if (vimeoMatch) {\n            return `https://player.vimeo.com/video/${vimeoMatch[1]}`;\n        }\n        // RedGifs URLs - fallback if not processed by RedGifs service\n        const redgifsRegex = /(?:https?:\\/\\/)?(?:www\\.)?redgifs\\.com\\/(?:watch\\/|ifr\\/)([a-zA-Z0-9]+)/i;\n        const redgifsMatch = originalUrl.match(redgifsRegex);\n        if (redgifsMatch) {\n            return `https://www.redgifs.com/ifr/${redgifsMatch[1]}`;\n        }\n        // TikTok URLs\n        const tiktokRegex = /(?:https?:\\/\\/)?(?:www\\.)?tiktok\\.com\\/@[\\w.-]+\\/video\\/(\\d+)/;\n        const tiktokMatch = originalUrl.match(tiktokRegex);\n        if (tiktokMatch) {\n            return `https://www.tiktok.com/embed/v2/${tiktokMatch[1]}`;\n        }\n        // Instagram URLs\n        const instagramRegex = /(?:https?:\\/\\/)?(?:www\\.)?instagram\\.com\\/(?:p|reel)\\/([a-zA-Z0-9_-]+)/;\n        const instagramMatch = originalUrl.match(instagramRegex);\n        if (instagramMatch) {\n            return `https://www.instagram.com/p/${instagramMatch[1]}/embed/`;\n        }\n        // Twitter/X URLs\n        const twitterRegex = /(?:https?:\\/\\/)?(?:www\\.)?(?:twitter\\.com|x\\.com)\\/\\w+\\/status\\/(\\d+)/;\n        const twitterMatch = originalUrl.match(twitterRegex);\n        if (twitterMatch) {\n            return `https://platform.twitter.com/embed/Tweet.html?id=${twitterMatch[1]}`;\n        }\n        // Dailymotion URLs\n        const dailymotionRegex = /(?:https?:\\/\\/)?(?:www\\.)?dailymotion\\.com\\/video\\/([a-zA-Z0-9]+)/;\n        const dailymotionMatch = originalUrl.match(dailymotionRegex);\n        if (dailymotionMatch) {\n            return `https://www.dailymotion.com/embed/video/${dailymotionMatch[1]}`;\n        }\n        // Reddit URLs\n        const redditRegex = /(?:https?:\\/\\/)?(?:www\\.|old\\.|m\\.|np\\.)?reddit\\.com\\/r\\/(\\w+)\\/comments\\/([a-zA-Z0-9]+)(?:\\/([^/]+))?/i;\n        const redditMatch = originalUrl.match(redditRegex);\n        if (redditMatch) {\n            return `https://www.reddit.com/r/${redditMatch[1]}/comments/${redditMatch[2]}/`;\n        }\n        // Twitch URLs\n        const twitchVideoRegex = /(?:https?:\\/\\/)?(?:www\\.)?twitch\\.tv\\/videos\\/(\\d+)/;\n        const twitchVideoMatch = originalUrl.match(twitchVideoRegex);\n        if (twitchVideoMatch) {\n            return `https://player.twitch.tv/?video=${twitchVideoMatch[1]}&parent=${ false ? 0 : \"localhost\"}`;\n        }\n        const twitchClipRegex = /(?:https?:\\/\\/)?clips\\.twitch\\.tv\\/([a-zA-Z0-9_-]+)/;\n        const twitchClipMatch = originalUrl.match(twitchClipRegex);\n        if (twitchClipMatch) {\n            return `https://clips.twitch.tv/embed?clip=${twitchClipMatch[1]}&parent=${ false ? 0 : \"localhost\"}`;\n        }\n        // Direct video files\n        const videoExtensions = [\n            \".mp4\",\n            \".mov\",\n            \".avi\",\n            \".mkv\",\n            \".webm\",\n            \".flv\",\n            \".wmv\",\n            \".m4v\"\n        ];\n        const urlPath = new URL(originalUrl).pathname.toLowerCase();\n        if (videoExtensions.some((ext)=>urlPath.endsWith(ext))) {\n            return originalUrl // Return original URL for direct video files\n            ;\n        }\n        // If it's already an embed URL or unsupported, return as is\n        return originalUrl;\n    }\n    async addTagToVideo(videoId, tagId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Check if video exists\n            const video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(videoId);\n            if (!video) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", videoId);\n            }\n            // Check if tag exists\n            const tag = await _repositories_tag_repository__WEBPACK_IMPORTED_MODULE_2__.tagRepository.findById(tagId);\n            if (!tag) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Tag\", tagId);\n            }\n            // Add tag to video (repository should handle duplicates)\n            await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.addTagToVideo(videoId, tagId);\n            return {\n                success: true\n            };\n        })();\n    }\n    async removeTagFromVideo(videoId, tagId) {\n        return (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.asyncWrapper)(async ()=>{\n            // Check if video exists\n            const video = await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.findById(videoId);\n            if (!video) {\n                throw (0,_lib_errors__WEBPACK_IMPORTED_MODULE_10__.createNotFoundError)(\"Video\", videoId);\n            }\n            // Remove tag from video\n            await _repositories_video_repository__WEBPACK_IMPORTED_MODULE_0__.videoRepository.removeTagFromVideo(videoId, tagId);\n            return {\n                success: true\n            };\n        })();\n    }\n    extractTagsFromVideo(data) {\n        if (data.tags && Array.isArray(data.tags)) {\n            return data.tags;\n        }\n        if (typeof data.tags === \"string\") {\n            return data.tags.split(\",\").map((tag)=>tag.trim()).filter(Boolean);\n        }\n        return [];\n    }\n}\n// Export singleton instance\nconst videoService = new VideoServiceImpl();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUs7Z0JBQ1IsTUFBTTVGLGlFQUFtQkEsQ0FBQyxPQUFPbUg7WUFDbkM7WUFFQSx5REFBeUQ7WUFDekQsTUFBTXBJLDJFQUFlQSxDQUFDK0ssYUFBYSxDQUFDekUsU0FBUzhCO1lBRTdDLE9BQU87Z0JBQ0x4RyxTQUFTO1lBQ1g7UUFDRjtJQUNGO0lBRUEsTUFBTW9KLG1CQUFtQjFFLE9BQWUsRUFBRThCLEtBQWEsRUFBOEI7UUFDbkYsT0FBT2hILDBEQUFZQSxDQUFDO1lBQ2xCLHdCQUF3QjtZQUN4QixNQUFNa0IsUUFBUSxNQUFNdEMsMkVBQWVBLENBQUNnRCxRQUFRLENBQUNzRDtZQUM3QyxJQUFJLENBQUNoRSxPQUFPO2dCQUNWLE1BQU1yQixpRUFBbUJBLENBQUMsU0FBU3FGO1lBQ3JDO1lBRUEsd0JBQXdCO1lBQ3hCLE1BQU10RywyRUFBZUEsQ0FBQ2dMLGtCQUFrQixDQUFDMUUsU0FBUzhCO1lBRWxELE9BQU87Z0JBQ0x4RyxTQUFTO1lBQ1g7UUFDRjtJQUNGO0lBRVFzRCxxQkFBcUJyRCxJQUFTLEVBQVk7UUFDaEQsSUFBSUEsS0FBS2lCLElBQUksSUFBSXNDLE1BQU1DLE9BQU8sQ0FBQ3hELEtBQUtpQixJQUFJLEdBQUc7WUFDekMsT0FBT2pCLEtBQUtpQixJQUFJO1FBQ2xCO1FBRUEsSUFBSSxPQUFPakIsS0FBS2lCLElBQUksS0FBSyxVQUFVO1lBQ2pDLE9BQU9qQixLQUFLaUIsSUFBSSxDQUFDbUksS0FBSyxDQUFDLEtBQUsxRixHQUFHLENBQUMsQ0FBQ3NCLE1BQWdCQSxJQUFJakMsSUFBSSxJQUFJc0csTUFBTSxDQUFDQztRQUN0RTtRQUVBLE9BQU8sRUFBRTtJQUNYO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUMsZUFBZSxJQUFJOUosbUJBQWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmF0ZW15LW5leHRqcy8uL3NyYy9zZXJ2aWNlcy92aWRlby5zZXJ2aWNlLnRzPzViNTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXG4gIFZpZGVvLCBcbiAgVmlkZW9GaWx0ZXJzLCBcbiAgQXBpUmVzcG9uc2UsIFxuICBQYWdpbmF0ZWRSZXNwb25zZSxcbiAgUmF0aW5nIFxufSBmcm9tICcuLi90eXBlcydcbmltcG9ydCB7IHZpZGVvUmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy92aWRlby5yZXBvc2l0b3J5J1xuaW1wb3J0IHsgcmF0aW5nUmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy9yYXRpbmcucmVwb3NpdG9yeSdcbmltcG9ydCB7IHRhZ1JlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMvdGFnLnJlcG9zaXRvcnknXG5pbXBvcnQgeyB1c2VyUmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy91c2VyLnJlcG9zaXRvcnknXG5pbXBvcnQgeyB2aWRlb01ldGFkYXRhU2VydmljZSB9IGZyb20gJy4vdmlkZW8tbWV0YWRhdGEuc2VydmljZSdcbmltcG9ydCB7IG5zZndTZXJ2aWNlIH0gZnJvbSAnLi9uc2Z3LnNlcnZpY2UnXG5pbXBvcnQgeyByZWRHaWZzU2VydmljZSB9IGZyb20gJy4vcmVkZ2lmcy5zZXJ2aWNlJ1xuaW1wb3J0IHsgcmVkZGl0U2VydmljZSB9IGZyb20gJy4vcmVkZGl0LnNlcnZpY2UnXG5pbXBvcnQgeyB4SGFtc3RlclNlcnZpY2UgfSBmcm9tICcuL3hoYW1zdGVyLnNlcnZpY2UnXG5pbXBvcnQgeyBcbiAgdmFsaWRhdGVTY2hlbWEsIFxuICBjcmVhdGVWaWRlb1NjaGVtYSwgXG4gIHVwZGF0ZVZpZGVvU2NoZW1hLFxuICB2aWRlb0ZpbHRlclNjaGVtYSxcbiAgcmF0aW5nU2NoZW1hLFxuICBzYW5pdGl6ZVRhZ3MgXG59IGZyb20gJy4uL2xpYi92YWxpZGF0aW9uJ1xuaW1wb3J0IHsgXG4gIE5vdEZvdW5kRXJyb3IsIFxuICBBdXRob3JpemF0aW9uRXJyb3IsXG4gIFZhbGlkYXRpb25FcnJvcixcbiAgY3JlYXRlTm90Rm91bmRFcnJvciBcbn0gZnJvbSAnLi4vbGliL2Vycm9ycydcbmltcG9ydCB7IGxvZ2dlciwgbG9nVXNlckFjdGlvbiB9IGZyb20gJy4uL2xpYi9sb2dnZXInXG5pbXBvcnQgeyBhc3luY1dyYXBwZXIgfSBmcm9tICcuLi9saWIvZXJyb3JzJ1xuaW1wb3J0IHsgVkFMSURBVElPTl9QQVRURVJOUyB9IGZyb20gJy4uL2xpYi9jb25zdGFudHMnXG5cbmV4cG9ydCBjbGFzcyBWaWRlb1NlcnZpY2VJbXBsIHtcbiAgYXN5bmMgZ2V0VmlkZW9zKGZpbHRlcnM/OiBWaWRlb0ZpbHRlcnMpOiBQcm9taXNlPFBhZ2luYXRlZFJlc3BvbnNlPFZpZGVvPj4ge1xuICAgIHJldHVybiBhc3luY1dyYXBwZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGVkRmlsdGVycyA9IGZpbHRlcnMgPyB2YWxpZGF0ZVNjaGVtYSh2aWRlb0ZpbHRlclNjaGVtYSwgZmlsdGVycykgOiB7fVxuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuZmluZFdpdGhGaWx0ZXJzKHZhbGlkYXRlZEZpbHRlcnMpXG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHJlc3VsdC52aWRlb3MsXG4gICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICBwYWdlOiB2YWxpZGF0ZWRGaWx0ZXJzLnBhZ2UgfHwgMSxcbiAgICAgICAgICBsaW1pdDogdmFsaWRhdGVkRmlsdGVycy5saW1pdCB8fCAxMixcbiAgICAgICAgICB0b3RhbDogcmVzdWx0LnRvdGFsLFxuICAgICAgICAgIHRvdGFsUGFnZXM6IHJlc3VsdC50b3RhbFBhZ2VzLFxuICAgICAgICB9LFxuICAgICAgfVxuICAgIH0pKClcbiAgfVxuXG4gIGFzeW5jIGdldFZpZGVvQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxBcGlSZXNwb25zZTxWaWRlbz4+IHtcbiAgICByZXR1cm4gYXN5bmNXcmFwcGVyKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHZpZGVvID0gYXdhaXQgdmlkZW9SZXBvc2l0b3J5LmZpbmRXaXRoUmF0aW5ncyhpZClcbiAgICAgIFxuICAgICAgaWYgKCF2aWRlbykge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdWaWRlbycsIGlkKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiB2aWRlbyxcbiAgICAgIH1cbiAgICB9KSgpXG4gIH1cblxuICBhc3luYyBjcmVhdGVWaWRlbyhcbiAgICBkYXRhOiBPbWl0PFZpZGVvLCAnaWQnIHwgJ2NyZWF0ZWRBdCcgfCAndXBkYXRlZEF0Jz4gJiB7IHRhZ1JhdGluZ3M/OiBBcnJheTx7bmFtZTogc3RyaW5nLCByYXRpbmc6IG51bWJlcn0+IH0sXG4gICAgdXNlcklkOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxBcGlSZXNwb25zZTxWaWRlbz4+IHtcbiAgICByZXR1cm4gYXN5bmNXcmFwcGVyKGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFZhbGlkYXRlIGlucHV0IC0gb3JpZ2luYWxVcmwgaXMgcmVxdWlyZWRcbiAgICAgIGNvbnN0IHZhbGlkYXRlZERhdGEgPSB2YWxpZGF0ZVNjaGVtYShjcmVhdGVWaWRlb1NjaGVtYSwge1xuICAgICAgICB0aXRsZTogZGF0YS50aXRsZSB8fCAnJywgLy8gQWxsb3cgZW1wdHkgdGl0bGUgZm9yIGF1dG8tZXh0cmFjdGlvblxuICAgICAgICBvcmlnaW5hbFVybDogZGF0YS5vcmlnaW5hbFVybCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIHRhZ3M6IFtdLCAvLyBXaWxsIGJlIGhhbmRsZWQgYnkgYXV0by1leHRyYWN0aW9uXG4gICAgICB9KVxuXG4gICAgICAvLyBWZXJpZnkgdXNlciBleGlzdHNcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1c2VyUmVwb3NpdG9yeS5maW5kQnlJZCh1c2VySWQpXG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgdGhyb3cgY3JlYXRlTm90Rm91bmRFcnJvcignVXNlcicsIHVzZXJJZClcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgbWV0YWRhdGEgd2FzIGFscmVhZHkgcHJvdmlkZWQgZnJvbSBleHRyYWN0LW1ldGFkYXRhIHN0ZXBcbiAgICAgIGxldCBleHRyYWN0ZWRNZXRhZGF0YSwgZW1iZWRVcmwsIGZpbmFsVGh1bWJuYWlsLCBwcmV2aWV3VXJsXG4gICAgICBcbiAgICAgIGlmIChkYXRhLmVtYmVkVXJsICYmIGRhdGEudGh1bWJuYWlsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gVXNlIHByb3ZpZGVkIG1ldGFkYXRhIGZyb20gZXh0cmFjdC1tZXRhZGF0YSBmbG93XG4gICAgICAgIGV4dHJhY3RlZE1ldGFkYXRhID0ge1xuICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlIHx8ICcnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICAgIHRhZ3M6IFtdLFxuICAgICAgICAgIHRodW1ibmFpbDogZGF0YS50aHVtYm5haWxcbiAgICAgICAgfVxuICAgICAgICBlbWJlZFVybCA9IGRhdGEuZW1iZWRVcmxcbiAgICAgICAgZmluYWxUaHVtYm5haWwgPSBkYXRhLnRodW1ibmFpbFxuICAgICAgICBwcmV2aWV3VXJsID0gZGF0YS5wcmV2aWV3VXJsIHx8IG51bGxcbiAgICAgIH0gZWxzZSBpZiAocmVkR2lmc1NlcnZpY2UuaXNSZWRHaWZzVXJsKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVkR2lmc0RhdGEgPSBhd2FpdCByZWRHaWZzU2VydmljZS5wcm9jZXNzUmVkR2lmc1VybCh2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsKVxuICAgICAgICAgIGV4dHJhY3RlZE1ldGFkYXRhID0ge1xuICAgICAgICAgICAgdGl0bGU6IHJlZEdpZnNEYXRhLm1ldGFkYXRhLnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlZEdpZnNEYXRhLm1ldGFkYXRhLmRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICAgICAgdGFnczogcmVkR2lmc0RhdGEudGFncyxcbiAgICAgICAgICAgIHRodW1ibmFpbDogcmVkR2lmc0RhdGEudGh1bWJuYWlsXG4gICAgICAgICAgfVxuICAgICAgICAgIGVtYmVkVXJsID0gcmVkR2lmc0RhdGEuZW1iZWRVcmwgLy8gVGhpcyB3aWxsIGJlIHRoZSBkaXJlY3QgdmlkZW8gVVJMXG4gICAgICAgICAgZmluYWxUaHVtYm5haWwgPSByZWRHaWZzRGF0YS50aHVtYm5haWxcbiAgICAgICAgICBsb2dnZXIuaW5mbygnUmVkR2lmcyBwcm9jZXNzaW5nIHN1Y2Nlc3NmdWwgZm9yIHZpZGVvIGNyZWF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiB2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsLFxuICAgICAgICAgICAgdGFnc0V4dHJhY3RlZDogcmVkR2lmc0RhdGEudGFncz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgICAgICBoYXNUYWdSYXRpbmdzOiAhIWRhdGEudGFnUmF0aW5ncyxcbiAgICAgICAgICAgIHRhZ1JhdGluZ3NDb3VudDogZGF0YS50YWdSYXRpbmdzPy5sZW5ndGggfHwgMFxuICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcHJvY2VzcyBSZWRHaWZzIFVSTCwgZmFsbGluZyBiYWNrIHRvIHN0YW5kYXJkIHByb2Nlc3NpbmcnLCB7IGVycm9yIH0pXG4gICAgICAgICAgZXh0cmFjdGVkTWV0YWRhdGEgPSBhd2FpdCB2aWRlb01ldGFkYXRhU2VydmljZS5leHRyYWN0TWV0YWRhdGEodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgICBlbWJlZFVybCA9IHRoaXMuY29udmVydFRvRW1iZWRVcmwodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgICBmaW5hbFRodW1ibmFpbCA9IGV4dHJhY3RlZE1ldGFkYXRhLnRodW1ibmFpbCB8fCBudWxsXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocmVkZGl0U2VydmljZS5pc1JlZGRpdFVybCh2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsKSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlZGRpdERhdGEgPSBhd2FpdCByZWRkaXRTZXJ2aWNlLnByb2Nlc3NSZWRkaXRVcmwodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgICBleHRyYWN0ZWRNZXRhZGF0YSA9IHtcbiAgICAgICAgICAgIHRpdGxlOiByZWRkaXREYXRhLm1ldGFkYXRhLnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlZGRpdERhdGEubWV0YWRhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgICB0YWdzOiByZWRkaXREYXRhLnRhZ3MsXG4gICAgICAgICAgICB0aHVtYm5haWw6IHJlZGRpdERhdGEudGh1bWJuYWlsXG4gICAgICAgICAgfVxuICAgICAgICAgIGVtYmVkVXJsID0gcmVkZGl0RGF0YS5lbWJlZFVybFxuICAgICAgICAgIGZpbmFsVGh1bWJuYWlsID0gcmVkZGl0RGF0YS50aHVtYm5haWxcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBwcm9jZXNzIFJlZGRpdCBVUkwsIGZhbGxpbmcgYmFjayB0byBzdGFuZGFyZCBwcm9jZXNzaW5nJywgeyBlcnJvciB9KVxuICAgICAgICAgIGV4dHJhY3RlZE1ldGFkYXRhID0gYXdhaXQgdmlkZW9NZXRhZGF0YVNlcnZpY2UuZXh0cmFjdE1ldGFkYXRhKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpXG4gICAgICAgICAgZW1iZWRVcmwgPSB0aGlzLmNvbnZlcnRUb0VtYmVkVXJsKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpXG4gICAgICAgICAgZmluYWxUaHVtYm5haWwgPSBleHRyYWN0ZWRNZXRhZGF0YS50aHVtYm5haWwgfHwgbnVsbFxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHhIYW1zdGVyU2VydmljZS5pc1hIYW1zdGVyVXJsKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeEhhbXN0ZXJEYXRhID0gYXdhaXQgeEhhbXN0ZXJTZXJ2aWNlLnByb2Nlc3NYSGFtc3RlclVybCh2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsKVxuICAgICAgICAgIGV4dHJhY3RlZE1ldGFkYXRhID0ge1xuICAgICAgICAgICAgdGl0bGU6IHhIYW1zdGVyRGF0YS50aXRsZSB8fCAnJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB4SGFtc3RlckRhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgICB0YWdzOiB4SGFtc3RlckRhdGEudGFncyB8fCBbXSxcbiAgICAgICAgICAgIHRodW1ibmFpbDogeEhhbXN0ZXJEYXRhLnRodW1ibmFpbFxuICAgICAgICAgIH1cbiAgICAgICAgICBlbWJlZFVybCA9IHRoaXMuY29udmVydFRvRW1iZWRVcmwodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgICBmaW5hbFRodW1ibmFpbCA9IHhIYW1zdGVyRGF0YS50aHVtYm5haWwgfHwgbnVsbFxuICAgICAgICAgIHByZXZpZXdVcmwgPSB4SGFtc3RlckRhdGEucHJldmlld1VybCB8fCBudWxsXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcHJvY2VzcyBYSGFtc3RlciBVUkwsIGZhbGxpbmcgYmFjayB0byBzdGFuZGFyZCBwcm9jZXNzaW5nJywgeyBlcnJvciB9KVxuICAgICAgICAgIGV4dHJhY3RlZE1ldGFkYXRhID0gYXdhaXQgdmlkZW9NZXRhZGF0YVNlcnZpY2UuZXh0cmFjdE1ldGFkYXRhKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpXG4gICAgICAgICAgZW1iZWRVcmwgPSB0aGlzLmNvbnZlcnRUb0VtYmVkVXJsKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpXG4gICAgICAgICAgZmluYWxUaHVtYm5haWwgPSBleHRyYWN0ZWRNZXRhZGF0YS50aHVtYm5haWwgfHwgbnVsbFxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBFeHRyYWN0IG1ldGFkYXRhIGF1dG9tYXRpY2FsbHkgZnJvbSB2aWRlbyBVUkxcbiAgICAgICAgZXh0cmFjdGVkTWV0YWRhdGEgPSBhd2FpdCB2aWRlb01ldGFkYXRhU2VydmljZS5leHRyYWN0TWV0YWRhdGEodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgXG4gICAgICAgIC8vIENvbnZlcnQgb3JpZ2luYWwgVVJMIHRvIGVtYmVkIFVSTFxuICAgICAgICBlbWJlZFVybCA9IHRoaXMuY29udmVydFRvRW1iZWRVcmwodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgZmluYWxUaHVtYm5haWwgPSBleHRyYWN0ZWRNZXRhZGF0YS50aHVtYm5haWwgfHwgbnVsbFxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBVc2UgZXh0cmFjdGVkIGRhdGEgb3IgZmFsbGJhY2sgdG8gcHJvdmlkZWQgZGF0YVxuICAgICAgbGV0IGZpbmFsVGl0bGUgPSBkYXRhLnRpdGxlPy50cmltKCkgfHwgZXh0cmFjdGVkTWV0YWRhdGEudGl0bGVcbiAgICAgIFxuICAgICAgLy8gSWYgc3RpbGwgbm8gdGl0bGUsIGdlbmVyYXRlIG9uZSBmcm9tIHRoZSBVUkxcbiAgICAgIGlmICghZmluYWxUaXRsZSkge1xuICAgICAgICBpZiAodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybC5pbmNsdWRlcygncmVkZ2lmcy5jb20nKSkge1xuICAgICAgICAgIGNvbnN0IG1hdGNoID0gdmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybC5tYXRjaCgvXFwvd2F0Y2hcXC8oW2EtekEtWjAtOV0rKS8pXG4gICAgICAgICAgY29uc3QgZ2lmSWQgPSBtYXRjaCA/IG1hdGNoWzFdIDogJ3ZpZGVvJ1xuICAgICAgICAgIGZpbmFsVGl0bGUgPSBgUmVkR2lmcyAke2dpZklkfWBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmaW5hbFRpdGxlID0gJ1VudGl0bGVkIFZpZGVvJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGZpbmFsRGVzY3JpcHRpb24gPSBkYXRhLmRlc2NyaXB0aW9uPy50cmltKCkgfHwgZXh0cmFjdGVkTWV0YWRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbFxuXG4gICAgICAvLyBDb21iaW5lIHByb3ZpZGVkIHRhZ3Mgd2l0aCBleHRyYWN0ZWQgdGFncyBhbmQgcmF0ZWQgdGFnc1xuICAgICAgY29uc3QgcHJvdmlkZWRUYWdzID0gZGF0YS50YWdzID8gdGhpcy5leHRyYWN0VGFnc0Zyb21WaWRlbyhkYXRhKSA6IFtdXG4gICAgICBjb25zdCBleHRyYWN0ZWRUYWdzID0gQXJyYXkuaXNBcnJheShleHRyYWN0ZWRNZXRhZGF0YS50YWdzKSA/IGV4dHJhY3RlZE1ldGFkYXRhLnRhZ3MgOiBbXVxuICAgICAgY29uc3QgcmF0ZWRUYWdzID0gZGF0YS50YWdSYXRpbmdzID8gZGF0YS50YWdSYXRpbmdzLm1hcCh0ciA9PiB0ci5uYW1lKSA6IFtdIC8vIEluY2x1ZGUgYWxsIHJhdGVkIHRhZ3MsIGV2ZW4gcmF0aW5nIDBcbiAgICAgIFxuICAgICAgY29uc3QgY29tYmluZWRUYWdzID0gQXJyYXkuZnJvbShuZXcgU2V0KFsuLi5wcm92aWRlZFRhZ3MsIC4uLmV4dHJhY3RlZFRhZ3MsIC4uLnJhdGVkVGFnc10pKVxuICAgICAgY29uc3Qgc2FuaXRpemVkVGFncyA9IHNhbml0aXplVGFncyhjb21iaW5lZFRhZ3MpXG4gICAgICBcbiAgICAgIGxvZ2dlci5pbmZvKCdQcm9jZXNzaW5nIHRhZ3MgZm9yIHZpZGVvIGNyZWF0aW9uJywge1xuICAgICAgICBwcm92aWRlZFRhZ3M6IHByb3ZpZGVkVGFncy5sZW5ndGgsXG4gICAgICAgIGV4dHJhY3RlZFRhZ3M6IGV4dHJhY3RlZFRhZ3MubGVuZ3RoLFxuICAgICAgICByYXRlZFRhZ3M6IHJhdGVkVGFncy5sZW5ndGgsXG4gICAgICAgIGNvbWJpbmVkVGFnczogY29tYmluZWRUYWdzLmxlbmd0aCxcbiAgICAgICAgc2FuaXRpemVkVGFnczogc2FuaXRpemVkVGFncy5sZW5ndGgsXG4gICAgICAgIGZpbmFsVGFnczogc2FuaXRpemVkVGFnc1xuICAgICAgfSlcblxuICAgICAgLy8gRGV0ZWN0IE5TRlcgY29udGVudCBhdXRvbWF0aWNhbGx5IG9yIHVzZSBwcm92aWRlZCB2YWx1ZVxuICAgICAgbGV0IGlzTlNGVzogYm9vbGVhblxuICAgICAgaWYgKGRhdGEuaXNOc2Z3ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gVXNlIHByb3ZpZGVkIE5TRlcgc3RhdHVzIGZyb20gZXh0cmFjdC1tZXRhZGF0YSBmbG93XG4gICAgICAgIGlzTlNGVyA9IGRhdGEuaXNOc2Z3XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBhdXRvbWF0aWMgZGV0ZWN0aW9uXG4gICAgICAgIGNvbnN0IGlzUmVkR2lmcyA9IHJlZEdpZnNTZXJ2aWNlLmlzUmVkR2lmc1VybCh2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsKVxuICAgICAgICBjb25zdCBpc1JlZGRpdCA9IHJlZGRpdFNlcnZpY2UuaXNSZWRkaXRVcmwodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybClcbiAgICAgICAgY29uc3QgaXNYSGFtc3RlciA9IHhIYW1zdGVyU2VydmljZS5pc1hIYW1zdGVyVXJsKHZhbGlkYXRlZERhdGEub3JpZ2luYWxVcmwpXG4gICAgICAgIFxuICAgICAgICBpZiAoaXNSZWRHaWZzIHx8IGlzWEhhbXN0ZXIpIHtcbiAgICAgICAgICBpc05TRlcgPSB0cnVlIC8vIFJlZEdpZnMgYW5kIFhIYW1zdGVyIGFyZSBhdXRvbWF0aWNhbGx5IE5TRldcbiAgICAgICAgfSBlbHNlIGlmIChpc1JlZGRpdCAmJiBBcnJheS5pc0FycmF5KGV4dHJhY3RlZE1ldGFkYXRhLnRhZ3MpICYmIGV4dHJhY3RlZE1ldGFkYXRhLnRhZ3MuaW5jbHVkZXMoJ25zZncnKSkge1xuICAgICAgICAgIGlzTlNGVyA9IHRydWUgLy8gUmVkZGl0IG1hcmtlZCBhcyBOU0ZXXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXNOU0ZXID0gYXdhaXQgbnNmd1NlcnZpY2UuZGV0ZWN0TlNGVyhmaW5hbFRpdGxlLCBmaW5hbERlc2NyaXB0aW9uIHx8IHVuZGVmaW5lZClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgdmlkZW8gd2l0aCB0YWdzXG4gICAgICBsZXQgdmlkZW9cbiAgICAgIHRyeSB7XG4gICAgICAgIHZpZGVvID0gYXdhaXQgdmlkZW9SZXBvc2l0b3J5LmNyZWF0ZVdpdGhUYWdzKHtcbiAgICAgICAgICB0aXRsZTogZmluYWxUaXRsZSxcbiAgICAgICAgICBvcmlnaW5hbFVybDogdmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybCxcbiAgICAgICAgICBlbWJlZFVybCxcbiAgICAgICAgICB0aHVtYm5haWw6IGZpbmFsVGh1bWJuYWlsIHx8IG51bGwsXG4gICAgICAgICAgcHJldmlld1VybDogcHJldmlld1VybCB8fCBudWxsLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBmaW5hbERlc2NyaXB0aW9uLFxuICAgICAgICAgIGlzTnNmdzogaXNOU0ZXLFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgfSwgc2FuaXRpemVkVGFncylcbiAgICAgICAgXG4gICAgICAgIGxvZ2dlci5pbmZvKCdWaWRlbyBjcmVhdGVkIHN1Y2Nlc3NmdWxseScsIHsgXG4gICAgICAgICAgdmlkZW9JZDogdmlkZW8uaWQsIFxuICAgICAgICAgIHRpdGxlOiBmaW5hbFRpdGxlLFxuICAgICAgICAgIHRhZ3NDb3VudDogc2FuaXRpemVkVGFncy5sZW5ndGggXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gSGFuZGxlIHRhZyByYXRpbmdzIGlmIHByb3ZpZGVkXG4gICAgICAgIGlmIChkYXRhLnRhZ1JhdGluZ3MgJiYgZGF0YS50YWdSYXRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IHJhdGluZ3NDcmVhdGVkID0gMFxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ0NyZWF0aW5nIHRhZyByYXRpbmdzIGZvciB2aWRlbycsIHtcbiAgICAgICAgICAgICAgdmlkZW9JZDogdmlkZW8uaWQsXG4gICAgICAgICAgICAgIHRvdGFsVGFnUmF0aW5nczogZGF0YS50YWdSYXRpbmdzLmxlbmd0aFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIChjb25zdCB0YWdSYXRpbmcgb2YgZGF0YS50YWdSYXRpbmdzKSB7XG4gICAgICAgICAgICAgIGlmICh0YWdSYXRpbmcucmF0aW5nID49IDApIHsgLy8gQWxsb3cgcmF0aW5nIDAgKG5vdCByZWxldmFudClcbiAgICAgICAgICAgICAgICAvLyBTYW5pdGl6ZSB0YWcgbmFtZSB0byBlbnN1cmUgY29uc2lzdGVuY3kgd2l0aCB2aWRlbyB0YWdzXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FuaXRpemVkVGFnTmFtZSA9IHNhbml0aXplVGFncyhbdGFnUmF0aW5nLm5hbWVdKVswXVxuICAgICAgICAgICAgICAgIGlmICghc2FuaXRpemVkVGFnTmFtZSkgY29udGludWVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBGaW5kIG9yIGNyZWF0ZSB0aGUgdGFnIChlbnN1cmUgaXQgZXhpc3RzKVxuICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IGF3YWl0IHRhZ1JlcG9zaXRvcnkuZmluZE9yQ3JlYXRlKHNhbml0aXplZFRhZ05hbWUpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyB0YWcgaXMgYWN0dWFsbHkgYXNzb2NpYXRlZCB3aXRoIHRoZSB2aWRlb1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZGVvSGFzVGFnID0gc2FuaXRpemVkVGFncy5pbmNsdWRlcyhzYW5pdGl6ZWRUYWdOYW1lKVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh2aWRlb0hhc1RhZykge1xuICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgcmF0aW5nIGZvciB0aGlzIHRhZyB1c2luZyB0aGUgdXBzZXJ0IG1ldGhvZFxuICAgICAgICAgICAgICAgICAgYXdhaXQgcmF0aW5nUmVwb3NpdG9yeS51cHNlcnRSYXRpbmcoXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvLmlkLFxuICAgICAgICAgICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICAgICAgICAgIHRhZy5pZCxcbiAgICAgICAgICAgICAgICAgICAgdGFnUmF0aW5nLnJhdGluZ1xuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgcmF0aW5nc0NyZWF0ZWQrK1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBsb2dnZXIud2FybignU2tpcHBpbmcgcmF0aW5nIGZvciB0YWcgbm90IGFzc29jaWF0ZWQgd2l0aCB2aWRlbycsIHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxUYWdOYW1lOiB0YWdSYXRpbmcubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2FuaXRpemVkVGFnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdmlkZW9JZDogdmlkZW8uaWRcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdUYWcgcmF0aW5ncyBjcmVhdGlvbiBjb21wbGV0ZWQnLCB7XG4gICAgICAgICAgICAgIHZpZGVvSWQ6IHZpZGVvLmlkLFxuICAgICAgICAgICAgICByYXRpbmdzQ3JlYXRlZCxcbiAgICAgICAgICAgICAgdG90YWxQcm9jZXNzZWQ6IGRhdGEudGFnUmF0aW5ncy5sZW5ndGhcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBjYXRjaCAocmF0aW5nRXJyb3IpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSB0YWcgcmF0aW5ncycsIHtcbiAgICAgICAgICAgICAgZXJyb3I6IHJhdGluZ0Vycm9yLFxuICAgICAgICAgICAgICB2aWRlb0lkOiB2aWRlby5pZCxcbiAgICAgICAgICAgICAgdGFnUmF0aW5nczogZGF0YS50YWdSYXRpbmdzXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy8gRG9uJ3QgdGhyb3cgaGVyZSAtIHZpZGVvIHdhcyBjcmVhdGVkIHN1Y2Nlc3NmdWxseSwgcmF0aW5ncyBhcmUgb3B0aW9uYWxcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGNyZWF0ZUVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSB2aWRlbyBpbiBkYXRhYmFzZScsIHtcbiAgICAgICAgICBlcnJvcjogY3JlYXRlRXJyb3IsXG4gICAgICAgICAgdmlkZW9EYXRhOiB7XG4gICAgICAgICAgICB0aXRsZTogZmluYWxUaXRsZSxcbiAgICAgICAgICAgIG9yaWdpbmFsVXJsOiB2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsLFxuICAgICAgICAgICAgZW1iZWRVcmwsXG4gICAgICAgICAgICB0aHVtYm5haWw6IGZpbmFsVGh1bWJuYWlsLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGZpbmFsRGVzY3JpcHRpb24sXG4gICAgICAgICAgICBpc05zZnc6IGlzTlNGVyxcbiAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRhZ3M6IHNhbml0aXplZFRhZ3NcbiAgICAgICAgfSlcbiAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3JcbiAgICAgIH1cblxuICAgICAgbG9nVXNlckFjdGlvbigndmlkZW9fY3JlYXRlZCcsIHVzZXJJZCwgeyBcbiAgICAgICAgdmlkZW9JZDogdmlkZW8uaWQsIFxuICAgICAgICB0aXRsZTogdmlkZW8udGl0bGUsXG4gICAgICAgIGF1dG9FeHRyYWN0ZWQ6ICFkYXRhLnRpdGxlIHx8ICFkYXRhLmRlc2NyaXB0aW9uIFxuICAgICAgfSlcblxuICAgICAgLy8gUmVmZXRjaCB0aGUgdmlkZW8gd2l0aCBhbGwgcmF0aW5ncyB0byBlbnN1cmUgZnJlc2ggZGF0YVxuICAgICAgY29uc3QgdmlkZW9XaXRoUmF0aW5ncyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5maW5kV2l0aFJhdGluZ3ModmlkZW8uaWQpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHZpZGVvV2l0aFJhdGluZ3MgfHwgdmlkZW8sXG4gICAgICB9XG4gICAgfSkoKVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlVmlkZW8oXG4gICAgaWQ6IHN0cmluZywgXG4gICAgZGF0YTogUGFydGlhbDxWaWRlbz4sXG4gICAgdXNlcklkOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxBcGlSZXNwb25zZTxWaWRlbz4+IHtcbiAgICByZXR1cm4gYXN5bmNXcmFwcGVyKGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEZpbmQgZXhpc3RpbmcgdmlkZW9cbiAgICAgIGNvbnN0IGV4aXN0aW5nVmlkZW8gPSBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuZmluZEJ5SWQoaWQpXG4gICAgICBpZiAoIWV4aXN0aW5nVmlkZW8pIHtcbiAgICAgICAgdGhyb3cgY3JlYXRlTm90Rm91bmRFcnJvcignVmlkZW8nLCBpZClcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgb3duZXJzaGlwXG4gICAgICBpZiAoZXhpc3RpbmdWaWRlby51c2VySWQgIT09IHVzZXJJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aG9yaXphdGlvbkVycm9yKCdZb3UgY2FuIG9ubHkgdXBkYXRlIHlvdXIgb3duIHZpZGVvcycpXG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGlucHV0XG4gICAgICBjb25zdCB2YWxpZGF0ZWREYXRhID0gdmFsaWRhdGVTY2hlbWEodXBkYXRlVmlkZW9TY2hlbWEsIGRhdGEpXG5cbiAgICAgIC8vIFVwZGF0ZSBlbWJlZCBVUkwgaWYgb3JpZ2luYWwgVVJMIGNoYW5nZWRcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IGFueSA9IHsgLi4udmFsaWRhdGVkRGF0YSB9XG4gICAgICBpZiAodmFsaWRhdGVkRGF0YS5vcmlnaW5hbFVybCkge1xuICAgICAgICB1cGRhdGVEYXRhLmVtYmVkVXJsID0gdGhpcy5jb252ZXJ0VG9FbWJlZFVybCh2YWxpZGF0ZWREYXRhLm9yaWdpbmFsVXJsKVxuICAgICAgfVxuXG4gICAgICAvLyBVcGRhdGUgdmlkZW9cbiAgICAgIGNvbnN0IHVwZGF0ZWRWaWRlbyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS51cGRhdGUoaWQsIHVwZGF0ZURhdGEpXG5cbiAgICAgIGxvZ1VzZXJBY3Rpb24oJ3ZpZGVvX3VwZGF0ZWQnLCB1c2VySWQsIHsgdmlkZW9JZDogaWQgfSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogdXBkYXRlZFZpZGVvLFxuICAgICAgfVxuICAgIH0pKClcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVZpZGVvKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxBcGlSZXNwb25zZTx2b2lkPj4ge1xuICAgIHJldHVybiBhc3luY1dyYXBwZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gRmluZCBleGlzdGluZyB2aWRlb1xuICAgICAgY29uc3QgZXhpc3RpbmdWaWRlbyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5maW5kQnlJZChpZClcbiAgICAgIGlmICghZXhpc3RpbmdWaWRlbykge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdWaWRlbycsIGlkKVxuICAgICAgfVxuXG4gICAgICAvLyBHZXQgdXNlciB0byBjaGVjayBpZiB0aGV5J3JlIGFkbWluXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXNlclJlcG9zaXRvcnkuZmluZEJ5SWQodXNlcklkKVxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHRocm93IGNyZWF0ZU5vdEZvdW5kRXJyb3IoJ1VzZXInLCB1c2VySWQpXG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIG93bmVyc2hpcCBvciBhZG1pbiBzdGF0dXNcbiAgICAgIGNvbnN0IGlzT3duZXIgPSBleGlzdGluZ1ZpZGVvLnVzZXJJZCA9PT0gdXNlcklkXG4gICAgICBjb25zdCBpc0FkbWluID0gKHVzZXIgYXMgYW55KS5pc0FkbWluID09PSB0cnVlXG4gICAgICBcbiAgICAgIGlmICghaXNPd25lciAmJiAhaXNBZG1pbikge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aG9yaXphdGlvbkVycm9yKCdZb3UgY2FuIG9ubHkgZGVsZXRlIHlvdXIgb3duIHZpZGVvcyBvciBtdXN0IGJlIGFuIGFkbWluJylcbiAgICAgIH1cblxuICAgICAgLy8gRGVsZXRlIHZpZGVvIChjYXNjYWRlIHdpbGwgaGFuZGxlIHJlbGF0ZWQgcmVjb3JkcylcbiAgICAgIGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5kZWxldGUoaWQpXG5cbiAgICAgIGxvZ1VzZXJBY3Rpb24oJ3ZpZGVvX2RlbGV0ZWQnLCB1c2VySWQsIHsgXG4gICAgICAgIHZpZGVvSWQ6IGlkLCBcbiAgICAgICAgdGl0bGU6IGV4aXN0aW5nVmlkZW8udGl0bGUsXG4gICAgICAgIGlzQWRtaW5EZWxldGU6ICFpc093bmVyIFxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIH1cbiAgICB9KSgpXG4gIH1cblxuICBhc3luYyByYXRlVmlkZW8oXG4gICAgdmlkZW9JZDogc3RyaW5nLCBcbiAgICB0YWdJZDogc3RyaW5nLCBcbiAgICBsZXZlbDogbnVtYmVyLFxuICAgIHVzZXJJZDogc3RyaW5nXG4gICk6IFByb21pc2U8QXBpUmVzcG9uc2U8UmF0aW5nPj4ge1xuICAgIHJldHVybiBhc3luY1dyYXBwZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVmFsaWRhdGUgaW5wdXRcbiAgICAgIGNvbnN0IHZhbGlkYXRlZERhdGEgPSB2YWxpZGF0ZVNjaGVtYShyYXRpbmdTY2hlbWEsIHsgdGFnSWQsIGxldmVsIH0pXG5cbiAgICAgIC8vIENoZWNrIGlmIHZpZGVvIGV4aXN0c1xuICAgICAgY29uc3QgdmlkZW8gPSBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuZmluZEJ5SWQodmlkZW9JZClcbiAgICAgIGlmICghdmlkZW8pIHtcbiAgICAgICAgdGhyb3cgY3JlYXRlTm90Rm91bmRFcnJvcignVmlkZW8nLCB2aWRlb0lkKVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0c1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHVzZXJSZXBvc2l0b3J5LmZpbmRCeUlkKHVzZXJJZClcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdVc2VyJywgdXNlcklkKVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiB0YWcgZXhpc3RzXG4gICAgICBjb25zdCB0YWcgPSBhd2FpdCB0YWdSZXBvc2l0b3J5LmZpbmRCeUlkKHZhbGlkYXRlZERhdGEudGFnSWQpXG4gICAgICBpZiAoIXRhZykge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdUYWcnLCB2YWxpZGF0ZWREYXRhLnRhZ0lkKVxuICAgICAgfVxuXG5cbiAgICAgIC8vIFVwc2VydCByYXRpbmdcbiAgICAgIGNvbnN0IHJhdGluZyA9IGF3YWl0IHJhdGluZ1JlcG9zaXRvcnkudXBzZXJ0UmF0aW5nKFxuICAgICAgICB2aWRlb0lkLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHZhbGlkYXRlZERhdGEudGFnSWQsXG4gICAgICAgIHZhbGlkYXRlZERhdGEubGV2ZWxcbiAgICAgIClcblxuICAgICAgbG9nVXNlckFjdGlvbigndmlkZW9fcmF0ZWQnLCB1c2VySWQsIHsgXG4gICAgICAgIHZpZGVvSWQsIFxuICAgICAgICB0YWdJZDogdmFsaWRhdGVkRGF0YS50YWdJZCwgXG4gICAgICAgIGxldmVsOiB2YWxpZGF0ZWREYXRhLmxldmVsIFxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogcmF0aW5nLFxuICAgICAgfVxuICAgIH0pKClcbiAgfVxuXG4gIGFzeW5jIGdldFZpZGVvc0J5VXNlcih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8QXBpUmVzcG9uc2U8VmlkZW9bXT4+IHtcbiAgICByZXR1cm4gYXN5bmNXcmFwcGVyKGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXNlclJlcG9zaXRvcnkuZmluZEJ5SWQodXNlcklkKVxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHRocm93IGNyZWF0ZU5vdEZvdW5kRXJyb3IoJ1VzZXInLCB1c2VySWQpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHZpZGVvcyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5maW5kQnlVc2VySWQodXNlcklkKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiB2aWRlb3MsXG4gICAgICB9XG4gICAgfSkoKVxuICB9XG5cbiAgYXN5bmMgc2VhcmNoVmlkZW9zKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPEFwaVJlc3BvbnNlPFZpZGVvW10+PiB7XG4gICAgcmV0dXJuIGFzeW5jV3JhcHBlcihhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXF1ZXJ5IHx8IHF1ZXJ5LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignU2VhcmNoIHF1ZXJ5IGlzIHJlcXVpcmVkJywgJ3F1ZXJ5JylcbiAgICAgIH1cblxuICAgICAgY29uc3QgdmlkZW9zID0gYXdhaXQgdmlkZW9SZXBvc2l0b3J5LnNlYXJjaChxdWVyeS50cmltKCkpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHZpZGVvcyxcbiAgICAgIH1cbiAgICB9KSgpXG4gIH1cblxuICBhc3luYyBnZXRWaWRlb3NCeVRhZ3ModGFnczogc3RyaW5nW10pOiBQcm9taXNlPEFwaVJlc3BvbnNlPFZpZGVvW10+PiB7XG4gICAgcmV0dXJuIGFzeW5jV3JhcHBlcihhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRhZ3MgfHwgdGFncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignQXQgbGVhc3Qgb25lIHRhZyBpcyByZXF1aXJlZCcsICd0YWdzJylcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2FuaXRpemVkVGFncyA9IHNhbml0aXplVGFncyh0YWdzKVxuICAgICAgY29uc3QgdmlkZW9zID0gYXdhaXQgdmlkZW9SZXBvc2l0b3J5LmZpbmRCeVRhZ3Moc2FuaXRpemVkVGFncylcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogdmlkZW9zLFxuICAgICAgfVxuICAgIH0pKClcbiAgfVxuXG4gIGFzeW5jIGdldFRyZW5kaW5nVmlkZW9zKGxpbWl0OiBudW1iZXIgPSAxMCk6IFByb21pc2U8QXBpUmVzcG9uc2U8VmlkZW9bXT4+IHtcbiAgICByZXR1cm4gYXN5bmNXcmFwcGVyKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHZpZGVvcyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5nZXRUcmVuZGluZ1ZpZGVvcyhsaW1pdClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogdmlkZW9zLFxuICAgICAgfVxuICAgIH0pKClcbiAgfVxuXG4gIGFzeW5jIGdldFZpZGVvU3RhdHModmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxBcGlSZXNwb25zZTx7XG4gICAgdG90YWxSYXRpbmdzOiBudW1iZXJcbiAgICBhdmVyYWdlUmF0aW5nQnlUYWc6IEFycmF5PHsgdGFnTmFtZTogc3RyaW5nOyBhdmVyYWdlUmF0aW5nOiBudW1iZXI7IGNvdW50OiBudW1iZXIgfT5cbiAgfT4+IHtcbiAgICByZXR1cm4gYXN5bmNXcmFwcGVyKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHZpZGVvID0gYXdhaXQgdmlkZW9SZXBvc2l0b3J5LmZpbmRCeUlkKHZpZGVvSWQpXG4gICAgICBpZiAoIXZpZGVvKSB7XG4gICAgICAgIHRocm93IGNyZWF0ZU5vdEZvdW5kRXJyb3IoJ1ZpZGVvJywgdmlkZW9JZClcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuZ2V0VmlkZW9TdGF0cyh2aWRlb0lkKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBzdGF0cyxcbiAgICAgIH1cbiAgICB9KSgpXG4gIH1cblxuICBwcml2YXRlIGNvbnZlcnRUb0VtYmVkVXJsKG9yaWdpbmFsVXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIFlvdVR1YmUgVVJMc1xuICAgIGNvbnN0IHlvdXR1YmVNYXRjaCA9IG9yaWdpbmFsVXJsLm1hdGNoKFZBTElEQVRJT05fUEFUVEVSTlMuWU9VVFVCRV9VUkwpXG4gICAgaWYgKHlvdXR1YmVNYXRjaCkge1xuICAgICAgcmV0dXJuIGBodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8ke3lvdXR1YmVNYXRjaFsxXX1gXG4gICAgfVxuXG4gICAgLy8gVmltZW8gVVJMc1xuICAgIGNvbnN0IHZpbWVvTWF0Y2ggPSBvcmlnaW5hbFVybC5tYXRjaChWQUxJREFUSU9OX1BBVFRFUk5TLlZJTUVPX1VSTClcbiAgICBpZiAodmltZW9NYXRjaCkge1xuICAgICAgcmV0dXJuIGBodHRwczovL3BsYXllci52aW1lby5jb20vdmlkZW8vJHt2aW1lb01hdGNoWzFdfWBcbiAgICB9XG5cbiAgICAvLyBSZWRHaWZzIFVSTHMgLSBmYWxsYmFjayBpZiBub3QgcHJvY2Vzc2VkIGJ5IFJlZEdpZnMgc2VydmljZVxuICAgIGNvbnN0IHJlZGdpZnNSZWdleCA9IC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pP3JlZGdpZnNcXC5jb21cXC8oPzp3YXRjaFxcL3xpZnJcXC8pKFthLXpBLVowLTldKykvaVxuICAgIGNvbnN0IHJlZGdpZnNNYXRjaCA9IG9yaWdpbmFsVXJsLm1hdGNoKHJlZGdpZnNSZWdleClcbiAgICBpZiAocmVkZ2lmc01hdGNoKSB7XG4gICAgICByZXR1cm4gYGh0dHBzOi8vd3d3LnJlZGdpZnMuY29tL2lmci8ke3JlZGdpZnNNYXRjaFsxXX1gXG4gICAgfVxuXG4gICAgLy8gVGlrVG9rIFVSTHNcbiAgICBjb25zdCB0aWt0b2tSZWdleCA9IC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pP3Rpa3Rva1xcLmNvbVxcL0BbXFx3Li1dK1xcL3ZpZGVvXFwvKFxcZCspL1xuICAgIGNvbnN0IHRpa3Rva01hdGNoID0gb3JpZ2luYWxVcmwubWF0Y2godGlrdG9rUmVnZXgpXG4gICAgaWYgKHRpa3Rva01hdGNoKSB7XG4gICAgICByZXR1cm4gYGh0dHBzOi8vd3d3LnRpa3Rvay5jb20vZW1iZWQvdjIvJHt0aWt0b2tNYXRjaFsxXX1gXG4gICAgfVxuXG4gICAgLy8gSW5zdGFncmFtIFVSTHNcbiAgICBjb25zdCBpbnN0YWdyYW1SZWdleCA9IC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pP2luc3RhZ3JhbVxcLmNvbVxcLyg/OnB8cmVlbClcXC8oW2EtekEtWjAtOV8tXSspL1xuICAgIGNvbnN0IGluc3RhZ3JhbU1hdGNoID0gb3JpZ2luYWxVcmwubWF0Y2goaW5zdGFncmFtUmVnZXgpXG4gICAgaWYgKGluc3RhZ3JhbU1hdGNoKSB7XG4gICAgICByZXR1cm4gYGh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vcC8ke2luc3RhZ3JhbU1hdGNoWzFdfS9lbWJlZC9gXG4gICAgfVxuXG4gICAgLy8gVHdpdHRlci9YIFVSTHNcbiAgICBjb25zdCB0d2l0dGVyUmVnZXggPSAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT8oPzp0d2l0dGVyXFwuY29tfHhcXC5jb20pXFwvXFx3K1xcL3N0YXR1c1xcLyhcXGQrKS9cbiAgICBjb25zdCB0d2l0dGVyTWF0Y2ggPSBvcmlnaW5hbFVybC5tYXRjaCh0d2l0dGVyUmVnZXgpXG4gICAgaWYgKHR3aXR0ZXJNYXRjaCkge1xuICAgICAgcmV0dXJuIGBodHRwczovL3BsYXRmb3JtLnR3aXR0ZXIuY29tL2VtYmVkL1R3ZWV0Lmh0bWw/aWQ9JHt0d2l0dGVyTWF0Y2hbMV19YFxuICAgIH1cblxuICAgIC8vIERhaWx5bW90aW9uIFVSTHNcbiAgICBjb25zdCBkYWlseW1vdGlvblJlZ2V4ID0gLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/ZGFpbHltb3Rpb25cXC5jb21cXC92aWRlb1xcLyhbYS16QS1aMC05XSspL1xuICAgIGNvbnN0IGRhaWx5bW90aW9uTWF0Y2ggPSBvcmlnaW5hbFVybC5tYXRjaChkYWlseW1vdGlvblJlZ2V4KVxuICAgIGlmIChkYWlseW1vdGlvbk1hdGNoKSB7XG4gICAgICByZXR1cm4gYGh0dHBzOi8vd3d3LmRhaWx5bW90aW9uLmNvbS9lbWJlZC92aWRlby8ke2RhaWx5bW90aW9uTWF0Y2hbMV19YFxuICAgIH1cblxuICAgIC8vIFJlZGRpdCBVUkxzXG4gICAgY29uc3QgcmVkZGl0UmVnZXggPSAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwufG9sZFxcLnxtXFwufG5wXFwuKT9yZWRkaXRcXC5jb21cXC9yXFwvKFxcdyspXFwvY29tbWVudHNcXC8oW2EtekEtWjAtOV0rKSg/OlxcLyhbXi9dKykpPy9pXG4gICAgY29uc3QgcmVkZGl0TWF0Y2ggPSBvcmlnaW5hbFVybC5tYXRjaChyZWRkaXRSZWdleClcbiAgICBpZiAocmVkZGl0TWF0Y2gpIHtcbiAgICAgIHJldHVybiBgaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9yLyR7cmVkZGl0TWF0Y2hbMV19L2NvbW1lbnRzLyR7cmVkZGl0TWF0Y2hbMl19L2BcbiAgICB9XG5cbiAgICAvLyBUd2l0Y2ggVVJMc1xuICAgIGNvbnN0IHR3aXRjaFZpZGVvUmVnZXggPSAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT90d2l0Y2hcXC50dlxcL3ZpZGVvc1xcLyhcXGQrKS9cbiAgICBjb25zdCB0d2l0Y2hWaWRlb01hdGNoID0gb3JpZ2luYWxVcmwubWF0Y2godHdpdGNoVmlkZW9SZWdleClcbiAgICBpZiAodHdpdGNoVmlkZW9NYXRjaCkge1xuICAgICAgcmV0dXJuIGBodHRwczovL3BsYXllci50d2l0Y2gudHYvP3ZpZGVvPSR7dHdpdGNoVmlkZW9NYXRjaFsxXX0mcGFyZW50PSR7dHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgOiAnbG9jYWxob3N0J31gXG4gICAgfVxuXG4gICAgY29uc3QgdHdpdGNoQ2xpcFJlZ2V4ID0gLyg/Omh0dHBzPzpcXC9cXC8pP2NsaXBzXFwudHdpdGNoXFwudHZcXC8oW2EtekEtWjAtOV8tXSspL1xuICAgIGNvbnN0IHR3aXRjaENsaXBNYXRjaCA9IG9yaWdpbmFsVXJsLm1hdGNoKHR3aXRjaENsaXBSZWdleClcbiAgICBpZiAodHdpdGNoQ2xpcE1hdGNoKSB7XG4gICAgICByZXR1cm4gYGh0dHBzOi8vY2xpcHMudHdpdGNoLnR2L2VtYmVkP2NsaXA9JHt0d2l0Y2hDbGlwTWF0Y2hbMV19JnBhcmVudD0ke3R5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lIDogJ2xvY2FsaG9zdCd9YFxuICAgIH1cblxuICAgIC8vIERpcmVjdCB2aWRlbyBmaWxlc1xuICAgIGNvbnN0IHZpZGVvRXh0ZW5zaW9ucyA9IFsnLm1wNCcsICcubW92JywgJy5hdmknLCAnLm1rdicsICcud2VibScsICcuZmx2JywgJy53bXYnLCAnLm00diddXG4gICAgY29uc3QgdXJsUGF0aCA9IG5ldyBVUkwob3JpZ2luYWxVcmwpLnBhdGhuYW1lLnRvTG93ZXJDYXNlKClcbiAgICBpZiAodmlkZW9FeHRlbnNpb25zLnNvbWUoZXh0ID0+IHVybFBhdGguZW5kc1dpdGgoZXh0KSkpIHtcbiAgICAgIHJldHVybiBvcmlnaW5hbFVybCAvLyBSZXR1cm4gb3JpZ2luYWwgVVJMIGZvciBkaXJlY3QgdmlkZW8gZmlsZXNcbiAgICB9XG5cbiAgICAvLyBJZiBpdCdzIGFscmVhZHkgYW4gZW1iZWQgVVJMIG9yIHVuc3VwcG9ydGVkLCByZXR1cm4gYXMgaXNcbiAgICByZXR1cm4gb3JpZ2luYWxVcmxcbiAgfVxuXG4gIGFzeW5jIGFkZFRhZ1RvVmlkZW8odmlkZW9JZDogc3RyaW5nLCB0YWdJZDogc3RyaW5nKTogUHJvbWlzZTxBcGlSZXNwb25zZTx2b2lkPj4ge1xuICAgIHJldHVybiBhc3luY1dyYXBwZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ2hlY2sgaWYgdmlkZW8gZXhpc3RzXG4gICAgICBjb25zdCB2aWRlbyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5maW5kQnlJZCh2aWRlb0lkKVxuICAgICAgaWYgKCF2aWRlbykge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdWaWRlbycsIHZpZGVvSWQpXG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRhZyBleGlzdHNcbiAgICAgIGNvbnN0IHRhZyA9IGF3YWl0IHRhZ1JlcG9zaXRvcnkuZmluZEJ5SWQodGFnSWQpXG4gICAgICBpZiAoIXRhZykge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdUYWcnLCB0YWdJZClcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHRhZyB0byB2aWRlbyAocmVwb3NpdG9yeSBzaG91bGQgaGFuZGxlIGR1cGxpY2F0ZXMpXG4gICAgICBhd2FpdCB2aWRlb1JlcG9zaXRvcnkuYWRkVGFnVG9WaWRlbyh2aWRlb0lkLCB0YWdJZClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIH1cbiAgICB9KSgpXG4gIH1cblxuICBhc3luYyByZW1vdmVUYWdGcm9tVmlkZW8odmlkZW9JZDogc3RyaW5nLCB0YWdJZDogc3RyaW5nKTogUHJvbWlzZTxBcGlSZXNwb25zZTx2b2lkPj4ge1xuICAgIHJldHVybiBhc3luY1dyYXBwZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ2hlY2sgaWYgdmlkZW8gZXhpc3RzXG4gICAgICBjb25zdCB2aWRlbyA9IGF3YWl0IHZpZGVvUmVwb3NpdG9yeS5maW5kQnlJZCh2aWRlb0lkKVxuICAgICAgaWYgKCF2aWRlbykge1xuICAgICAgICB0aHJvdyBjcmVhdGVOb3RGb3VuZEVycm9yKCdWaWRlbycsIHZpZGVvSWQpXG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSB0YWcgZnJvbSB2aWRlb1xuICAgICAgYXdhaXQgdmlkZW9SZXBvc2l0b3J5LnJlbW92ZVRhZ0Zyb21WaWRlbyh2aWRlb0lkLCB0YWdJZClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIH1cbiAgICB9KSgpXG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RUYWdzRnJvbVZpZGVvKGRhdGE6IGFueSk6IHN0cmluZ1tdIHtcbiAgICBpZiAoZGF0YS50YWdzICYmIEFycmF5LmlzQXJyYXkoZGF0YS50YWdzKSkge1xuICAgICAgcmV0dXJuIGRhdGEudGFnc1xuICAgIH1cbiAgICBcbiAgICBpZiAodHlwZW9mIGRhdGEudGFncyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBkYXRhLnRhZ3Muc3BsaXQoJywnKS5tYXAoKHRhZzogc3RyaW5nKSA9PiB0YWcudHJpbSgpKS5maWx0ZXIoQm9vbGVhbilcbiAgICB9XG5cbiAgICByZXR1cm4gW11cbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgdmlkZW9TZXJ2aWNlID0gbmV3IFZpZGVvU2VydmljZUltcGwoKSJdLCJuYW1lcyI6WyJ2aWRlb1JlcG9zaXRvcnkiLCJyYXRpbmdSZXBvc2l0b3J5IiwidGFnUmVwb3NpdG9yeSIsInVzZXJSZXBvc2l0b3J5IiwidmlkZW9NZXRhZGF0YVNlcnZpY2UiLCJuc2Z3U2VydmljZSIsInJlZEdpZnNTZXJ2aWNlIiwicmVkZGl0U2VydmljZSIsInhIYW1zdGVyU2VydmljZSIsInZhbGlkYXRlU2NoZW1hIiwiY3JlYXRlVmlkZW9TY2hlbWEiLCJ1cGRhdGVWaWRlb1NjaGVtYSIsInZpZGVvRmlsdGVyU2NoZW1hIiwicmF0aW5nU2NoZW1hIiwic2FuaXRpemVUYWdzIiwiQXV0aG9yaXphdGlvbkVycm9yIiwiVmFsaWRhdGlvbkVycm9yIiwiY3JlYXRlTm90Rm91bmRFcnJvciIsImxvZ2dlciIsImxvZ1VzZXJBY3Rpb24iLCJhc3luY1dyYXBwZXIiLCJWQUxJREFUSU9OX1BBVFRFUk5TIiwiVmlkZW9TZXJ2aWNlSW1wbCIsImdldFZpZGVvcyIsImZpbHRlcnMiLCJ2YWxpZGF0ZWRGaWx0ZXJzIiwicmVzdWx0IiwiZmluZFdpdGhGaWx0ZXJzIiwic3VjY2VzcyIsImRhdGEiLCJ2aWRlb3MiLCJwYWdpbmF0aW9uIiwicGFnZSIsImxpbWl0IiwidG90YWwiLCJ0b3RhbFBhZ2VzIiwiZ2V0VmlkZW9CeUlkIiwiaWQiLCJ2aWRlbyIsImZpbmRXaXRoUmF0aW5ncyIsImNyZWF0ZVZpZGVvIiwidXNlcklkIiwidmFsaWRhdGVkRGF0YSIsInRpdGxlIiwib3JpZ2luYWxVcmwiLCJkZXNjcmlwdGlvbiIsInRhZ3MiLCJ1c2VyIiwiZmluZEJ5SWQiLCJleHRyYWN0ZWRNZXRhZGF0YSIsImVtYmVkVXJsIiwiZmluYWxUaHVtYm5haWwiLCJwcmV2aWV3VXJsIiwidGh1bWJuYWlsIiwidW5kZWZpbmVkIiwiaXNSZWRHaWZzVXJsIiwicmVkR2lmc0RhdGEiLCJwcm9jZXNzUmVkR2lmc1VybCIsIm1ldGFkYXRhIiwiaW5mbyIsInVybCIsInRhZ3NFeHRyYWN0ZWQiLCJsZW5ndGgiLCJoYXNUYWdSYXRpbmdzIiwidGFnUmF0aW5ncyIsInRhZ1JhdGluZ3NDb3VudCIsImVycm9yIiwiZXh0cmFjdE1ldGFkYXRhIiwiY29udmVydFRvRW1iZWRVcmwiLCJpc1JlZGRpdFVybCIsInJlZGRpdERhdGEiLCJwcm9jZXNzUmVkZGl0VXJsIiwiaXNYSGFtc3RlclVybCIsInhIYW1zdGVyRGF0YSIsInByb2Nlc3NYSGFtc3RlclVybCIsImZpbmFsVGl0bGUiLCJ0cmltIiwiaW5jbHVkZXMiLCJtYXRjaCIsImdpZklkIiwiZmluYWxEZXNjcmlwdGlvbiIsInByb3ZpZGVkVGFncyIsImV4dHJhY3RUYWdzRnJvbVZpZGVvIiwiZXh0cmFjdGVkVGFncyIsIkFycmF5IiwiaXNBcnJheSIsInJhdGVkVGFncyIsIm1hcCIsInRyIiwibmFtZSIsImNvbWJpbmVkVGFncyIsImZyb20iLCJTZXQiLCJzYW5pdGl6ZWRUYWdzIiwiZmluYWxUYWdzIiwiaXNOU0ZXIiwiaXNOc2Z3IiwiaXNSZWRHaWZzIiwiaXNSZWRkaXQiLCJpc1hIYW1zdGVyIiwiZGV0ZWN0TlNGVyIsImNyZWF0ZVdpdGhUYWdzIiwidmlkZW9JZCIsInRhZ3NDb3VudCIsInJhdGluZ3NDcmVhdGVkIiwidG90YWxUYWdSYXRpbmdzIiwidGFnUmF0aW5nIiwicmF0aW5nIiwic2FuaXRpemVkVGFnTmFtZSIsInRhZyIsImZpbmRPckNyZWF0ZSIsInZpZGVvSGFzVGFnIiwidXBzZXJ0UmF0aW5nIiwid2FybiIsIm9yaWdpbmFsVGFnTmFtZSIsInRvdGFsUHJvY2Vzc2VkIiwicmF0aW5nRXJyb3IiLCJjcmVhdGVFcnJvciIsInZpZGVvRGF0YSIsImF1dG9FeHRyYWN0ZWQiLCJ2aWRlb1dpdGhSYXRpbmdzIiwidXBkYXRlVmlkZW8iLCJleGlzdGluZ1ZpZGVvIiwidXBkYXRlRGF0YSIsInVwZGF0ZWRWaWRlbyIsInVwZGF0ZSIsImRlbGV0ZVZpZGVvIiwiaXNPd25lciIsImlzQWRtaW4iLCJkZWxldGUiLCJpc0FkbWluRGVsZXRlIiwicmF0ZVZpZGVvIiwidGFnSWQiLCJsZXZlbCIsImdldFZpZGVvc0J5VXNlciIsImZpbmRCeVVzZXJJZCIsInNlYXJjaFZpZGVvcyIsInF1ZXJ5Iiwic2VhcmNoIiwiZ2V0VmlkZW9zQnlUYWdzIiwiZmluZEJ5VGFncyIsImdldFRyZW5kaW5nVmlkZW9zIiwiZ2V0VmlkZW9TdGF0cyIsInN0YXRzIiwieW91dHViZU1hdGNoIiwiWU9VVFVCRV9VUkwiLCJ2aW1lb01hdGNoIiwiVklNRU9fVVJMIiwicmVkZ2lmc1JlZ2V4IiwicmVkZ2lmc01hdGNoIiwidGlrdG9rUmVnZXgiLCJ0aWt0b2tNYXRjaCIsImluc3RhZ3JhbVJlZ2V4IiwiaW5zdGFncmFtTWF0Y2giLCJ0d2l0dGVyUmVnZXgiLCJ0d2l0dGVyTWF0Y2giLCJkYWlseW1vdGlvblJlZ2V4IiwiZGFpbHltb3Rpb25NYXRjaCIsInJlZGRpdFJlZ2V4IiwicmVkZGl0TWF0Y2giLCJ0d2l0Y2hWaWRlb1JlZ2V4IiwidHdpdGNoVmlkZW9NYXRjaCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJ0d2l0Y2hDbGlwUmVnZXgiLCJ0d2l0Y2hDbGlwTWF0Y2giLCJ2aWRlb0V4dGVuc2lvbnMiLCJ1cmxQYXRoIiwiVVJMIiwicGF0aG5hbWUiLCJ0b0xvd2VyQ2FzZSIsInNvbWUiLCJleHQiLCJlbmRzV2l0aCIsImFkZFRhZ1RvVmlkZW8iLCJyZW1vdmVUYWdGcm9tVmlkZW8iLCJzcGxpdCIsImZpbHRlciIsIkJvb2xlYW4iLCJ2aWRlb1NlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/services/video.service.ts\n");

/***/ }),

/***/ "(api)/./src/services/xhamster.service.ts":
/*!******************************************!*\
  !*** ./src/services/xhamster.service.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   XHamsterServiceImpl: () => (/* binding */ XHamsterServiceImpl),\n/* harmony export */   xHamsterService: () => (/* binding */ xHamsterService)\n/* harmony export */ });\n/* harmony import */ var _src_lib_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/src/lib/logger */ \"(api)/./src/lib/logger.ts\");\n\nclass XHamsterServiceImpl {\n    isXHamsterUrl(url) {\n        return url.includes(\"xhamster.com\");\n    }\n    isValidContentTag(tag) {\n        if (!tag || tag.length < 2 || tag.length > 30) return false;\n        // Technical/platform terms to exclude\n        const blacklist = [\n            // Site/platform names\n            \"xhamster\",\n            \"pornhub\",\n            \"redtube\",\n            \"tube\",\n            \"xvideos\",\n            \"youjizz\",\n            \"spankbang\",\n            \"chaturbate\",\n            \"cam4\",\n            \"bongacams\",\n            \"stripchat\",\n            \"livejasmin\",\n            \"flirt4free\",\n            \"camsoda\",\n            \"onlyfans\",\n            \"manyvids\",\n            \"clips4sale\",\n            \"iwantclips\",\n            \"niteflirt\",\n            // Technical metadata\n            \"video\",\n            \"watch\",\n            \"page\",\n            \"link\",\n            \"site\",\n            \"url\",\n            \"slug\",\n            \"uid\",\n            \"id\",\n            \"name\",\n            \"tags\",\n            \"isbrand\",\n            \"ischannel\",\n            \"isverified\",\n            \"nameen\",\n            \"channel\",\n            \"channels\",\n            \"model\",\n            \"models\",\n            \"category\",\n            \"categories\",\n            \"premium\",\n            \"vip\",\n            \"verified\",\n            \"official\",\n            // Quality/format terms\n            \"hd\",\n            \"4k\",\n            \"720p\",\n            \"1080p\",\n            \"uhd\",\n            \"fhd\",\n            \"mp4\",\n            \"avi\",\n            \"wmv\",\n            \"flv\",\n            \"mov\",\n            \"webm\",\n            \"duration\",\n            \"length\",\n            \"size\",\n            \"quality\",\n            \"format\",\n            \"resolution\",\n            // Social/interaction terms\n            \"views\",\n            \"likes\",\n            \"dislikes\",\n            \"comments\",\n            \"share\",\n            \"subscribe\",\n            \"follow\",\n            \"favorite\",\n            \"bookmark\",\n            \"playlist\",\n            \"collection\",\n            \"gallery\",\n            // Technical UI/web terms\n            \"embed\",\n            \"iframe\",\n            \"player\",\n            \"thumb\",\n            \"thumbnail\",\n            \"preview\",\n            \"poster\",\n            \"image\",\n            \"img\",\n            \"pic\",\n            \"photo\",\n            \"jpg\",\n            \"jpeg\",\n            \"png\",\n            \"gif\",\n            \"webp\",\n            \"svg\",\n            \"icon\",\n            \"logo\",\n            \"banner\",\n            \"button\",\n            \"click\",\n            \"href\",\n            \"redirect\",\n            // Advertising/tracking\n            \"ad\",\n            \"ads\",\n            \"advertisement\",\n            \"promo\",\n            \"promotion\",\n            \"sponsored\",\n            \"affiliate\",\n            \"referrer\",\n            \"utm\",\n            \"tracking\",\n            \"analytics\",\n            \"pixel\",\n            // Admin/system terms\n            \"admin\",\n            \"administrator\",\n            \"moderator\",\n            \"mod\",\n            \"user\",\n            \"guest\",\n            \"member\",\n            \"subscriber\",\n            \"account\",\n            \"profile\",\n            \"settings\",\n            \"preferences\",\n            \"dashboard\",\n            \"panel\",\n            \"control\",\n            \"manage\",\n            \"edit\",\n            \"delete\",\n            \"create\",\n            \"update\",\n            // General web/tech terms\n            \"website\",\n            \"homepage\",\n            \"contact\",\n            \"about\",\n            \"help\",\n            \"faq\",\n            \"terms\",\n            \"privacy\",\n            \"policy\",\n            \"legal\",\n            \"dmca\",\n            \"copyright\",\n            \"trademark\",\n            \"disclaimer\",\n            \"search\",\n            \"filter\",\n            \"sort\",\n            \"browse\",\n            \"explore\",\n            \"discover\",\n            \"trending\",\n            \"popular\",\n            \"featured\",\n            \"recommended\",\n            \"related\",\n            \"similar\",\n            \"more\",\n            \"all\",\n            \"new\",\n            \"latest\",\n            \"recent\",\n            \"today\",\n            \"week\",\n            \"month\",\n            \"year\",\n            \"date\",\n            \"time\",\n            // Meaningless terms\n            \"content\",\n            \"stuff\",\n            \"things\",\n            \"item\",\n            \"object\",\n            \"element\",\n            \"component\",\n            \"section\",\n            \"part\",\n            \"piece\",\n            \"bit\",\n            \"data\",\n            \"info\",\n            \"information\",\n            \"details\",\n            \"description\",\n            \"title\",\n            \"text\",\n            \"caption\",\n            \"label\"\n        ];\n        const lowerTag = tag.toLowerCase();\n        // Check against blacklist\n        if (blacklist.includes(lowerTag)) return false;\n        // Skip if contains URLs or technical patterns\n        if (lowerTag.includes(\"http\") || lowerTag.includes(\"www\") || lowerTag.includes(\".com\")) return false;\n        // Skip pure numbers\n        if (/^\\d+$/.test(lowerTag)) return false;\n        // Skip hex strings (likely IDs)\n        if (/^[a-f0-9]{8,}$/i.test(lowerTag)) return false;\n        // Skip technical values\n        if (/^(true|false|null|undefined|nan|infinity)$/i.test(lowerTag)) return false;\n        return true;\n    }\n    normalizeTag(tag) {\n        if (!tag) return \"\";\n        // Convert to lowercase and trim\n        let normalized = tag.toLowerCase().trim();\n        // Remove special characters except hyphens\n        normalized = normalized.replace(/[^\\w\\s-]/g, \"\");\n        // Replace spaces and underscores with hyphens\n        normalized = normalized.replace(/[\\s_]+/g, \"-\");\n        // Remove multiple consecutive hyphens\n        normalized = normalized.replace(/-+/g, \"-\");\n        // Remove leading/trailing hyphens\n        normalized = normalized.replace(/^-+|-+$/g, \"\");\n        // Tag mappings for common variations including French translations\n        const tagMappings = {\n            // English variations\n            \"big-boobs\": \"big-tits\",\n            \"big-breasts\": \"big-tits\",\n            \"small-boobs\": \"small-tits\",\n            \"small-breasts\": \"small-tits\",\n            \"big-butt\": \"big-ass\",\n            \"bubble-butt\": \"big-ass\",\n            \"small-butt\": \"small-ass\",\n            \"black\": \"ebony\",\n            \"african\": \"ebony\",\n            \"bj\": \"blowjob\",\n            \"blow-job\": \"blowjob\",\n            \"hj\": \"handjob\",\n            \"hand-job\": \"handjob\",\n            \"fj\": \"footjob\",\n            \"foot-job\": \"footjob\",\n            \"pov\": \"pov\",\n            \"point-of-view\": \"pov\",\n            \"girl-on-girl\": \"lesbian\",\n            \"girl-girl\": \"lesbian\",\n            \"gg\": \"lesbian\",\n            \"boy-boy\": \"gay\",\n            \"mm\": \"gay\",\n            \"girl-boy\": \"straight\",\n            \"gf\": \"girlfriend\",\n            \"bf\": \"boyfriend\",\n            \"hubby\": \"husband\",\n            \"wifey\": \"wife\",\n            \"teen18\": \"teen\",\n            \"teen-18\": \"teen\",\n            \"eighteen\": \"teen\",\n            \"18yo\": \"teen\",\n            \"18-year-old\": \"teen\",\n            \"18-ans\": \"teen\",\n            \"milfs\": \"milf\",\n            \"moms\": \"milf\",\n            \"mothers\": \"milf\",\n            \"cougars\": \"milf\",\n            \"grannies\": \"granny\",\n            \"grandmas\": \"granny\",\n            \"gilf\": \"granny\",\n            // French to English mappings\n            \"bombasse\": \"babe\",\n            \"jeune\": \"teen\",\n            \"pipe\": \"blowjob\",\n            \"blonde\": \"blonde\",\n            \"petits-seins\": \"small-tits\",\n            \"grosse-bite\": \"big-cock\",\n            \"big-cock\": \"big-cock\",\n            \"massive-cock\": \"big-cock\",\n            \"enormous\": \"big-cock\",\n            \"irrumation\": \"face-fuck\",\n            \"face-fuck\": \"deepthroat\",\n            \"sexe-brutal\": \"rough-sex\",\n            \"rough-sex\": \"rough-sex\",\n            \"videos-hd\": \"hd\",\n            \"vid\\xe9os-hd\": \"hd\",\n            \"amateur\": \"amateur\",\n            \"excitee\": \"horny\",\n            \"excit\\xe9e\": \"horny\",\n            \"horny\": \"horny\",\n            \"adolescents\": \"teen\",\n            \"doigtage-de-chatte\": \"fingering\",\n            \"fingering-pussy\": \"fingering\",\n            \"doigtee\": \"fingered\",\n            \"fingered\": \"fingering\",\n            \"beautes\": \"babe\",\n            \"beaut\\xe9s\": \"babe\",\n            \"gemissements-bruyants\": \"moaning\",\n            \"loud-moaning\": \"moaning\",\n            \"petite-chatte\": \"small-pussy\",\n            \"little-pussy\": \"small-pussy\",\n            \"jouet\": \"toys\",\n            \"toy\": \"toys\",\n            \"seins-naturels\": \"natural-tits\",\n            \"natural-boobs\": \"natural-tits\",\n            \"natural-tits\": \"natural-tits\",\n            \"utilise-moi\": \"freeuse\",\n            \"use-me\": \"freeuse\",\n            \"utilisation-gratuite\": \"freeuse\",\n            \"ascenseur\": \"elevator\",\n            \"bande-annonce\": \"trailer\",\n            \"etourdissant\": \"stunning\",\n            \"stunner\": \"stunning\",\n            \"arracher\": \"rough\",\n            \"snatch\": \"rough\",\n            \"banging\": \"hardcore\",\n            \"beginner\": \"amateur\",\n            \"titties\": \"tits\",\n            \"my-little\": \"petite\",\n            \"trap\": \"stuck\",\n            \"tights\": \"pantyhose\",\n            \"fingers\": \"fingering\",\n            \"pounds\": \"pounding\",\n            \"sex\": \"hardcore\"\n        };\n        // Apply mappings\n        if (tagMappings[normalized]) {\n            normalized = tagMappings[normalized];\n        }\n        return normalized;\n    }\n    async processXHamsterUrl(originalUrl) {\n        try {\n            _src_lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Processing XHamster URL for metadata extraction\", {\n                url: originalUrl\n            });\n            // Fetch the HTML page\n            const response = await fetch(originalUrl, {\n                headers: {\n                    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\"\n                }\n            });\n            if (!response.ok) {\n                throw new Error(`Failed to fetch XHamster page: ${response.status}`);\n            }\n            const html = await response.text();\n            // Extract metadata from various sources\n            const metadata = {};\n            // Extract title from meta tags or page title\n            const titleMatch = html.match(/<title[^>]*>([^<]+)<\\/title>/i) || html.match(/<meta[^>]*property=\"og:title\"[^>]*content=\"([^\"]*)\"[^>]*>/i) || html.match(/<meta[^>]*name=\"title\"[^>]*content=\"([^\"]*)\"[^>]*>/i);\n            if (titleMatch) {\n                metadata.title = titleMatch[1].trim();\n            }\n            // Extract description\n            const descMatch = html.match(/<meta[^>]*property=\"og:description\"[^>]*content=\"([^\"]*)\"[^>]*>/i) || html.match(/<meta[^>]*name=\"description\"[^>]*content=\"([^\"]*)\"[^>]*>/i);\n            if (descMatch) {\n                metadata.description = descMatch[1].trim();\n            }\n            // Extract thumbnail from og:image\n            const thumbMatch = html.match(/<meta[^>]*property=\"og:image\"[^>]*content=\"([^\"]*)\"[^>]*>/i);\n            if (thumbMatch) {\n                metadata.thumbnail = thumbMatch[1] // Use the captured group from og:image\n                ;\n            } else {\n                // Fallback: search for direct image URLs\n                const directImageMatch = html.match(/https:\\/\\/ic-vt-[^\"]*\\.xhpingcdn\\.com\\/[^\"]*\\.jpg/g) || html.match(/https:\\/\\/thumb-[^\"]*\\.xhpingcdn\\.com\\/[^\"]*\\.jpg/g);\n                if (directImageMatch) {\n                    metadata.thumbnail = Array.isArray(directImageMatch) ? directImageMatch[0] : directImageMatch;\n                }\n            }\n            // Extract preview URL from initials-script\n            const scriptPatterns = [\n                /<script id=\"initials-script\"[^>]*>([\\s\\S]*?)<\\/script>/i,\n                /<script[^>]*id=\"initials-script\"[^>]*>([\\s\\S]*?)<\\/script>/i,\n                /<script[^>]*initials[^>]*>([\\s\\S]*?)<\\/script>/i\n            ];\n            let scriptContent = null;\n            for (const pattern of scriptPatterns){\n                const match = html.match(pattern);\n                if (match) {\n                    scriptContent = match[1];\n                    break;\n                }\n            }\n            if (scriptContent) {\n                // Look for trailerURL in the script (more flexible regex)\n                const patterns = [\n                    /\"trailerURL\"\\s*:\\s*\"([^\"]*thumb-v[^\"]*\\.xhpingcdn\\.com[^\"]*\\.t\\.mp4[^\"]*)\"/gi,\n                    /\"trailerURL\"\\s*:\\s*\"([^\"]*thumb-v[^\"]*\\.xhpingcdn\\.com[^\"]*\\.mp4[^\"]*)\"/gi,\n                    /\"trailerURL\"\\s*:\\s*\"([^\"]*\\.mp4[^\"]*)\"/gi\n                ];\n                for (const pattern of patterns){\n                    const matches = scriptContent.match(pattern);\n                    if (matches && matches.length > 0) {\n                        // Get the first match and extract URL from capture group\n                        const firstMatch = matches[0].match(/\"trailerURL\"\\s*:\\s*\"([^\"]*)\"/i);\n                        if (firstMatch) {\n                            metadata.previewUrl = firstMatch[1].replace(/\\\\\\//g, \"/\");\n                            break;\n                        }\n                    }\n                }\n            } else {\n                // Fallback: search the entire HTML for trailerURL\n                const patterns = [\n                    /\"trailerURL\"\\s*:\\s*\"([^\"]*thumb-v[^\"]*\\.xhpingcdn\\.com[^\"]*\\.t\\.mp4[^\"]*)\"/gi,\n                    /\"trailerURL\"\\s*:\\s*\"([^\"]*thumb-v[^\"]*\\.xhpingcdn\\.com[^\"]*\\.mp4[^\"]*)\"/gi,\n                    /\"trailerURL\"\\s*:\\s*\"([^\"]*\\.mp4[^\"]*)\"/gi\n                ];\n                for (const pattern of patterns){\n                    const matches = html.match(pattern);\n                    if (matches && matches.length > 0) {\n                        const firstMatch = matches[0].match(/\"trailerURL\"\\s*:\\s*\"([^\"]*)\"/i);\n                        if (firstMatch) {\n                            metadata.previewUrl = firstMatch[1].replace(/\\\\\\//g, \"/\");\n                            break;\n                        }\n                    }\n                }\n            }\n            // Enhanced tags extraction from multiple sources\n            const tags = new Set();\n            // 1. Extract from keywords meta tag\n            const keywordsMatch = html.match(/<meta[^>]*name=\"keywords\"[^>]*content=\"([^\"]*)\"[^>]*>/i);\n            if (keywordsMatch) {\n                keywordsMatch[1].split(\",\").forEach((tag)=>{\n                    const cleanTag = tag.trim().toLowerCase();\n                    if (cleanTag && cleanTag.length > 2) {\n                        tags.add(cleanTag);\n                    }\n                });\n            }\n            // 2. Extract from visible category and tag links in HTML (more reliable approach)\n            // Extract category links like: href=\"https://fra.xhamster.com/categories/teen\"\n            const categoryLinksRegex = /href=\"[^\"]*\\/categories\\/([^\"]+)\"[^>]*>\\s*<[^>]*>\\s*([^<]+)</g;\n            let categoryMatch;\n            while((categoryMatch = categoryLinksRegex.exec(html)) !== null){\n                const categorySlug = categoryMatch[1]?.trim();\n                const categoryText = categoryMatch[2]?.trim();\n                if (categorySlug && this.isValidContentTag(categorySlug)) {\n                    tags.add(categorySlug.toLowerCase());\n                }\n                if (categoryText && categoryText !== categorySlug && this.isValidContentTag(categoryText)) {\n                    const normalized = this.normalizeTag(categoryText);\n                    if (normalized) tags.add(normalized);\n                }\n            }\n            // Extract tag links like: href=\"https://fra.xhamster.com/tags/freeuse\"\n            const tagLinksRegex = /href=\"[^\"]*\\/tags\\/([^\"]+)\"[^>]*>\\s*<[^>]*>\\s*([^<]+)</g;\n            let tagMatch;\n            while((tagMatch = tagLinksRegex.exec(html)) !== null){\n                const tagSlug = tagMatch[1]?.trim();\n                const tagText = tagMatch[2]?.trim();\n                if (tagSlug && this.isValidContentTag(tagSlug)) {\n                    tags.add(tagSlug.toLowerCase());\n                }\n                if (tagText && tagText !== tagSlug && this.isValidContentTag(tagText)) {\n                    const normalized = this.normalizeTag(tagText);\n                    if (normalized) tags.add(normalized);\n                }\n            }\n            // 3. Extract channel/pornstar names from links\n            const pornstarLinksRegex = /href=\"[^\"]*\\/pornstars\\/([^\"]+)\"[^>]*>[\\s\\S]*?alt=\"([^\"]*)\"[^>]*>/g;\n            let pornstarMatch;\n            while((pornstarMatch = pornstarLinksRegex.exec(html)) !== null){\n                const pornstarName = pornstarMatch[2]?.trim();\n                if (pornstarName && this.isValidContentTag(pornstarName)) {\n                    const normalized = this.normalizeTag(pornstarName);\n                    if (normalized && normalized !== \"image\" && normalized !== \"avatar\") {\n                        tags.add(normalized);\n                    }\n                }\n            }\n            // 4. Extract from JSON data (more targeted approach)\n            if (scriptContent) {\n                try {\n                    // Look for specific tag arrays that contain actual content tags\n                    const tagArrayPattern = /\"tags\"\\s*:\\s*\\[([^\\]]*\"[^\"]*\"[^\\]]*)\\]/g;\n                    const tagArrayMatches = scriptContent.match(tagArrayPattern);\n                    if (tagArrayMatches) {\n                        tagArrayMatches.forEach((match)=>{\n                            const tagStringArray = match.match(/\"([^\"]{2,30})\"/g);\n                            if (tagStringArray) {\n                                tagStringArray.forEach((tagStr)=>{\n                                    const tag = tagStr.replace(/\"/g, \"\").trim();\n                                    if (this.isValidContentTag(tag)) {\n                                        const normalized = this.normalizeTag(tag);\n                                        if (normalized) tags.add(normalized);\n                                    }\n                                });\n                            }\n                        });\n                    }\n                    // Look for category objects with names\n                    const categoryPattern = /\"categories\"\\s*:\\s*\\[[^\\]]*\"name\"\\s*:\\s*\"([^\"]+)\"[^\\]]*\\]/g;\n                    const categoryMatches = scriptContent.match(categoryPattern);\n                    if (categoryMatches) {\n                        categoryMatches.forEach((match)=>{\n                            const nameMatch = match.match(/\"name\"\\s*:\\s*\"([^\"]+)\"/g);\n                            if (nameMatch) {\n                                nameMatch.forEach((name)=>{\n                                    const categoryName = name.match(/\"name\"\\s*:\\s*\"([^\"]+)\"/)?.[1];\n                                    if (categoryName && this.isValidContentTag(categoryName)) {\n                                        const normalized = this.normalizeTag(categoryName);\n                                        if (normalized) tags.add(normalized);\n                                    }\n                                });\n                            }\n                        });\n                    }\n                } catch (error) {\n                    _src_lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn(\"Error parsing JSON content for tags\", {\n                        error\n                    });\n                }\n            }\n            // 5. Extract from video-specific metadata patterns and other HTML elements\n            const videoTagsPattern = /<span[^>]*class=\"[^\"]*tag[^\"]*\"[^>]*>([^<]+)<\\/span>/gi;\n            let videoTagMatch;\n            while((videoTagMatch = videoTagsPattern.exec(html)) !== null){\n                const tagName = videoTagMatch[1].trim();\n                if (tagName && this.isValidContentTag(tagName)) {\n                    const normalized = this.normalizeTag(tagName);\n                    if (normalized) tags.add(normalized);\n                }\n            }\n            // 6. Extract quality indicators and content type from title/description\n            const titleLower = (metadata.title || \"\").toLowerCase();\n            const descLower = (metadata.description || \"\").toLowerCase();\n            const combinedText = `${titleLower} ${descLower}`;\n            // Quality tags\n            if (combinedText.includes(\"4k\") || combinedText.includes(\"ultra hd\")) tags.add(\"4k\");\n            if (combinedText.includes(\"hd\") && !tags.has(\"4k\")) tags.add(\"hd\");\n            if (combinedText.includes(\"60fps\")) tags.add(\"60fps\");\n            if (combinedText.includes(\"vr\")) tags.add(\"vr\");\n            // Content type tags\n            if (combinedText.includes(\"amateur\")) tags.add(\"amateur\");\n            if (combinedText.includes(\"professional\")) tags.add(\"professional\");\n            if (combinedText.includes(\"webcam\")) tags.add(\"webcam\");\n            if (combinedText.includes(\"homemade\")) tags.add(\"homemade\");\n            // Activity tags (common ones)\n            const activityTags = [\n                \"solo\",\n                \"couple\",\n                \"threesome\",\n                \"group\",\n                \"lesbian\",\n                \"gay\",\n                \"straight\",\n                \"anal\",\n                \"oral\",\n                \"masturbation\",\n                \"blowjob\",\n                \"handjob\",\n                \"footjob\",\n                \"massage\",\n                \"stripteasing\",\n                \"dancing\",\n                \"shower\",\n                \"bath\",\n                \"outdoor\",\n                \"public\",\n                \"car\",\n                \"office\",\n                \"bedroom\",\n                \"kitchen\",\n                \"bathroom\"\n            ];\n            activityTags.forEach((activityTag)=>{\n                if (combinedText.includes(activityTag)) {\n                    tags.add(activityTag);\n                }\n            });\n            // Demographic tags\n            const demographicTags = [\n                \"teen\",\n                \"milf\",\n                \"mature\",\n                \"granny\",\n                \"young\",\n                \"old\",\n                \"blonde\",\n                \"brunette\",\n                \"redhead\",\n                \"black hair\",\n                \"asian\",\n                \"latina\",\n                \"ebony\",\n                \"white\",\n                \"bbw\",\n                \"thin\",\n                \"curvy\",\n                \"big tits\",\n                \"small tits\",\n                \"big ass\",\n                \"small ass\",\n                \"tattoo\",\n                \"piercing\",\n                \"hairy\",\n                \"shaved\"\n            ];\n            demographicTags.forEach((demoTag)=>{\n                if (combinedText.includes(demoTag)) {\n                    tags.add(demoTag.replace(\" \", \"-\"));\n                }\n            });\n            // Convert Set to Array and apply tag normalization\n            let finalTags = Array.from(tags);\n            // Normalize and clean up tags\n            finalTags = finalTags.map((tag)=>this.normalizeTag(tag)).filter((tag)=>tag && tag.length >= 2 && tag.length <= 30).filter((tag, index, array)=>array.indexOf(tag) === index) // Remove duplicates\n            ;\n            // Removed tag limit - allow all relevant tags\n            metadata.tags = finalTags.length > 0 ? finalTags : undefined;\n            _src_lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"XHamster metadata extracted\", {\n                url: originalUrl,\n                hasTitle: !!metadata.title,\n                hasDescription: !!metadata.description,\n                hasThumbnail: !!metadata.thumbnail,\n                hasPreviewUrl: !!metadata.previewUrl,\n                tagsCount: metadata.tags?.length || 0\n            });\n            return metadata;\n        } catch (error) {\n            _src_lib_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Failed to process XHamster URL\", {\n                url: originalUrl,\n                error: error instanceof Error ? error.message : error\n            });\n            throw error;\n        }\n    }\n}\nconst xHamsterService = new XHamsterServiceImpl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmljZXMveGhhbXN0ZXIuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBeUM7QUFVbEMsTUFBTUM7SUFDWEMsY0FBY0MsR0FBVyxFQUFXO1FBQ2xDLE9BQU9BLElBQUlDLFFBQVEsQ0FBQztJQUN0QjtJQUVRQyxrQkFBa0JDLEdBQVcsRUFBVztRQUM5QyxJQUFJLENBQUNBLE9BQU9BLElBQUlDLE1BQU0sR0FBRyxLQUFLRCxJQUFJQyxNQUFNLEdBQUcsSUFBSSxPQUFPO1FBRXRELHNDQUFzQztRQUN0QyxNQUFNQyxZQUFZO1lBQ2hCLHNCQUFzQjtZQUN0QjtZQUFZO1lBQVc7WUFBVztZQUFRO1lBQVc7WUFBVztZQUNoRTtZQUFjO1lBQVE7WUFBYTtZQUFhO1lBQWM7WUFBYztZQUM1RTtZQUFZO1lBQVk7WUFBYztZQUFjO1lBRXBELHFCQUFxQjtZQUNyQjtZQUFTO1lBQVM7WUFBUTtZQUFRO1lBQVE7WUFBTztZQUFRO1lBQU87WUFBTTtZQUFRO1lBQzlFO1lBQVc7WUFBYTtZQUFjO1lBQVU7WUFBVztZQUFZO1lBQVM7WUFDaEY7WUFBWTtZQUFjO1lBQVc7WUFBTztZQUFZO1lBRXhELHVCQUF1QjtZQUN2QjtZQUFNO1lBQU07WUFBUTtZQUFTO1lBQU87WUFBTztZQUFPO1lBQU87WUFBTztZQUFPO1lBQU87WUFDOUU7WUFBWTtZQUFVO1lBQVE7WUFBVztZQUFVO1lBRW5ELDJCQUEyQjtZQUMzQjtZQUFTO1lBQVM7WUFBWTtZQUFZO1lBQVM7WUFBYTtZQUFVO1lBQzFFO1lBQVk7WUFBWTtZQUFjO1lBRXRDLHlCQUF5QjtZQUN6QjtZQUFTO1lBQVU7WUFBVTtZQUFTO1lBQWE7WUFBVztZQUM5RDtZQUFTO1lBQU87WUFBTztZQUFTO1lBQU87WUFBUTtZQUFPO1lBQU87WUFBUTtZQUNyRTtZQUFRO1lBQVE7WUFBVTtZQUFVO1lBQVM7WUFBUTtZQUVyRCx1QkFBdUI7WUFDdkI7WUFBTTtZQUFPO1lBQWlCO1lBQVM7WUFBYTtZQUFhO1lB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b3VyY2VzIjpbIndlYnBhY2s6Ly9yYXRlbXktbmV4dGpzLy4vc3JjL3NlcnZpY2VzL3hoYW1zdGVyLnNlcnZpY2UudHM/ZDVmNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3NyYy9saWIvbG9nZ2VyJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFhIYW1zdGVyTWV0YWRhdGEge1xuICB0aXRsZT86IHN0cmluZ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICB0aHVtYm5haWw/OiBzdHJpbmdcbiAgcHJldmlld1VybD86IHN0cmluZ1xuICB0YWdzPzogc3RyaW5nW11cbn1cblxuZXhwb3J0IGNsYXNzIFhIYW1zdGVyU2VydmljZUltcGwge1xuICBpc1hIYW1zdGVyVXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHVybC5pbmNsdWRlcygneGhhbXN0ZXIuY29tJylcbiAgfVxuXG4gIHByaXZhdGUgaXNWYWxpZENvbnRlbnRUYWcodGFnOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIXRhZyB8fCB0YWcubGVuZ3RoIDwgMiB8fCB0YWcubGVuZ3RoID4gMzApIHJldHVybiBmYWxzZVxuICAgIFxuICAgIC8vIFRlY2huaWNhbC9wbGF0Zm9ybSB0ZXJtcyB0byBleGNsdWRlXG4gICAgY29uc3QgYmxhY2tsaXN0ID0gW1xuICAgICAgLy8gU2l0ZS9wbGF0Zm9ybSBuYW1lc1xuICAgICAgJ3hoYW1zdGVyJywgJ3Bvcm5odWInLCAncmVkdHViZScsICd0dWJlJywgJ3h2aWRlb3MnLCAneW91aml6eicsICdzcGFua2JhbmcnLFxuICAgICAgJ2NoYXR1cmJhdGUnLCAnY2FtNCcsICdib25nYWNhbXMnLCAnc3RyaXBjaGF0JywgJ2xpdmVqYXNtaW4nLCAnZmxpcnQ0ZnJlZScsICdjYW1zb2RhJyxcbiAgICAgICdvbmx5ZmFucycsICdtYW55dmlkcycsICdjbGlwczRzYWxlJywgJ2l3YW50Y2xpcHMnLCAnbml0ZWZsaXJ0JyxcbiAgICAgIFxuICAgICAgLy8gVGVjaG5pY2FsIG1ldGFkYXRhXG4gICAgICAndmlkZW8nLCAnd2F0Y2gnLCAncGFnZScsICdsaW5rJywgJ3NpdGUnLCAndXJsJywgJ3NsdWcnLCAndWlkJywgJ2lkJywgJ25hbWUnLCAndGFncycsXG4gICAgICAnaXNicmFuZCcsICdpc2NoYW5uZWwnLCAnaXN2ZXJpZmllZCcsICduYW1lZW4nLCAnY2hhbm5lbCcsICdjaGFubmVscycsICdtb2RlbCcsICdtb2RlbHMnLFxuICAgICAgJ2NhdGVnb3J5JywgJ2NhdGVnb3JpZXMnLCAncHJlbWl1bScsICd2aXAnLCAndmVyaWZpZWQnLCAnb2ZmaWNpYWwnLFxuICAgICAgXG4gICAgICAvLyBRdWFsaXR5L2Zvcm1hdCB0ZXJtc1xuICAgICAgJ2hkJywgJzRrJywgJzcyMHAnLCAnMTA4MHAnLCAndWhkJywgJ2ZoZCcsICdtcDQnLCAnYXZpJywgJ3dtdicsICdmbHYnLCAnbW92JywgJ3dlYm0nLFxuICAgICAgJ2R1cmF0aW9uJywgJ2xlbmd0aCcsICdzaXplJywgJ3F1YWxpdHknLCAnZm9ybWF0JywgJ3Jlc29sdXRpb24nLFxuICAgICAgXG4gICAgICAvLyBTb2NpYWwvaW50ZXJhY3Rpb24gdGVybXNcbiAgICAgICd2aWV3cycsICdsaWtlcycsICdkaXNsaWtlcycsICdjb21tZW50cycsICdzaGFyZScsICdzdWJzY3JpYmUnLCAnZm9sbG93JywgJ2Zhdm9yaXRlJyxcbiAgICAgICdib29rbWFyaycsICdwbGF5bGlzdCcsICdjb2xsZWN0aW9uJywgJ2dhbGxlcnknLFxuICAgICAgXG4gICAgICAvLyBUZWNobmljYWwgVUkvd2ViIHRlcm1zXG4gICAgICAnZW1iZWQnLCAnaWZyYW1lJywgJ3BsYXllcicsICd0aHVtYicsICd0aHVtYm5haWwnLCAncHJldmlldycsICdwb3N0ZXInLFxuICAgICAgJ2ltYWdlJywgJ2ltZycsICdwaWMnLCAncGhvdG8nLCAnanBnJywgJ2pwZWcnLCAncG5nJywgJ2dpZicsICd3ZWJwJywgJ3N2ZycsXG4gICAgICAnaWNvbicsICdsb2dvJywgJ2Jhbm5lcicsICdidXR0b24nLCAnY2xpY2snLCAnaHJlZicsICdyZWRpcmVjdCcsXG4gICAgICBcbiAgICAgIC8vIEFkdmVydGlzaW5nL3RyYWNraW5nXG4gICAgICAnYWQnLCAnYWRzJywgJ2FkdmVydGlzZW1lbnQnLCAncHJvbW8nLCAncHJvbW90aW9uJywgJ3Nwb25zb3JlZCcsICdhZmZpbGlhdGUnLFxuICAgICAgJ3JlZmVycmVyJywgJ3V0bScsICd0cmFja2luZycsICdhbmFseXRpY3MnLCAncGl4ZWwnLFxuICAgICAgXG4gICAgICAvLyBBZG1pbi9zeXN0ZW0gdGVybXNcbiAgICAgICdhZG1pbicsICdhZG1pbmlzdHJhdG9yJywgJ21vZGVyYXRvcicsICdtb2QnLCAndXNlcicsICdndWVzdCcsICdtZW1iZXInLFxuICAgICAgJ3N1YnNjcmliZXInLCAnYWNjb3VudCcsICdwcm9maWxlJywgJ3NldHRpbmdzJywgJ3ByZWZlcmVuY2VzJywgJ2Rhc2hib2FyZCcsXG4gICAgICAncGFuZWwnLCAnY29udHJvbCcsICdtYW5hZ2UnLCAnZWRpdCcsICdkZWxldGUnLCAnY3JlYXRlJywgJ3VwZGF0ZScsXG4gICAgICBcbiAgICAgIC8vIEdlbmVyYWwgd2ViL3RlY2ggdGVybXNcbiAgICAgICd3ZWJzaXRlJywgJ2hvbWVwYWdlJywgJ2NvbnRhY3QnLCAnYWJvdXQnLCAnaGVscCcsICdmYXEnLCAndGVybXMnLCAncHJpdmFjeScsXG4gICAgICAncG9saWN5JywgJ2xlZ2FsJywgJ2RtY2EnLCAnY29weXJpZ2h0JywgJ3RyYWRlbWFyaycsICdkaXNjbGFpbWVyJyxcbiAgICAgICdzZWFyY2gnLCAnZmlsdGVyJywgJ3NvcnQnLCAnYnJvd3NlJywgJ2V4cGxvcmUnLCAnZGlzY292ZXInLCAndHJlbmRpbmcnLFxuICAgICAgJ3BvcHVsYXInLCAnZmVhdHVyZWQnLCAncmVjb21tZW5kZWQnLCAncmVsYXRlZCcsICdzaW1pbGFyJywgJ21vcmUnLCAnYWxsJyxcbiAgICAgICduZXcnLCAnbGF0ZXN0JywgJ3JlY2VudCcsICd0b2RheScsICd3ZWVrJywgJ21vbnRoJywgJ3llYXInLCAnZGF0ZScsICd0aW1lJyxcbiAgICAgIFxuICAgICAgLy8gTWVhbmluZ2xlc3MgdGVybXNcbiAgICAgICdjb250ZW50JywgJ3N0dWZmJywgJ3RoaW5ncycsICdpdGVtJywgJ29iamVjdCcsICdlbGVtZW50JywgJ2NvbXBvbmVudCcsXG4gICAgICAnc2VjdGlvbicsICdwYXJ0JywgJ3BpZWNlJywgJ2JpdCcsICdkYXRhJywgJ2luZm8nLCAnaW5mb3JtYXRpb24nLFxuICAgICAgJ2RldGFpbHMnLCAnZGVzY3JpcHRpb24nLCAndGl0bGUnLCAndGV4dCcsICdjYXB0aW9uJywgJ2xhYmVsJ1xuICAgIF1cbiAgICBcbiAgICBjb25zdCBsb3dlclRhZyA9IHRhZy50b0xvd2VyQ2FzZSgpXG4gICAgXG4gICAgLy8gQ2hlY2sgYWdhaW5zdCBibGFja2xpc3RcbiAgICBpZiAoYmxhY2tsaXN0LmluY2x1ZGVzKGxvd2VyVGFnKSkgcmV0dXJuIGZhbHNlXG4gICAgXG4gICAgLy8gU2tpcCBpZiBjb250YWlucyBVUkxzIG9yIHRlY2huaWNhbCBwYXR0ZXJuc1xuICAgIGlmIChsb3dlclRhZy5pbmNsdWRlcygnaHR0cCcpIHx8IGxvd2VyVGFnLmluY2x1ZGVzKCd3d3cnKSB8fCBsb3dlclRhZy5pbmNsdWRlcygnLmNvbScpKSByZXR1cm4gZmFsc2VcbiAgICBcbiAgICAvLyBTa2lwIHB1cmUgbnVtYmVyc1xuICAgIGlmICgvXlxcZCskLy50ZXN0KGxvd2VyVGFnKSkgcmV0dXJuIGZhbHNlXG4gICAgXG4gICAgLy8gU2tpcCBoZXggc3RyaW5ncyAobGlrZWx5IElEcylcbiAgICBpZiAoL15bYS1mMC05XXs4LH0kL2kudGVzdChsb3dlclRhZykpIHJldHVybiBmYWxzZVxuICAgIFxuICAgIC8vIFNraXAgdGVjaG5pY2FsIHZhbHVlc1xuICAgIGlmICgvXih0cnVlfGZhbHNlfG51bGx8dW5kZWZpbmVkfG5hbnxpbmZpbml0eSkkL2kudGVzdChsb3dlclRhZykpIHJldHVybiBmYWxzZVxuICAgIFxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBwcml2YXRlIG5vcm1hbGl6ZVRhZyh0YWc6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKCF0YWcpIHJldHVybiAnJ1xuICAgIFxuICAgIC8vIENvbnZlcnQgdG8gbG93ZXJjYXNlIGFuZCB0cmltXG4gICAgbGV0IG5vcm1hbGl6ZWQgPSB0YWcudG9Mb3dlckNhc2UoKS50cmltKClcbiAgICBcbiAgICAvLyBSZW1vdmUgc3BlY2lhbCBjaGFyYWN0ZXJzIGV4Y2VwdCBoeXBoZW5zXG4gICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQucmVwbGFjZSgvW15cXHdcXHMtXS9nLCAnJylcbiAgICBcbiAgICAvLyBSZXBsYWNlIHNwYWNlcyBhbmQgdW5kZXJzY29yZXMgd2l0aCBoeXBoZW5zXG4gICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQucmVwbGFjZSgvW1xcc19dKy9nLCAnLScpXG4gICAgXG4gICAgLy8gUmVtb3ZlIG11bHRpcGxlIGNvbnNlY3V0aXZlIGh5cGhlbnNcbiAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC8tKy9nLCAnLScpXG4gICAgXG4gICAgLy8gUmVtb3ZlIGxlYWRpbmcvdHJhaWxpbmcgaHlwaGVuc1xuICAgIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVkLnJlcGxhY2UoL14tK3wtKyQvZywgJycpXG4gICAgXG4gICAgLy8gVGFnIG1hcHBpbmdzIGZvciBjb21tb24gdmFyaWF0aW9ucyBpbmNsdWRpbmcgRnJlbmNoIHRyYW5zbGF0aW9uc1xuICAgIGNvbnN0IHRhZ01hcHBpbmdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgLy8gRW5nbGlzaCB2YXJpYXRpb25zXG4gICAgICAnYmlnLWJvb2JzJzogJ2JpZy10aXRzJyxcbiAgICAgICdiaWctYnJlYXN0cyc6ICdiaWctdGl0cycsXG4gICAgICAnc21hbGwtYm9vYnMnOiAnc21hbGwtdGl0cycsXG4gICAgICAnc21hbGwtYnJlYXN0cyc6ICdzbWFsbC10aXRzJyxcbiAgICAgICdiaWctYnV0dCc6ICdiaWctYXNzJyxcbiAgICAgICdidWJibGUtYnV0dCc6ICdiaWctYXNzJyxcbiAgICAgICdzbWFsbC1idXR0JzogJ3NtYWxsLWFzcycsXG4gICAgICAnYmxhY2snOiAnZWJvbnknLFxuICAgICAgJ2FmcmljYW4nOiAnZWJvbnknLFxuICAgICAgJ2JqJzogJ2Jsb3dqb2InLFxuICAgICAgJ2Jsb3ctam9iJzogJ2Jsb3dqb2InLFxuICAgICAgJ2hqJzogJ2hhbmRqb2InLFxuICAgICAgJ2hhbmQtam9iJzogJ2hhbmRqb2InLFxuICAgICAgJ2ZqJzogJ2Zvb3Rqb2InLFxuICAgICAgJ2Zvb3Qtam9iJzogJ2Zvb3Rqb2InLFxuICAgICAgJ3Bvdic6ICdwb3YnLFxuICAgICAgJ3BvaW50LW9mLXZpZXcnOiAncG92JyxcbiAgICAgICdnaXJsLW9uLWdpcmwnOiAnbGVzYmlhbicsXG4gICAgICAnZ2lybC1naXJsJzogJ2xlc2JpYW4nLFxuICAgICAgJ2dnJzogJ2xlc2JpYW4nLFxuICAgICAgJ2JveS1ib3knOiAnZ2F5JyxcbiAgICAgICdtbSc6ICdnYXknLFxuICAgICAgJ2dpcmwtYm95JzogJ3N0cmFpZ2h0JyxcbiAgICAgICdnZic6ICdnaXJsZnJpZW5kJyxcbiAgICAgICdiZic6ICdib3lmcmllbmQnLFxuICAgICAgJ2h1YmJ5JzogJ2h1c2JhbmQnLFxuICAgICAgJ3dpZmV5JzogJ3dpZmUnLFxuICAgICAgJ3RlZW4xOCc6ICd0ZWVuJyxcbiAgICAgICd0ZWVuLTE4JzogJ3RlZW4nLFxuICAgICAgJ2VpZ2h0ZWVuJzogJ3RlZW4nLFxuICAgICAgJzE4eW8nOiAndGVlbicsXG4gICAgICAnMTgteWVhci1vbGQnOiAndGVlbicsXG4gICAgICAnMTgtYW5zJzogJ3RlZW4nLFxuICAgICAgJ21pbGZzJzogJ21pbGYnLFxuICAgICAgJ21vbXMnOiAnbWlsZicsXG4gICAgICAnbW90aGVycyc6ICdtaWxmJyxcbiAgICAgICdjb3VnYXJzJzogJ21pbGYnLFxuICAgICAgJ2dyYW5uaWVzJzogJ2dyYW5ueScsXG4gICAgICAnZ3JhbmRtYXMnOiAnZ3Jhbm55JyxcbiAgICAgICdnaWxmJzogJ2dyYW5ueScsXG4gICAgICAvLyBGcmVuY2ggdG8gRW5nbGlzaCBtYXBwaW5nc1xuICAgICAgJ2JvbWJhc3NlJzogJ2JhYmUnLFxuICAgICAgJ2pldW5lJzogJ3RlZW4nLFxuICAgICAgJ3BpcGUnOiAnYmxvd2pvYicsXG4gICAgICAnYmxvbmRlJzogJ2Jsb25kZScsXG4gICAgICAncGV0aXRzLXNlaW5zJzogJ3NtYWxsLXRpdHMnLFxuICAgICAgJ2dyb3NzZS1iaXRlJzogJ2JpZy1jb2NrJyxcbiAgICAgICdiaWctY29jayc6ICdiaWctY29jaycsXG4gICAgICAnbWFzc2l2ZS1jb2NrJzogJ2JpZy1jb2NrJyxcbiAgICAgICdlbm9ybW91cyc6ICdiaWctY29jaycsXG4gICAgICAnaXJydW1hdGlvbic6ICdmYWNlLWZ1Y2snLFxuICAgICAgJ2ZhY2UtZnVjayc6ICdkZWVwdGhyb2F0JyxcbiAgICAgICdzZXhlLWJydXRhbCc6ICdyb3VnaC1zZXgnLFxuICAgICAgJ3JvdWdoLXNleCc6ICdyb3VnaC1zZXgnLFxuICAgICAgJ3ZpZGVvcy1oZCc6ICdoZCcsXG4gICAgICAndmlkw6lvcy1oZCc6ICdoZCcsXG4gICAgICAnYW1hdGV1cic6ICdhbWF0ZXVyJyxcbiAgICAgICdleGNpdGVlJzogJ2hvcm55JyxcbiAgICAgICdleGNpdMOpZSc6ICdob3JueScsXG4gICAgICAnaG9ybnknOiAnaG9ybnknLFxuICAgICAgJ2Fkb2xlc2NlbnRzJzogJ3RlZW4nLFxuICAgICAgJ2RvaWd0YWdlLWRlLWNoYXR0ZSc6ICdmaW5nZXJpbmcnLFxuICAgICAgJ2ZpbmdlcmluZy1wdXNzeSc6ICdmaW5nZXJpbmcnLFxuICAgICAgJ2RvaWd0ZWUnOiAnZmluZ2VyZWQnLFxuICAgICAgJ2ZpbmdlcmVkJzogJ2ZpbmdlcmluZycsXG4gICAgICAnYmVhdXRlcyc6ICdiYWJlJyxcbiAgICAgICdiZWF1dMOpcyc6ICdiYWJlJyxcbiAgICAgICdnZW1pc3NlbWVudHMtYnJ1eWFudHMnOiAnbW9hbmluZycsXG4gICAgICAnbG91ZC1tb2FuaW5nJzogJ21vYW5pbmcnLFxuICAgICAgJ3BldGl0ZS1jaGF0dGUnOiAnc21hbGwtcHVzc3knLFxuICAgICAgJ2xpdHRsZS1wdXNzeSc6ICdzbWFsbC1wdXNzeScsXG4gICAgICAnam91ZXQnOiAndG95cycsXG4gICAgICAndG95JzogJ3RveXMnLFxuICAgICAgJ3NlaW5zLW5hdHVyZWxzJzogJ25hdHVyYWwtdGl0cycsXG4gICAgICAnbmF0dXJhbC1ib29icyc6ICduYXR1cmFsLXRpdHMnLFxuICAgICAgJ25hdHVyYWwtdGl0cyc6ICduYXR1cmFsLXRpdHMnLFxuICAgICAgJ3V0aWxpc2UtbW9pJzogJ2ZyZWV1c2UnLFxuICAgICAgJ3VzZS1tZSc6ICdmcmVldXNlJyxcbiAgICAgICd1dGlsaXNhdGlvbi1ncmF0dWl0ZSc6ICdmcmVldXNlJyxcbiAgICAgICdhc2NlbnNldXInOiAnZWxldmF0b3InLFxuICAgICAgJ2JhbmRlLWFubm9uY2UnOiAndHJhaWxlcicsXG4gICAgICAnZXRvdXJkaXNzYW50JzogJ3N0dW5uaW5nJyxcbiAgICAgICdzdHVubmVyJzogJ3N0dW5uaW5nJyxcbiAgICAgICdhcnJhY2hlcic6ICdyb3VnaCcsXG4gICAgICAnc25hdGNoJzogJ3JvdWdoJyxcbiAgICAgICdiYW5naW5nJzogJ2hhcmRjb3JlJyxcbiAgICAgICdiZWdpbm5lcic6ICdhbWF0ZXVyJyxcbiAgICAgICd0aXR0aWVzJzogJ3RpdHMnLFxuICAgICAgJ215LWxpdHRsZSc6ICdwZXRpdGUnLFxuICAgICAgJ3RyYXAnOiAnc3R1Y2snLFxuICAgICAgJ3RpZ2h0cyc6ICdwYW50eWhvc2UnLFxuICAgICAgJ2ZpbmdlcnMnOiAnZmluZ2VyaW5nJyxcbiAgICAgICdwb3VuZHMnOiAncG91bmRpbmcnLFxuICAgICAgJ3NleCc6ICdoYXJkY29yZSdcbiAgICB9XG4gICAgXG4gICAgLy8gQXBwbHkgbWFwcGluZ3NcbiAgICBpZiAodGFnTWFwcGluZ3Nbbm9ybWFsaXplZF0pIHtcbiAgICAgIG5vcm1hbGl6ZWQgPSB0YWdNYXBwaW5nc1tub3JtYWxpemVkXVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbm9ybWFsaXplZFxuICB9XG5cbiAgYXN5bmMgcHJvY2Vzc1hIYW1zdGVyVXJsKG9yaWdpbmFsVXJsOiBzdHJpbmcpOiBQcm9taXNlPFhIYW1zdGVyTWV0YWRhdGE+IHtcbiAgICB0cnkge1xuICAgICAgbG9nZ2VyLmluZm8oJ1Byb2Nlc3NpbmcgWEhhbXN0ZXIgVVJMIGZvciBtZXRhZGF0YSBleHRyYWN0aW9uJywgeyB1cmw6IG9yaWdpbmFsVXJsIH0pXG5cbiAgICAgIC8vIEZldGNoIHRoZSBIVE1MIHBhZ2VcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gob3JpZ2luYWxVcmwsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85MS4wLjQ0NzIuMTI0IFNhZmFyaS81MzcuMzYnXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggWEhhbXN0ZXIgcGFnZTogJHtyZXNwb25zZS5zdGF0dXN9YClcbiAgICAgIH1cblxuICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKVxuXG4gICAgICAvLyBFeHRyYWN0IG1ldGFkYXRhIGZyb20gdmFyaW91cyBzb3VyY2VzXG4gICAgICBjb25zdCBtZXRhZGF0YTogWEhhbXN0ZXJNZXRhZGF0YSA9IHt9XG5cbiAgICAgIC8vIEV4dHJhY3QgdGl0bGUgZnJvbSBtZXRhIHRhZ3Mgb3IgcGFnZSB0aXRsZVxuICAgICAgY29uc3QgdGl0bGVNYXRjaCA9IGh0bWwubWF0Y2goLzx0aXRsZVtePl0qPihbXjxdKyk8XFwvdGl0bGU+L2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sLm1hdGNoKC88bWV0YVtePl0qcHJvcGVydHk9XCJvZzp0aXRsZVwiW14+XSpjb250ZW50PVwiKFteXCJdKilcIltePl0qPi9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbC5tYXRjaCgvPG1ldGFbXj5dKm5hbWU9XCJ0aXRsZVwiW14+XSpjb250ZW50PVwiKFteXCJdKilcIltePl0qPi9pKVxuICAgICAgaWYgKHRpdGxlTWF0Y2gpIHtcbiAgICAgICAgbWV0YWRhdGEudGl0bGUgPSB0aXRsZU1hdGNoWzFdLnRyaW0oKVxuICAgICAgfVxuXG4gICAgICAvLyBFeHRyYWN0IGRlc2NyaXB0aW9uXG4gICAgICBjb25zdCBkZXNjTWF0Y2ggPSBodG1sLm1hdGNoKC88bWV0YVtePl0qcHJvcGVydHk9XCJvZzpkZXNjcmlwdGlvblwiW14+XSpjb250ZW50PVwiKFteXCJdKilcIltePl0qPi9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICBodG1sLm1hdGNoKC88bWV0YVtePl0qbmFtZT1cImRlc2NyaXB0aW9uXCJbXj5dKmNvbnRlbnQ9XCIoW15cIl0qKVwiW14+XSo+L2kpXG4gICAgICBpZiAoZGVzY01hdGNoKSB7XG4gICAgICAgIG1ldGFkYXRhLmRlc2NyaXB0aW9uID0gZGVzY01hdGNoWzFdLnRyaW0oKVxuICAgICAgfVxuXG4gICAgICAvLyBFeHRyYWN0IHRodW1ibmFpbCBmcm9tIG9nOmltYWdlXG4gICAgICBjb25zdCB0aHVtYk1hdGNoID0gaHRtbC5tYXRjaCgvPG1ldGFbXj5dKnByb3BlcnR5PVwib2c6aW1hZ2VcIltePl0qY29udGVudD1cIihbXlwiXSopXCJbXj5dKj4vaSlcbiAgICAgIGlmICh0aHVtYk1hdGNoKSB7XG4gICAgICAgIG1ldGFkYXRhLnRodW1ibmFpbCA9IHRodW1iTWF0Y2hbMV0gLy8gVXNlIHRoZSBjYXB0dXJlZCBncm91cCBmcm9tIG9nOmltYWdlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGYWxsYmFjazogc2VhcmNoIGZvciBkaXJlY3QgaW1hZ2UgVVJMc1xuICAgICAgICBjb25zdCBkaXJlY3RJbWFnZU1hdGNoID0gaHRtbC5tYXRjaCgvaHR0cHM6XFwvXFwvaWMtdnQtW15cIl0qXFwueGhwaW5nY2RuXFwuY29tXFwvW15cIl0qXFwuanBnL2cpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwubWF0Y2goL2h0dHBzOlxcL1xcL3RodW1iLVteXCJdKlxcLnhocGluZ2NkblxcLmNvbVxcL1teXCJdKlxcLmpwZy9nKVxuICAgICAgICBpZiAoZGlyZWN0SW1hZ2VNYXRjaCkge1xuICAgICAgICAgIG1ldGFkYXRhLnRodW1ibmFpbCA9IEFycmF5LmlzQXJyYXkoZGlyZWN0SW1hZ2VNYXRjaCkgPyBkaXJlY3RJbWFnZU1hdGNoWzBdIDogZGlyZWN0SW1hZ2VNYXRjaFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEV4dHJhY3QgcHJldmlldyBVUkwgZnJvbSBpbml0aWFscy1zY3JpcHRcbiAgICAgIGNvbnN0IHNjcmlwdFBhdHRlcm5zID0gW1xuICAgICAgICAvPHNjcmlwdCBpZD1cImluaXRpYWxzLXNjcmlwdFwiW14+XSo+KFtcXHNcXFNdKj8pPFxcL3NjcmlwdD4vaSxcbiAgICAgICAgLzxzY3JpcHRbXj5dKmlkPVwiaW5pdGlhbHMtc2NyaXB0XCJbXj5dKj4oW1xcc1xcU10qPyk8XFwvc2NyaXB0Pi9pLFxuICAgICAgICAvPHNjcmlwdFtePl0qaW5pdGlhbHNbXj5dKj4oW1xcc1xcU10qPyk8XFwvc2NyaXB0Pi9pXG4gICAgICBdXG4gICAgICBcbiAgICAgIGxldCBzY3JpcHRDb250ZW50ID0gbnVsbFxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2Ygc2NyaXB0UGF0dGVybnMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBodG1sLm1hdGNoKHBhdHRlcm4pXG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIHNjcmlwdENvbnRlbnQgPSBtYXRjaFsxXVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHNjcmlwdENvbnRlbnQpIHtcbiAgICAgICAgLy8gTG9vayBmb3IgdHJhaWxlclVSTCBpbiB0aGUgc2NyaXB0IChtb3JlIGZsZXhpYmxlIHJlZ2V4KVxuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAvXCJ0cmFpbGVyVVJMXCJcXHMqOlxccypcIihbXlwiXSp0aHVtYi12W15cIl0qXFwueGhwaW5nY2RuXFwuY29tW15cIl0qXFwudFxcLm1wNFteXCJdKilcIi9naSxcbiAgICAgICAgICAvXCJ0cmFpbGVyVVJMXCJcXHMqOlxccypcIihbXlwiXSp0aHVtYi12W15cIl0qXFwueGhwaW5nY2RuXFwuY29tW15cIl0qXFwubXA0W15cIl0qKVwiL2dpLFxuICAgICAgICAgIC9cInRyYWlsZXJVUkxcIlxccyo6XFxzKlwiKFteXCJdKlxcLm1wNFteXCJdKilcIi9naVxuICAgICAgICBdXG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgICAgICBjb25zdCBtYXRjaGVzID0gc2NyaXB0Q29udGVudC5tYXRjaChwYXR0ZXJuKVxuICAgICAgICAgIGlmIChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gR2V0IHRoZSBmaXJzdCBtYXRjaCBhbmQgZXh0cmFjdCBVUkwgZnJvbSBjYXB0dXJlIGdyb3VwXG4gICAgICAgICAgICBjb25zdCBmaXJzdE1hdGNoID0gbWF0Y2hlc1swXS5tYXRjaCgvXCJ0cmFpbGVyVVJMXCJcXHMqOlxccypcIihbXlwiXSopXCIvaSlcbiAgICAgICAgICAgIGlmIChmaXJzdE1hdGNoKSB7XG4gICAgICAgICAgICAgIG1ldGFkYXRhLnByZXZpZXdVcmwgPSBmaXJzdE1hdGNoWzFdLnJlcGxhY2UoL1xcXFxcXC8vZywgJy8nKVxuICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmFsbGJhY2s6IHNlYXJjaCB0aGUgZW50aXJlIEhUTUwgZm9yIHRyYWlsZXJVUkxcbiAgICAgICAgY29uc3QgcGF0dGVybnMgPSBbXG4gICAgICAgICAgL1widHJhaWxlclVSTFwiXFxzKjpcXHMqXCIoW15cIl0qdGh1bWItdlteXCJdKlxcLnhocGluZ2NkblxcLmNvbVteXCJdKlxcLnRcXC5tcDRbXlwiXSopXCIvZ2ksXG4gICAgICAgICAgL1widHJhaWxlclVSTFwiXFxzKjpcXHMqXCIoW15cIl0qdGh1bWItdlteXCJdKlxcLnhocGluZ2NkblxcLmNvbVteXCJdKlxcLm1wNFteXCJdKilcIi9naSxcbiAgICAgICAgICAvXCJ0cmFpbGVyVVJMXCJcXHMqOlxccypcIihbXlwiXSpcXC5tcDRbXlwiXSopXCIvZ2lcbiAgICAgICAgXVxuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGh0bWwubWF0Y2gocGF0dGVybilcbiAgICAgICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0TWF0Y2ggPSBtYXRjaGVzWzBdLm1hdGNoKC9cInRyYWlsZXJVUkxcIlxccyo6XFxzKlwiKFteXCJdKilcIi9pKVxuICAgICAgICAgICAgaWYgKGZpcnN0TWF0Y2gpIHtcbiAgICAgICAgICAgICAgbWV0YWRhdGEucHJldmlld1VybCA9IGZpcnN0TWF0Y2hbMV0ucmVwbGFjZSgvXFxcXFxcLy9nLCAnLycpXG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEVuaGFuY2VkIHRhZ3MgZXh0cmFjdGlvbiBmcm9tIG11bHRpcGxlIHNvdXJjZXNcbiAgICAgIGNvbnN0IHRhZ3MgPSBuZXcgU2V0PHN0cmluZz4oKVxuXG4gICAgICAvLyAxLiBFeHRyYWN0IGZyb20ga2V5d29yZHMgbWV0YSB0YWdcbiAgICAgIGNvbnN0IGtleXdvcmRzTWF0Y2ggPSBodG1sLm1hdGNoKC88bWV0YVtePl0qbmFtZT1cImtleXdvcmRzXCJbXj5dKmNvbnRlbnQ9XCIoW15cIl0qKVwiW14+XSo+L2kpXG4gICAgICBpZiAoa2V5d29yZHNNYXRjaCkge1xuICAgICAgICBrZXl3b3Jkc01hdGNoWzFdLnNwbGl0KCcsJykuZm9yRWFjaCh0YWcgPT4ge1xuICAgICAgICAgIGNvbnN0IGNsZWFuVGFnID0gdGFnLnRyaW0oKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgaWYgKGNsZWFuVGFnICYmIGNsZWFuVGFnLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIHRhZ3MuYWRkKGNsZWFuVGFnKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgLy8gMi4gRXh0cmFjdCBmcm9tIHZpc2libGUgY2F0ZWdvcnkgYW5kIHRhZyBsaW5rcyBpbiBIVE1MIChtb3JlIHJlbGlhYmxlIGFwcHJvYWNoKVxuICAgICAgLy8gRXh0cmFjdCBjYXRlZ29yeSBsaW5rcyBsaWtlOiBocmVmPVwiaHR0cHM6Ly9mcmEueGhhbXN0ZXIuY29tL2NhdGVnb3JpZXMvdGVlblwiXG4gICAgICBjb25zdCBjYXRlZ29yeUxpbmtzUmVnZXggPSAvaHJlZj1cIlteXCJdKlxcL2NhdGVnb3JpZXNcXC8oW15cIl0rKVwiW14+XSo+XFxzKjxbXj5dKj5cXHMqKFtePF0rKTwvZ1xuICAgICAgbGV0IGNhdGVnb3J5TWF0Y2hcbiAgICAgIHdoaWxlICgoY2F0ZWdvcnlNYXRjaCA9IGNhdGVnb3J5TGlua3NSZWdleC5leGVjKGh0bWwpKSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBjYXRlZ29yeVNsdWcgPSBjYXRlZ29yeU1hdGNoWzFdPy50cmltKClcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlUZXh0ID0gY2F0ZWdvcnlNYXRjaFsyXT8udHJpbSgpXG4gICAgICAgIFxuICAgICAgICBpZiAoY2F0ZWdvcnlTbHVnICYmIHRoaXMuaXNWYWxpZENvbnRlbnRUYWcoY2F0ZWdvcnlTbHVnKSkge1xuICAgICAgICAgIHRhZ3MuYWRkKGNhdGVnb3J5U2x1Zy50b0xvd2VyQ2FzZSgpKVxuICAgICAgICB9XG4gICAgICAgIGlmIChjYXRlZ29yeVRleHQgJiYgY2F0ZWdvcnlUZXh0ICE9PSBjYXRlZ29yeVNsdWcgJiYgdGhpcy5pc1ZhbGlkQ29udGVudFRhZyhjYXRlZ29yeVRleHQpKSB7XG4gICAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHRoaXMubm9ybWFsaXplVGFnKGNhdGVnb3J5VGV4dClcbiAgICAgICAgICBpZiAobm9ybWFsaXplZCkgdGFncy5hZGQobm9ybWFsaXplZClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBFeHRyYWN0IHRhZyBsaW5rcyBsaWtlOiBocmVmPVwiaHR0cHM6Ly9mcmEueGhhbXN0ZXIuY29tL3RhZ3MvZnJlZXVzZVwiXG4gICAgICBjb25zdCB0YWdMaW5rc1JlZ2V4ID0gL2hyZWY9XCJbXlwiXSpcXC90YWdzXFwvKFteXCJdKylcIltePl0qPlxccyo8W14+XSo+XFxzKihbXjxdKyk8L2dcbiAgICAgIGxldCB0YWdNYXRjaFxuICAgICAgd2hpbGUgKCh0YWdNYXRjaCA9IHRhZ0xpbmtzUmVnZXguZXhlYyhodG1sKSkgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgdGFnU2x1ZyA9IHRhZ01hdGNoWzFdPy50cmltKClcbiAgICAgICAgY29uc3QgdGFnVGV4dCA9IHRhZ01hdGNoWzJdPy50cmltKClcbiAgICAgICAgXG4gICAgICAgIGlmICh0YWdTbHVnICYmIHRoaXMuaXNWYWxpZENvbnRlbnRUYWcodGFnU2x1ZykpIHtcbiAgICAgICAgICB0YWdzLmFkZCh0YWdTbHVnLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhZ1RleHQgJiYgdGFnVGV4dCAhPT0gdGFnU2x1ZyAmJiB0aGlzLmlzVmFsaWRDb250ZW50VGFnKHRhZ1RleHQpKSB7XG4gICAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHRoaXMubm9ybWFsaXplVGFnKHRhZ1RleHQpXG4gICAgICAgICAgaWYgKG5vcm1hbGl6ZWQpIHRhZ3MuYWRkKG5vcm1hbGl6ZWQpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gMy4gRXh0cmFjdCBjaGFubmVsL3Bvcm5zdGFyIG5hbWVzIGZyb20gbGlua3NcbiAgICAgIGNvbnN0IHBvcm5zdGFyTGlua3NSZWdleCA9IC9ocmVmPVwiW15cIl0qXFwvcG9ybnN0YXJzXFwvKFteXCJdKylcIltePl0qPltcXHNcXFNdKj9hbHQ9XCIoW15cIl0qKVwiW14+XSo+L2dcbiAgICAgIGxldCBwb3Juc3Rhck1hdGNoXG4gICAgICB3aGlsZSAoKHBvcm5zdGFyTWF0Y2ggPSBwb3Juc3RhckxpbmtzUmVnZXguZXhlYyhodG1sKSkgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgcG9ybnN0YXJOYW1lID0gcG9ybnN0YXJNYXRjaFsyXT8udHJpbSgpXG4gICAgICAgIFxuICAgICAgICBpZiAocG9ybnN0YXJOYW1lICYmIHRoaXMuaXNWYWxpZENvbnRlbnRUYWcocG9ybnN0YXJOYW1lKSkge1xuICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB0aGlzLm5vcm1hbGl6ZVRhZyhwb3Juc3Rhck5hbWUpXG4gICAgICAgICAgaWYgKG5vcm1hbGl6ZWQgJiYgbm9ybWFsaXplZCAhPT0gJ2ltYWdlJyAmJiBub3JtYWxpemVkICE9PSAnYXZhdGFyJykge1xuICAgICAgICAgICAgdGFncy5hZGQobm9ybWFsaXplZClcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gNC4gRXh0cmFjdCBmcm9tIEpTT04gZGF0YSAobW9yZSB0YXJnZXRlZCBhcHByb2FjaClcbiAgICAgIGlmIChzY3JpcHRDb250ZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gTG9vayBmb3Igc3BlY2lmaWMgdGFnIGFycmF5cyB0aGF0IGNvbnRhaW4gYWN0dWFsIGNvbnRlbnQgdGFnc1xuICAgICAgICAgIGNvbnN0IHRhZ0FycmF5UGF0dGVybiA9IC9cInRhZ3NcIlxccyo6XFxzKlxcWyhbXlxcXV0qXCJbXlwiXSpcIlteXFxdXSopXFxdL2dcbiAgICAgICAgICBjb25zdCB0YWdBcnJheU1hdGNoZXMgPSBzY3JpcHRDb250ZW50Lm1hdGNoKHRhZ0FycmF5UGF0dGVybilcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAodGFnQXJyYXlNYXRjaGVzKSB7XG4gICAgICAgICAgICB0YWdBcnJheU1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHRhZ1N0cmluZ0FycmF5ID0gbWF0Y2gubWF0Y2goL1wiKFteXCJdezIsMzB9KVwiL2cpXG4gICAgICAgICAgICAgIGlmICh0YWdTdHJpbmdBcnJheSkge1xuICAgICAgICAgICAgICAgIHRhZ1N0cmluZ0FycmF5LmZvckVhY2godGFnU3RyID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZyA9IHRhZ1N0ci5yZXBsYWNlKC9cIi9nLCAnJykudHJpbSgpXG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkQ29udGVudFRhZyh0YWcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB0aGlzLm5vcm1hbGl6ZVRhZyh0YWcpXG4gICAgICAgICAgICAgICAgICAgIGlmIChub3JtYWxpemVkKSB0YWdzLmFkZChub3JtYWxpemVkKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gTG9vayBmb3IgY2F0ZWdvcnkgb2JqZWN0cyB3aXRoIG5hbWVzXG4gICAgICAgICAgY29uc3QgY2F0ZWdvcnlQYXR0ZXJuID0gL1wiY2F0ZWdvcmllc1wiXFxzKjpcXHMqXFxbW15cXF1dKlwibmFtZVwiXFxzKjpcXHMqXCIoW15cIl0rKVwiW15cXF1dKlxcXS9nXG4gICAgICAgICAgY29uc3QgY2F0ZWdvcnlNYXRjaGVzID0gc2NyaXB0Q29udGVudC5tYXRjaChjYXRlZ29yeVBhdHRlcm4pXG4gICAgICAgICAgaWYgKGNhdGVnb3J5TWF0Y2hlcykge1xuICAgICAgICAgICAgY2F0ZWdvcnlNYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgICAgICBjb25zdCBuYW1lTWF0Y2ggPSBtYXRjaC5tYXRjaCgvXCJuYW1lXCJcXHMqOlxccypcIihbXlwiXSspXCIvZylcbiAgICAgICAgICAgICAgaWYgKG5hbWVNYXRjaCkge1xuICAgICAgICAgICAgICAgIG5hbWVNYXRjaC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnlOYW1lID0gbmFtZS5tYXRjaCgvXCJuYW1lXCJcXHMqOlxccypcIihbXlwiXSspXCIvKT8uWzFdXG4gICAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnlOYW1lICYmIHRoaXMuaXNWYWxpZENvbnRlbnRUYWcoY2F0ZWdvcnlOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gdGhpcy5ub3JtYWxpemVUYWcoY2F0ZWdvcnlOYW1lKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9ybWFsaXplZCkgdGFncy5hZGQobm9ybWFsaXplZClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2dnZXIud2FybignRXJyb3IgcGFyc2luZyBKU09OIGNvbnRlbnQgZm9yIHRhZ3MnLCB7IGVycm9yIH0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gNS4gRXh0cmFjdCBmcm9tIHZpZGVvLXNwZWNpZmljIG1ldGFkYXRhIHBhdHRlcm5zIGFuZCBvdGhlciBIVE1MIGVsZW1lbnRzXG4gICAgICBjb25zdCB2aWRlb1RhZ3NQYXR0ZXJuID0gLzxzcGFuW14+XSpjbGFzcz1cIlteXCJdKnRhZ1teXCJdKlwiW14+XSo+KFtePF0rKTxcXC9zcGFuPi9naVxuICAgICAgbGV0IHZpZGVvVGFnTWF0Y2hcbiAgICAgIHdoaWxlICgodmlkZW9UYWdNYXRjaCA9IHZpZGVvVGFnc1BhdHRlcm4uZXhlYyhodG1sKSkgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IHZpZGVvVGFnTWF0Y2hbMV0udHJpbSgpXG4gICAgICAgIGlmICh0YWdOYW1lICYmIHRoaXMuaXNWYWxpZENvbnRlbnRUYWcodGFnTmFtZSkpIHtcbiAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gdGhpcy5ub3JtYWxpemVUYWcodGFnTmFtZSlcbiAgICAgICAgICBpZiAobm9ybWFsaXplZCkgdGFncy5hZGQobm9ybWFsaXplZClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyA2LiBFeHRyYWN0IHF1YWxpdHkgaW5kaWNhdG9ycyBhbmQgY29udGVudCB0eXBlIGZyb20gdGl0bGUvZGVzY3JpcHRpb25cbiAgICAgIGNvbnN0IHRpdGxlTG93ZXIgPSAobWV0YWRhdGEudGl0bGUgfHwgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgIGNvbnN0IGRlc2NMb3dlciA9IChtZXRhZGF0YS5kZXNjcmlwdGlvbiB8fCAnJykudG9Mb3dlckNhc2UoKVxuICAgICAgY29uc3QgY29tYmluZWRUZXh0ID0gYCR7dGl0bGVMb3dlcn0gJHtkZXNjTG93ZXJ9YFxuXG4gICAgICAvLyBRdWFsaXR5IHRhZ3NcbiAgICAgIGlmIChjb21iaW5lZFRleHQuaW5jbHVkZXMoJzRrJykgfHwgY29tYmluZWRUZXh0LmluY2x1ZGVzKCd1bHRyYSBoZCcpKSB0YWdzLmFkZCgnNGsnKVxuICAgICAgaWYgKGNvbWJpbmVkVGV4dC5pbmNsdWRlcygnaGQnKSAmJiAhdGFncy5oYXMoJzRrJykpIHRhZ3MuYWRkKCdoZCcpXG4gICAgICBpZiAoY29tYmluZWRUZXh0LmluY2x1ZGVzKCc2MGZwcycpKSB0YWdzLmFkZCgnNjBmcHMnKVxuICAgICAgaWYgKGNvbWJpbmVkVGV4dC5pbmNsdWRlcygndnInKSkgdGFncy5hZGQoJ3ZyJylcblxuICAgICAgLy8gQ29udGVudCB0eXBlIHRhZ3NcbiAgICAgIGlmIChjb21iaW5lZFRleHQuaW5jbHVkZXMoJ2FtYXRldXInKSkgdGFncy5hZGQoJ2FtYXRldXInKVxuICAgICAgaWYgKGNvbWJpbmVkVGV4dC5pbmNsdWRlcygncHJvZmVzc2lvbmFsJykpIHRhZ3MuYWRkKCdwcm9mZXNzaW9uYWwnKVxuICAgICAgaWYgKGNvbWJpbmVkVGV4dC5pbmNsdWRlcygnd2ViY2FtJykpIHRhZ3MuYWRkKCd3ZWJjYW0nKVxuICAgICAgaWYgKGNvbWJpbmVkVGV4dC5pbmNsdWRlcygnaG9tZW1hZGUnKSkgdGFncy5hZGQoJ2hvbWVtYWRlJylcbiAgICAgIFxuICAgICAgLy8gQWN0aXZpdHkgdGFncyAoY29tbW9uIG9uZXMpXG4gICAgICBjb25zdCBhY3Rpdml0eVRhZ3MgPSBbXG4gICAgICAgICdzb2xvJywgJ2NvdXBsZScsICd0aHJlZXNvbWUnLCAnZ3JvdXAnLCAnbGVzYmlhbicsICdnYXknLCAnc3RyYWlnaHQnLFxuICAgICAgICAnYW5hbCcsICdvcmFsJywgJ21hc3R1cmJhdGlvbicsICdibG93am9iJywgJ2hhbmRqb2InLCAnZm9vdGpvYicsXG4gICAgICAgICdtYXNzYWdlJywgJ3N0cmlwdGVhc2luZycsICdkYW5jaW5nJywgJ3Nob3dlcicsICdiYXRoJywgJ291dGRvb3InLFxuICAgICAgICAncHVibGljJywgJ2NhcicsICdvZmZpY2UnLCAnYmVkcm9vbScsICdraXRjaGVuJywgJ2JhdGhyb29tJ1xuICAgICAgXVxuICAgICAgXG4gICAgICBhY3Rpdml0eVRhZ3MuZm9yRWFjaChhY3Rpdml0eVRhZyA9PiB7XG4gICAgICAgIGlmIChjb21iaW5lZFRleHQuaW5jbHVkZXMoYWN0aXZpdHlUYWcpKSB7XG4gICAgICAgICAgdGFncy5hZGQoYWN0aXZpdHlUYWcpXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIERlbW9ncmFwaGljIHRhZ3NcbiAgICAgIGNvbnN0IGRlbW9ncmFwaGljVGFncyA9IFtcbiAgICAgICAgJ3RlZW4nLCAnbWlsZicsICdtYXR1cmUnLCAnZ3Jhbm55JywgJ3lvdW5nJywgJ29sZCcsXG4gICAgICAgICdibG9uZGUnLCAnYnJ1bmV0dGUnLCAncmVkaGVhZCcsICdibGFjayBoYWlyJywgJ2FzaWFuJywgJ2xhdGluYScsXG4gICAgICAgICdlYm9ueScsICd3aGl0ZScsICdiYncnLCAndGhpbicsICdjdXJ2eScsICdiaWcgdGl0cycsICdzbWFsbCB0aXRzJyxcbiAgICAgICAgJ2JpZyBhc3MnLCAnc21hbGwgYXNzJywgJ3RhdHRvbycsICdwaWVyY2luZycsICdoYWlyeScsICdzaGF2ZWQnXG4gICAgICBdXG4gICAgICBcbiAgICAgIGRlbW9ncmFwaGljVGFncy5mb3JFYWNoKGRlbW9UYWcgPT4ge1xuICAgICAgICBpZiAoY29tYmluZWRUZXh0LmluY2x1ZGVzKGRlbW9UYWcpKSB7XG4gICAgICAgICAgdGFncy5hZGQoZGVtb1RhZy5yZXBsYWNlKCcgJywgJy0nKSlcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gQ29udmVydCBTZXQgdG8gQXJyYXkgYW5kIGFwcGx5IHRhZyBub3JtYWxpemF0aW9uXG4gICAgICBsZXQgZmluYWxUYWdzID0gQXJyYXkuZnJvbSh0YWdzKVxuICAgICAgXG4gICAgICAvLyBOb3JtYWxpemUgYW5kIGNsZWFuIHVwIHRhZ3NcbiAgICAgIGZpbmFsVGFncyA9IGZpbmFsVGFnc1xuICAgICAgICAubWFwKHRhZyA9PiB0aGlzLm5vcm1hbGl6ZVRhZyh0YWcpKVxuICAgICAgICAuZmlsdGVyKHRhZyA9PiB0YWcgJiYgdGFnLmxlbmd0aCA+PSAyICYmIHRhZy5sZW5ndGggPD0gMzApXG4gICAgICAgIC5maWx0ZXIoKHRhZywgaW5kZXgsIGFycmF5KSA9PiBhcnJheS5pbmRleE9mKHRhZykgPT09IGluZGV4KSAvLyBSZW1vdmUgZHVwbGljYXRlc1xuICAgICAgICAvLyBSZW1vdmVkIHRhZyBsaW1pdCAtIGFsbG93IGFsbCByZWxldmFudCB0YWdzXG5cbiAgICAgIG1ldGFkYXRhLnRhZ3MgPSBmaW5hbFRhZ3MubGVuZ3RoID4gMCA/IGZpbmFsVGFncyA6IHVuZGVmaW5lZFxuXG4gICAgICBsb2dnZXIuaW5mbygnWEhhbXN0ZXIgbWV0YWRhdGEgZXh0cmFjdGVkJywge1xuICAgICAgICB1cmw6IG9yaWdpbmFsVXJsLFxuICAgICAgICBoYXNUaXRsZTogISFtZXRhZGF0YS50aXRsZSxcbiAgICAgICAgaGFzRGVzY3JpcHRpb246ICEhbWV0YWRhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgIGhhc1RodW1ibmFpbDogISFtZXRhZGF0YS50aHVtYm5haWwsXG4gICAgICAgIGhhc1ByZXZpZXdVcmw6ICEhbWV0YWRhdGEucHJldmlld1VybCxcbiAgICAgICAgdGFnc0NvdW50OiBtZXRhZGF0YS50YWdzPy5sZW5ndGggfHwgMFxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIG1ldGFkYXRhXG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcHJvY2VzcyBYSGFtc3RlciBVUkwnLCB7IFxuICAgICAgICB1cmw6IG9yaWdpbmFsVXJsLCBcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IgXG4gICAgICB9KVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHhIYW1zdGVyU2VydmljZSA9IG5ldyBYSGFtc3RlclNlcnZpY2VJbXBsKCkiXSwibmFtZXMiOlsibG9nZ2VyIiwiWEhhbXN0ZXJTZXJ2aWNlSW1wbCIsImlzWEhhbXN0ZXJVcmwiLCJ1cmwiLCJpbmNsdWRlcyIsImlzVmFsaWRDb250ZW50VGFnIiwidGFnIiwibGVuZ3RoIiwiYmxhY2tsaXN0IiwibG93ZXJUYWciLCJ0b0xvd2VyQ2FzZSIsInRlc3QiLCJub3JtYWxpemVUYWciLCJub3JtYWxpemVkIiwidHJpbSIsInJlcGxhY2UiLCJ0YWdNYXBwaW5ncyIsInByb2Nlc3NYSGFtc3RlclVybCIsIm9yaWdpbmFsVXJsIiwiaW5mbyIsInJlc3BvbnNlIiwiZmV0Y2giLCJoZWFkZXJzIiwib2siLCJFcnJvciIsInN0YXR1cyIsImh0bWwiLCJ0ZXh0IiwibWV0YWRhdGEiLCJ0aXRsZU1hdGNoIiwibWF0Y2giLCJ0aXRsZSIsImRlc2NNYXRjaCIsImRlc2NyaXB0aW9uIiwidGh1bWJNYXRjaCIsInRodW1ibmFpbCIsImRpcmVjdEltYWdlTWF0Y2giLCJBcnJheSIsImlzQXJyYXkiLCJzY3JpcHRQYXR0ZXJucyIsInNjcmlwdENvbnRlbnQiLCJwYXR0ZXJuIiwicGF0dGVybnMiLCJtYXRjaGVzIiwiZmlyc3RNYXRjaCIsInByZXZpZXdVcmwiLCJ0YWdzIiwiU2V0Iiwia2V5d29yZHNNYXRjaCIsInNwbGl0IiwiZm9yRWFjaCIsImNsZWFuVGFnIiwiYWRkIiwiY2F0ZWdvcnlMaW5rc1JlZ2V4IiwiY2F0ZWdvcnlNYXRjaCIsImV4ZWMiLCJjYXRlZ29yeVNsdWciLCJjYXRlZ29yeVRleHQiLCJ0YWdMaW5rc1JlZ2V4IiwidGFnTWF0Y2giLCJ0YWdTbHVnIiwidGFnVGV4dCIsInBvcm5zdGFyTGlua3NSZWdleCIsInBvcm5zdGFyTWF0Y2giLCJwb3Juc3Rhck5hbWUiLCJ0YWdBcnJheVBhdHRlcm4iLCJ0YWdBcnJheU1hdGNoZXMiLCJ0YWdTdHJpbmdBcnJheSIsInRhZ1N0ciIsImNhdGVnb3J5UGF0dGVybiIsImNhdGVnb3J5TWF0Y2hlcyIsIm5hbWVNYXRjaCIsIm5hbWUiLCJjYXRlZ29yeU5hbWUiLCJlcnJvciIsIndhcm4iLCJ2aWRlb1RhZ3NQYXR0ZXJuIiwidmlkZW9UYWdNYXRjaCIsInRhZ05hbWUiLCJ0aXRsZUxvd2VyIiwiZGVzY0xvd2VyIiwiY29tYmluZWRUZXh0IiwiaGFzIiwiYWN0aXZpdHlUYWdzIiwiYWN0aXZpdHlUYWciLCJkZW1vZ3JhcGhpY1RhZ3MiLCJkZW1vVGFnIiwiZmluYWxUYWdzIiwiZnJvbSIsIm1hcCIsImZpbHRlciIsImluZGV4IiwiYXJyYXkiLCJpbmRleE9mIiwidW5kZWZpbmVkIiwiaGFzVGl0bGUiLCJoYXNEZXNjcmlwdGlvbiIsImhhc1RodW1ibmFpbCIsImhhc1ByZXZpZXdVcmwiLCJ0YWdzQ291bnQiLCJtZXNzYWdlIiwieEhhbXN0ZXJTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/services/xhamster.service.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fusers%2F%5Bid%5D%2Fvideos.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();